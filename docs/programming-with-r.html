<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Introduction to Data Science for Transportation Researchers, Planners, and Engineers</title>
  <meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
  <meta name="description" content="Introduction to Data Science for Transportation Researchers, Planners, and Engineers">
  <meta name="generator" content="bookdown 0.3 and GitBook 2.6.7">

  <meta property="og:title" content="Introduction to Data Science for Transportation Researchers, Planners, and Engineers" />
  <meta property="og:type" content="book" />
  
  
  
  <meta name="github-repo" content="cities/datascience" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Introduction to Data Science for Transportation Researchers, Planners, and Engineers" />
  
  
  

<meta name="author" content="Liming Wang">


<meta name="date" content="2017-03-15">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="introduction.html">
<link rel="next" href="version-control-with-git.html">

<script src="book_assets/jquery-2.2.3/jquery.min.js"></script>
<link href="book_assets/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="book_assets/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="book_assets/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="book_assets/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="book_assets/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

</head>

<body>


  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Syllabus</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#prerequisite"><i class="fa fa-check"></i><b>1.1</b> Prerequisite</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#format"><i class="fa fa-check"></i><b>1.2</b> Format</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#software-and-hardware"><i class="fa fa-check"></i><b>1.3</b> Software and Hardware</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#textbook-and-readings"><i class="fa fa-check"></i><b>1.4</b> Textbook and Readings</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#topics"><i class="fa fa-check"></i><b>1.5</b> Topics</a></li>
<li class="chapter" data-level="1.6" data-path="index.html"><a href="index.html#license"><i class="fa fa-check"></i><b>1.6</b> License</a></li>
<li class="chapter" data-level="1.7" data-path="index.html"><a href="index.html#acknowledgements"><i class="fa fa-check"></i><b>1.7</b> Acknowledgements</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>2</b> Introduction</a><ul>
<li class="chapter" data-level="2.1" data-path="introduction.html"><a href="introduction.html#readings"><i class="fa fa-check"></i><b>2.1</b> Readings</a></li>
<li class="chapter" data-level="2.2" data-path="introduction.html"><a href="introduction.html#introduction-1"><i class="fa fa-check"></i><b>2.2</b> Introduction</a><ul>
<li class="chapter" data-level="2.2.1" data-path="introduction.html"><a href="introduction.html#best-practices-for-data-science-wilson-et-al-2012"><i class="fa fa-check"></i><b>2.2.1</b> Best practices for data science (Wilson et al, 2012)</a></li>
<li class="chapter" data-level="2.2.2" data-path="introduction.html"><a href="introduction.html#the-tidyverse-work-flow"><i class="fa fa-check"></i><b>2.2.2</b> The tidyverse work flow</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="introduction.html"><a href="introduction.html#r-and-rstudio"><i class="fa fa-check"></i><b>2.3</b> R and RStudio</a><ul>
<li class="chapter" data-level="2.3.1" data-path="introduction.html"><a href="introduction.html#installation"><i class="fa fa-check"></i><b>2.3.1</b> Installation</a></li>
<li class="chapter" data-level="2.3.2" data-path="introduction.html"><a href="introduction.html#testing-testing"><i class="fa fa-check"></i><b>2.3.2</b> Testing testing</a></li>
<li class="chapter" data-level="2.3.3" data-path="introduction.html"><a href="introduction.html#add-on-packages"><i class="fa fa-check"></i><b>2.3.3</b> Add-on packages</a></li>
<li class="chapter" data-level="2.3.4" data-path="introduction.html"><a href="introduction.html#r-and-rstudio-tutorial"><i class="fa fa-check"></i><b>2.3.4</b> R and RStudio tutorial</a></li>
<li class="chapter" data-level="2.3.5" data-path="introduction.html"><a href="introduction.html#project-orgnization-in-rstudio"><i class="fa fa-check"></i><b>2.3.5</b> Project orgnization in RStudio</a></li>
<li class="chapter" data-level="2.3.6" data-path="introduction.html"><a href="introduction.html#set-up-github-and-clone-datascience-course-repository"><i class="fa fa-check"></i><b>2.3.6</b> Set up github and clone datascience course repository</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="introduction.html"><a href="introduction.html#learning-more"><i class="fa fa-check"></i><b>2.4</b> Learning more</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="programming-with-r.html"><a href="programming-with-r.html"><i class="fa fa-check"></i><b>3</b> Programming with R</a><ul>
<li class="chapter" data-level="3.1" data-path="programming-with-r.html"><a href="programming-with-r.html#readings-1"><i class="fa fa-check"></i><b>3.1</b> Readings</a></li>
<li class="chapter" data-level="3.2" data-path="programming-with-r.html"><a href="programming-with-r.html#starting-with-data"><i class="fa fa-check"></i><b>3.2</b> Starting with Data</a><ul>
<li class="chapter" data-level="3.2.1" data-path="programming-with-r.html"><a href="programming-with-r.html#loading-data"><i class="fa fa-check"></i><b>3.2.1</b> Loading Data</a></li>
<li class="chapter" data-level="3.2.2" data-path="programming-with-r.html"><a href="programming-with-r.html#manipulating-data"><i class="fa fa-check"></i><b>3.2.2</b> Manipulating Data</a></li>
<li class="chapter" data-level="3.2.3" data-path="programming-with-r.html"><a href="programming-with-r.html#plotting"><i class="fa fa-check"></i><b>3.2.3</b> Plotting</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="programming-with-r.html"><a href="programming-with-r.html#creating-functions"><i class="fa fa-check"></i><b>3.3</b> Creating Functions</a><ul>
<li class="chapter" data-level="3.3.1" data-path="programming-with-r.html"><a href="programming-with-r.html#defining-a-function"><i class="fa fa-check"></i><b>3.3.1</b> Defining a Function</a></li>
<li class="chapter" data-level="3.3.2" data-path="programming-with-r.html"><a href="programming-with-r.html#composing-functions"><i class="fa fa-check"></i><b>3.3.2</b> Composing Functions</a></li>
<li class="chapter" data-level="3.3.3" data-path="programming-with-r.html"><a href="programming-with-r.html#testing-and-documenting"><i class="fa fa-check"></i><b>3.3.3</b> Testing and Documenting</a></li>
<li class="chapter" data-level="3.3.4" data-path="programming-with-r.html"><a href="programming-with-r.html#defining-defaults"><i class="fa fa-check"></i><b>3.3.4</b> Defining Defaults</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="programming-with-r.html"><a href="programming-with-r.html#loops-in-r"><i class="fa fa-check"></i><b>3.4</b> Loops in R</a><ul>
<li class="chapter" data-level="3.4.1" data-path="programming-with-r.html"><a href="programming-with-r.html#for-loops"><i class="fa fa-check"></i><b>3.4.1</b> For Loops</a></li>
<li class="chapter" data-level="3.4.2" data-path="programming-with-r.html"><a href="programming-with-r.html#processing-multiple-files"><i class="fa fa-check"></i><b>3.4.2</b> Processing Multiple Files</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="programming-with-r.html"><a href="programming-with-r.html#best-practice-for-repetition"><i class="fa fa-check"></i><b>3.5</b> Best Practice for Repetition</a><ul>
<li class="chapter" data-level="3.5.1" data-path="programming-with-r.html"><a href="programming-with-r.html#vectorized-operations"><i class="fa fa-check"></i><b>3.5.1</b> Vectorized Operations</a></li>
<li class="chapter" data-level="3.5.2" data-path="programming-with-r.html"><a href="programming-with-r.html#vector-recycling"><i class="fa fa-check"></i><b>3.5.2</b> Vector Recycling</a></li>
<li class="chapter" data-level="3.5.3" data-path="programming-with-r.html"><a href="programming-with-r.html#for-or-apply"><i class="fa fa-check"></i><b>3.5.3</b> <code>for</code> or <code>apply</code>?</a></li>
<li class="chapter" data-level="3.5.4" data-path="programming-with-r.html"><a href="programming-with-r.html#loops-in-r-are-slow"><i class="fa fa-check"></i><b>3.5.4</b> Loops in R Are Slow</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="programming-with-r.html"><a href="programming-with-r.html#make-choices"><i class="fa fa-check"></i><b>3.6</b> Make Choices</a><ul>
<li class="chapter" data-level="3.6.1" data-path="programming-with-r.html"><a href="programming-with-r.html#saving-plots-to-a-file"><i class="fa fa-check"></i><b>3.6.1</b> Saving Plots to a File</a></li>
<li class="chapter" data-level="3.6.2" data-path="programming-with-r.html"><a href="programming-with-r.html#conditionals"><i class="fa fa-check"></i><b>3.6.2</b> Conditionals</a></li>
<li class="chapter" data-level="3.6.3" data-path="programming-with-r.html"><a href="programming-with-r.html#saving-automatically-generated-figures"><i class="fa fa-check"></i><b>3.6.3</b> Saving Automatically Generated Figures</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="programming-with-r.html"><a href="programming-with-r.html#command-line-programs"><i class="fa fa-check"></i><b>3.7</b> Command-Line Programs</a><ul>
<li class="chapter" data-level="3.7.1" data-path="programming-with-r.html"><a href="programming-with-r.html#command-line-arguments"><i class="fa fa-check"></i><b>3.7.1</b> Command-Line Arguments</a></li>
<li class="chapter" data-level="3.7.2" data-path="programming-with-r.html"><a href="programming-with-r.html#handling-multiple-files"><i class="fa fa-check"></i><b>3.7.2</b> Handling Multiple Files</a></li>
<li class="chapter" data-level="3.7.3" data-path="programming-with-r.html"><a href="programming-with-r.html#handling-command-line-flags"><i class="fa fa-check"></i><b>3.7.3</b> Handling Command-Line Flags</a></li>
<li class="chapter" data-level="3.7.4" data-path="programming-with-r.html"><a href="programming-with-r.html#handling-standard-input"><i class="fa fa-check"></i><b>3.7.4</b> Handling Standard Input</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="programming-with-r.html"><a href="programming-with-r.html#addressing-data"><i class="fa fa-check"></i><b>3.8</b> Addressing Data</a><ul>
<li class="chapter" data-level="3.8.1" data-path="programming-with-r.html"><a href="programming-with-r.html#addressing-by-index"><i class="fa fa-check"></i><b>3.8.1</b> Addressing by Index</a></li>
<li class="chapter" data-level="3.8.2" data-path="programming-with-r.html"><a href="programming-with-r.html#addressing-by-name"><i class="fa fa-check"></i><b>3.8.2</b> Addressing by Name</a></li>
<li class="chapter" data-level="3.8.3" data-path="programming-with-r.html"><a href="programming-with-r.html#logical-indexing"><i class="fa fa-check"></i><b>3.8.3</b> Logical Indexing</a></li>
<li class="chapter" data-level="3.8.4" data-path="programming-with-r.html"><a href="programming-with-r.html#combining-indexing-and-assignment"><i class="fa fa-check"></i><b>3.8.4</b> Combining Indexing and Assignment</a></li>
</ul></li>
<li class="chapter" data-level="3.9" data-path="programming-with-r.html"><a href="programming-with-r.html#r-data-structures"><i class="fa fa-check"></i><b>3.9</b> R Data Structures</a><ul>
<li class="chapter" data-level="3.9.1" data-path="programming-with-r.html"><a href="programming-with-r.html#understanding-basic-data-types-in-r"><i class="fa fa-check"></i><b>3.9.1</b> Understanding Basic Data Types in R</a></li>
<li class="chapter" data-level="3.9.2" data-path="programming-with-r.html"><a href="programming-with-r.html#atomic-vectors"><i class="fa fa-check"></i><b>3.9.2</b> Atomic Vectors</a></li>
<li class="chapter" data-level="3.9.3" data-path="programming-with-r.html"><a href="programming-with-r.html#the-different-vector-modes"><i class="fa fa-check"></i><b>3.9.3</b> The Different Vector Modes</a></li>
<li class="chapter" data-level="3.9.4" data-path="programming-with-r.html"><a href="programming-with-r.html#examining-vectors"><i class="fa fa-check"></i><b>3.9.4</b> Examining Vectors</a></li>
<li class="chapter" data-level="3.9.5" data-path="programming-with-r.html"><a href="programming-with-r.html#adding-elements"><i class="fa fa-check"></i><b>3.9.5</b> Adding Elements</a></li>
<li class="chapter" data-level="3.9.6" data-path="programming-with-r.html"><a href="programming-with-r.html#vectors-from-a-sequence-of-numbers"><i class="fa fa-check"></i><b>3.9.6</b> Vectors from a Sequence of Numbers</a></li>
<li class="chapter" data-level="3.9.7" data-path="programming-with-r.html"><a href="programming-with-r.html#missing-data"><i class="fa fa-check"></i><b>3.9.7</b> Missing Data</a></li>
<li class="chapter" data-level="3.9.8" data-path="programming-with-r.html"><a href="programming-with-r.html#other-special-values"><i class="fa fa-check"></i><b>3.9.8</b> Other Special Values</a></li>
<li class="chapter" data-level="3.9.9" data-path="programming-with-r.html"><a href="programming-with-r.html#what-happens-when-you-mix-types-inside-a-vector"><i class="fa fa-check"></i><b>3.9.9</b> What Happens When You Mix Types Inside a Vector?</a></li>
<li class="chapter" data-level="3.9.10" data-path="programming-with-r.html"><a href="programming-with-r.html#objects-attributes"><i class="fa fa-check"></i><b>3.9.10</b> Objects Attributes</a></li>
<li class="chapter" data-level="3.9.11" data-path="programming-with-r.html"><a href="programming-with-r.html#matrix"><i class="fa fa-check"></i><b>3.9.11</b> Matrix</a></li>
<li class="chapter" data-level="3.9.12" data-path="programming-with-r.html"><a href="programming-with-r.html#list"><i class="fa fa-check"></i><b>3.9.12</b> List</a></li>
<li class="chapter" data-level="3.9.13" data-path="programming-with-r.html"><a href="programming-with-r.html#data-frame"><i class="fa fa-check"></i><b>3.9.13</b> Data Frame</a></li>
<li class="chapter" data-level="3.9.14" data-path="programming-with-r.html"><a href="programming-with-r.html#creating-data-frames-by-hand"><i class="fa fa-check"></i><b>3.9.14</b> Creating Data Frames by Hand</a></li>
</ul></li>
<li class="chapter" data-level="3.10" data-path="programming-with-r.html"><a href="programming-with-r.html#understanding-factors"><i class="fa fa-check"></i><b>3.10</b> Understanding Factors</a><ul>
<li class="chapter" data-level="3.10.1" data-path="programming-with-r.html"><a href="programming-with-r.html#converting-factors"><i class="fa fa-check"></i><b>3.10.1</b> Converting Factors</a></li>
<li class="chapter" data-level="3.10.2" data-path="programming-with-r.html"><a href="programming-with-r.html#using-factors"><i class="fa fa-check"></i><b>3.10.2</b> Using Factors</a></li>
<li class="chapter" data-level="3.10.3" data-path="programming-with-r.html"><a href="programming-with-r.html#removing-levels-from-a-factor"><i class="fa fa-check"></i><b>3.10.3</b> Removing Levels from a Factor</a></li>
</ul></li>
<li class="chapter" data-level="3.11" data-path="programming-with-r.html"><a href="programming-with-r.html#learning-more-1"><i class="fa fa-check"></i><b>3.11</b> Learning more</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="version-control-with-git.html"><a href="version-control-with-git.html"><i class="fa fa-check"></i><b>4</b> Version Control with Git</a><ul>
<li class="chapter" data-level="4.1" data-path="version-control-with-git.html"><a href="version-control-with-git.html#readings-2"><i class="fa fa-check"></i><b>4.1</b> Readings</a></li>
<li class="chapter" data-level="4.2" data-path="version-control-with-git.html"><a href="version-control-with-git.html#introduction-2"><i class="fa fa-check"></i><b>4.2</b> Introduction</a></li>
<li class="chapter" data-level="4.3" data-path="version-control-with-git.html"><a href="version-control-with-git.html#setting-up-git"><i class="fa fa-check"></i><b>4.3</b> Setting up Git</a></li>
<li class="chapter" data-level="4.4" data-path="version-control-with-git.html"><a href="version-control-with-git.html#creating-a-repository"><i class="fa fa-check"></i><b>4.4</b> Creating a Repository</a></li>
<li class="chapter" data-level="4.5" data-path="version-control-with-git.html"><a href="version-control-with-git.html#tracking-changes"><i class="fa fa-check"></i><b>4.5</b> Tracking Changes</a></li>
<li class="chapter" data-level="4.6" data-path="version-control-with-git.html"><a href="version-control-with-git.html#exploring-history"><i class="fa fa-check"></i><b>4.6</b> Exploring History</a></li>
<li class="chapter" data-level="4.7" data-path="version-control-with-git.html"><a href="version-control-with-git.html#ignoring-things"><i class="fa fa-check"></i><b>4.7</b> Ignoring Things</a></li>
<li class="chapter" data-level="4.8" data-path="version-control-with-git.html"><a href="version-control-with-git.html#remotes-in-github"><i class="fa fa-check"></i><b>4.8</b> Remotes in GitHub</a></li>
<li class="chapter" data-level="4.9" data-path="version-control-with-git.html"><a href="version-control-with-git.html#collaborating"><i class="fa fa-check"></i><b>4.9</b> Collaborating</a></li>
<li class="chapter" data-level="4.10" data-path="version-control-with-git.html"><a href="version-control-with-git.html#conflicts"><i class="fa fa-check"></i><b>4.10</b> Conflicts</a></li>
<li class="chapter" data-level="4.11" data-path="version-control-with-git.html"><a href="version-control-with-git.html#open-science"><i class="fa fa-check"></i><b>4.11</b> Open Science</a></li>
<li class="chapter" data-level="4.12" data-path="version-control-with-git.html"><a href="version-control-with-git.html#licensing"><i class="fa fa-check"></i><b>4.12</b> Licensing</a></li>
<li class="chapter" data-level="4.13" data-path="version-control-with-git.html"><a href="version-control-with-git.html#citation"><i class="fa fa-check"></i><b>4.13</b> Citation</a></li>
<li class="chapter" data-level="4.14" data-path="version-control-with-git.html"><a href="version-control-with-git.html#hosting"><i class="fa fa-check"></i><b>4.14</b> Hosting</a></li>
<li class="chapter" data-level="4.15" data-path="version-control-with-git.html"><a href="version-control-with-git.html#using-git-from-rstudio"><i class="fa fa-check"></i><b>4.15</b> Using Git from RStudio</a></li>
<li class="chapter" data-level="4.16" data-path="version-control-with-git.html"><a href="version-control-with-git.html#learn-more"><i class="fa fa-check"></i><b>4.16</b> Learn more</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="import.html"><a href="import.html"><i class="fa fa-check"></i><b>5</b> Import</a><ul>
<li class="chapter" data-level="5.1" data-path="import.html"><a href="import.html#readings-3"><i class="fa fa-check"></i><b>5.1</b> Readings</a></li>
<li class="chapter" data-level="5.2" data-path="import.html"><a href="import.html#tibbles-vs.data.frame"><i class="fa fa-check"></i><b>5.2</b> Tibbles vs. data.frame</a><ul>
<li class="chapter" data-level="5.2.1" data-path="import.html"><a href="import.html#data-frames-are-awesome"><i class="fa fa-check"></i><b>5.2.1</b> Data frames are awesome</a></li>
<li class="chapter" data-level="5.2.2" data-path="import.html"><a href="import.html#printing"><i class="fa fa-check"></i><b>5.2.2</b> Printing</a></li>
<li class="chapter" data-level="5.2.3" data-path="import.html"><a href="import.html#subsetting"><i class="fa fa-check"></i><b>5.2.3</b> Subsetting</a></li>
<li class="chapter" data-level="5.2.4" data-path="import.html"><a href="import.html#converting"><i class="fa fa-check"></i><b>5.2.4</b> Converting</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="import.html"><a href="import.html#data-import"><i class="fa fa-check"></i><b>5.3</b> Data Import</a><ul>
<li class="chapter" data-level="5.3.1" data-path="import.html"><a href="import.html#compared-to-base-r"><i class="fa fa-check"></i><b>5.3.1</b> Compared to base R</a></li>
<li class="chapter" data-level="5.3.2" data-path="import.html"><a href="import.html#exercises"><i class="fa fa-check"></i><b>5.3.2</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="import.html"><a href="import.html#writing-to-a-file"><i class="fa fa-check"></i><b>5.4</b> Writing to a file</a></li>
<li class="chapter" data-level="5.5" data-path="import.html"><a href="import.html#learn-more-1"><i class="fa fa-check"></i><b>5.5</b> Learn More</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="tidy.html"><a href="tidy.html"><i class="fa fa-check"></i><b>6</b> Tidy</a><ul>
<li class="chapter" data-level="6.1" data-path="tidy.html"><a href="tidy.html#readings-4"><i class="fa fa-check"></i><b>6.1</b> Readings</a></li>
<li class="chapter" data-level="6.2" data-path="tidy.html"><a href="tidy.html#introduction-3"><i class="fa fa-check"></i><b>6.2</b> Introduction</a><ul>
<li class="chapter" data-level="6.2.1" data-path="tidy.html"><a href="tidy.html#prerequisites"><i class="fa fa-check"></i><b>6.2.1</b> Prerequisites</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="tidy.html"><a href="tidy.html#tidy-data"><i class="fa fa-check"></i><b>6.3</b> Tidy data</a></li>
<li class="chapter" data-level="6.4" data-path="tidy.html"><a href="tidy.html#spreading-and-gathering"><i class="fa fa-check"></i><b>6.4</b> Spreading and gathering</a><ul>
<li class="chapter" data-level="6.4.1" data-path="tidy.html"><a href="tidy.html#gathering"><i class="fa fa-check"></i><b>6.4.1</b> Gathering</a></li>
<li class="chapter" data-level="6.4.2" data-path="tidy.html"><a href="tidy.html#spreading"><i class="fa fa-check"></i><b>6.4.2</b> Spreading</a></li>
<li class="chapter" data-level="6.4.3" data-path="tidy.html"><a href="tidy.html#exercises-1"><i class="fa fa-check"></i><b>6.4.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="tidy.html"><a href="tidy.html#separating-and-uniting"><i class="fa fa-check"></i><b>6.5</b> Separating and uniting</a><ul>
<li class="chapter" data-level="6.5.1" data-path="tidy.html"><a href="tidy.html#separate"><i class="fa fa-check"></i><b>6.5.1</b> Separate</a></li>
<li class="chapter" data-level="6.5.2" data-path="tidy.html"><a href="tidy.html#unite"><i class="fa fa-check"></i><b>6.5.2</b> Unite</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="tidy.html"><a href="tidy.html#case-study"><i class="fa fa-check"></i><b>6.6</b> Case Study</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="transform-with-dplyr.html"><a href="transform-with-dplyr.html"><i class="fa fa-check"></i><b>7</b> Transform with dplyr</a><ul>
<li class="chapter" data-level="7.1" data-path="transform-with-dplyr.html"><a href="transform-with-dplyr.html#readings-5"><i class="fa fa-check"></i><b>7.1</b> Readings</a></li>
<li class="chapter" data-level="7.2" data-path="transform-with-dplyr.html"><a href="transform-with-dplyr.html#prerequisites-1"><i class="fa fa-check"></i><b>7.2</b> Prerequisites</a></li>
<li class="chapter" data-level="7.3" data-path="transform-with-dplyr.html"><a href="transform-with-dplyr.html#dplyr-introduction"><i class="fa fa-check"></i><b>7.3</b> dplyr introduction</a><ul>
<li class="chapter" data-level="7.3.1" data-path="transform-with-dplyr.html"><a href="transform-with-dplyr.html#say-hello-to-the-gapminder-tibble"><i class="fa fa-check"></i><b>7.3.1</b> Say hello to the Gapminder tibble</a></li>
<li class="chapter" data-level="7.3.2" data-path="transform-with-dplyr.html"><a href="transform-with-dplyr.html#think-before-you-create-excerpts-of-your-data"><i class="fa fa-check"></i><b>7.3.2</b> Think before you create excerpts of your data …</a></li>
<li class="chapter" data-level="7.3.3" data-path="transform-with-dplyr.html"><a href="transform-with-dplyr.html#use-filter-to-subset-data-row-wise."><i class="fa fa-check"></i><b>7.3.3</b> Use <code>filter()</code> to subset data row-wise.</a></li>
<li class="chapter" data-level="7.3.4" data-path="transform-with-dplyr.html"><a href="transform-with-dplyr.html#meet-the-new-pipe-operator"><i class="fa fa-check"></i><b>7.3.4</b> Meet the new pipe operator</a></li>
<li class="chapter" data-level="7.3.5" data-path="transform-with-dplyr.html"><a href="transform-with-dplyr.html#use-select-to-subset-the-data-on-variables-or-columns."><i class="fa fa-check"></i><b>7.3.5</b> Use <code>select()</code> to subset the data on variables or columns.</a></li>
<li class="chapter" data-level="7.3.6" data-path="transform-with-dplyr.html"><a href="transform-with-dplyr.html#revel-in-the-convenience"><i class="fa fa-check"></i><b>7.3.6</b> Revel in the convenience</a></li>
<li class="chapter" data-level="7.3.7" data-path="transform-with-dplyr.html"><a href="transform-with-dplyr.html#pure-predictable-pipeable"><i class="fa fa-check"></i><b>7.3.7</b> Pure, predictable, pipeable</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="transform-with-dplyr.html"><a href="transform-with-dplyr.html#dplyr-grammar"><i class="fa fa-check"></i><b>7.4</b> dplyr grammar</a><ul>
<li class="chapter" data-level="7.4.1" data-path="transform-with-dplyr.html"><a href="transform-with-dplyr.html#create-a-copy-of-gapminder"><i class="fa fa-check"></i><b>7.4.1</b> Create a copy of gapminder</a></li>
<li class="chapter" data-level="7.4.2" data-path="transform-with-dplyr.html"><a href="transform-with-dplyr.html#use-mutate-to-add-new-variables"><i class="fa fa-check"></i><b>7.4.2</b> Use <code>mutate()</code> to add new variables</a></li>
<li class="chapter" data-level="7.4.3" data-path="transform-with-dplyr.html"><a href="transform-with-dplyr.html#use-arrange-to-row-order-data-in-a-principled-way"><i class="fa fa-check"></i><b>7.4.3</b> Use <code>arrange()</code> to row-order data in a principled way</a></li>
<li class="chapter" data-level="7.4.4" data-path="transform-with-dplyr.html"><a href="transform-with-dplyr.html#use-rename-to-rename-variables"><i class="fa fa-check"></i><b>7.4.4</b> Use <code>rename()</code> to rename variables</a></li>
<li class="chapter" data-level="7.4.5" data-path="transform-with-dplyr.html"><a href="transform-with-dplyr.html#select-can-rename-and-reposition-variables"><i class="fa fa-check"></i><b>7.4.5</b> <code>select()</code> can rename and reposition variables</a></li>
<li class="chapter" data-level="7.4.6" data-path="transform-with-dplyr.html"><a href="transform-with-dplyr.html#group_by-is-a-mighty-weapon"><i class="fa fa-check"></i><b>7.4.6</b> <code>group_by()</code> is a mighty weapon</a></li>
<li class="chapter" data-level="7.4.7" data-path="transform-with-dplyr.html"><a href="transform-with-dplyr.html#grouped-mutate"><i class="fa fa-check"></i><b>7.4.7</b> Grouped mutate</a></li>
<li class="chapter" data-level="7.4.8" data-path="transform-with-dplyr.html"><a href="transform-with-dplyr.html#grand-finale"><i class="fa fa-check"></i><b>7.4.8</b> Grand Finale</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="transform-with-dplyr.html"><a href="transform-with-dplyr.html#working-with-two-datasets"><i class="fa fa-check"></i><b>7.5</b> Working with two datasets</a><ul>
<li class="chapter" data-level="7.5.1" data-path="transform-with-dplyr.html"><a href="transform-with-dplyr.html#inner_joinsuperheroes-publishers"><i class="fa fa-check"></i><b>7.5.1</b> inner_join(superheroes, publishers)</a></li>
<li class="chapter" data-level="7.5.2" data-path="transform-with-dplyr.html"><a href="transform-with-dplyr.html#semi_joinsuperheroes-publishers"><i class="fa fa-check"></i><b>7.5.2</b> semi_join(superheroes, publishers)</a></li>
<li class="chapter" data-level="7.5.3" data-path="transform-with-dplyr.html"><a href="transform-with-dplyr.html#left_joinsuperheroes-publishers"><i class="fa fa-check"></i><b>7.5.3</b> left_join(superheroes, publishers)</a></li>
<li class="chapter" data-level="7.5.4" data-path="transform-with-dplyr.html"><a href="transform-with-dplyr.html#anti_joinsuperheroes-publishers"><i class="fa fa-check"></i><b>7.5.4</b> anti_join(superheroes, publishers)</a></li>
<li class="chapter" data-level="7.5.5" data-path="transform-with-dplyr.html"><a href="transform-with-dplyr.html#inner_joinpublishers-superheroes"><i class="fa fa-check"></i><b>7.5.5</b> inner_join(publishers, superheroes)</a></li>
<li class="chapter" data-level="7.5.6" data-path="transform-with-dplyr.html"><a href="transform-with-dplyr.html#semi_joinpublishers-superheroes"><i class="fa fa-check"></i><b>7.5.6</b> semi_join(publishers, superheroes)</a></li>
<li class="chapter" data-level="7.5.7" data-path="transform-with-dplyr.html"><a href="transform-with-dplyr.html#left_joinpublishers-superheroes"><i class="fa fa-check"></i><b>7.5.7</b> left_join(publishers, superheroes)</a></li>
<li class="chapter" data-level="7.5.8" data-path="transform-with-dplyr.html"><a href="transform-with-dplyr.html#anti_joinpublishers-superheroes"><i class="fa fa-check"></i><b>7.5.8</b> anti_join(publishers, superheroes)</a></li>
<li class="chapter" data-level="7.5.9" data-path="transform-with-dplyr.html"><a href="transform-with-dplyr.html#full_joinsuperheroes-publishers"><i class="fa fa-check"></i><b>7.5.9</b> full_join(superheroes, publishers)</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="transform-with-dplyr.html"><a href="transform-with-dplyr.html#learn-more-2"><i class="fa fa-check"></i><b>7.6</b> Learn more</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="visualize.html"><a href="visualize.html"><i class="fa fa-check"></i><b>8</b> Visualize</a><ul>
<li class="chapter" data-level="8.1" data-path="visualize.html"><a href="visualize.html#readings-6"><i class="fa fa-check"></i><b>8.1</b> Readings</a></li>
<li class="chapter" data-level="8.2" data-path="visualize.html"><a href="visualize.html#introduction-4"><i class="fa fa-check"></i><b>8.2</b> Introduction</a><ul>
<li class="chapter" data-level="8.2.1" data-path="visualize.html"><a href="visualize.html#prerequisites-2"><i class="fa fa-check"></i><b>8.2.1</b> Prerequisites</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="visualize.html"><a href="visualize.html#first-steps"><i class="fa fa-check"></i><b>8.3</b> First steps</a><ul>
<li class="chapter" data-level="8.3.1" data-path="visualize.html"><a href="visualize.html#the-mpg-data-frame"><i class="fa fa-check"></i><b>8.3.1</b> The <code>mpg</code> data frame</a></li>
<li class="chapter" data-level="8.3.2" data-path="visualize.html"><a href="visualize.html#creating-a-ggplot"><i class="fa fa-check"></i><b>8.3.2</b> Creating a ggplot</a></li>
<li class="chapter" data-level="8.3.3" data-path="visualize.html"><a href="visualize.html#a-graphing-template"><i class="fa fa-check"></i><b>8.3.3</b> A graphing template</a></li>
<li class="chapter" data-level="8.3.4" data-path="visualize.html"><a href="visualize.html#exercises-2"><i class="fa fa-check"></i><b>8.3.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="visualize.html"><a href="visualize.html#aesthetic-mappings"><i class="fa fa-check"></i><b>8.4</b> Aesthetic mappings</a><ul>
<li class="chapter" data-level="8.4.1" data-path="visualize.html"><a href="visualize.html#exercises-3"><i class="fa fa-check"></i><b>8.4.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="visualize.html"><a href="visualize.html#common-problems"><i class="fa fa-check"></i><b>8.5</b> Common problems</a></li>
<li class="chapter" data-level="8.6" data-path="visualize.html"><a href="visualize.html#facets"><i class="fa fa-check"></i><b>8.6</b> Facets</a><ul>
<li class="chapter" data-level="8.6.1" data-path="visualize.html"><a href="visualize.html#exercises-4"><i class="fa fa-check"></i><b>8.6.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="visualize.html"><a href="visualize.html#geometric-objects"><i class="fa fa-check"></i><b>8.7</b> Geometric objects</a><ul>
<li class="chapter" data-level="8.7.1" data-path="visualize.html"><a href="visualize.html#exercises-5"><i class="fa fa-check"></i><b>8.7.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="8.8" data-path="visualize.html"><a href="visualize.html#statistical-transformations"><i class="fa fa-check"></i><b>8.8</b> Statistical transformations</a><ul>
<li class="chapter" data-level="8.8.1" data-path="visualize.html"><a href="visualize.html#exercises-6"><i class="fa fa-check"></i><b>8.8.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="8.9" data-path="visualize.html"><a href="visualize.html#position-adjustments"><i class="fa fa-check"></i><b>8.9</b> Position adjustments</a><ul>
<li class="chapter" data-level="8.9.1" data-path="visualize.html"><a href="visualize.html#exercises-7"><i class="fa fa-check"></i><b>8.9.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="8.10" data-path="visualize.html"><a href="visualize.html#coordinate-systems"><i class="fa fa-check"></i><b>8.10</b> Coordinate systems</a><ul>
<li class="chapter" data-level="8.10.1" data-path="visualize.html"><a href="visualize.html#exercises-8"><i class="fa fa-check"></i><b>8.10.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="8.11" data-path="visualize.html"><a href="visualize.html#the-layered-grammar-of-graphics"><i class="fa fa-check"></i><b>8.11</b> The layered grammar of graphics</a></li>
<li class="chapter" data-level="8.12" data-path="visualize.html"><a href="visualize.html#learn-more-3"><i class="fa fa-check"></i><b>8.12</b> Learn More</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="model-with-split-apply-combine-strategy.html"><a href="model-with-split-apply-combine-strategy.html"><i class="fa fa-check"></i><b>9</b> Model with Split-Apply-Combine Strategy</a><ul>
<li class="chapter" data-level="9.1" data-path="model-with-split-apply-combine-strategy.html"><a href="model-with-split-apply-combine-strategy.html#readings-7"><i class="fa fa-check"></i><b>9.1</b> Readings</a></li>
<li class="chapter" data-level="9.2" data-path="model-with-split-apply-combine-strategy.html"><a href="model-with-split-apply-combine-strategy.html#think-before-you-create-excerpts-of-your-data-1"><i class="fa fa-check"></i><b>9.2</b> Think before you create excerpts of your data …</a><ul>
<li class="chapter" data-level="9.2.1" data-path="model-with-split-apply-combine-strategy.html"><a href="model-with-split-apply-combine-strategy.html#load-dplyr-tidyr-purrr-and-gapminder"><i class="fa fa-check"></i><b>9.2.1</b> Load dplyr, tidyr, purrr and gapminder</a></li>
<li class="chapter" data-level="9.2.2" data-path="model-with-split-apply-combine-strategy.html"><a href="model-with-split-apply-combine-strategy.html#split-apply-combine"><i class="fa fa-check"></i><b>9.2.2</b> Split Apply Combine</a></li>
<li class="chapter" data-level="9.2.3" data-path="model-with-split-apply-combine-strategy.html"><a href="model-with-split-apply-combine-strategy.html#entry-level-dplyrgroup_by"><i class="fa fa-check"></i><b>9.2.3</b> Entry level: <code>dplyr::group_by()</code></a></li>
<li class="chapter" data-level="9.2.4" data-path="model-with-split-apply-combine-strategy.html"><a href="model-with-split-apply-combine-strategy.html#general-approach-nesting"><i class="fa fa-check"></i><b>9.2.4</b> General approach: nesting</a></li>
<li class="chapter" data-level="9.2.5" data-path="model-with-split-apply-combine-strategy.html"><a href="model-with-split-apply-combine-strategy.html#apply-a-function-purrrmap-and-mutate"><i class="fa fa-check"></i><b>9.2.5</b> Apply a function <code>purrr::map()</code> and <code>mutate()</code></a></li>
<li class="chapter" data-level="9.2.6" data-path="model-with-split-apply-combine-strategy.html"><a href="model-with-split-apply-combine-strategy.html#always-have-an-exit-strategy"><i class="fa fa-check"></i><b>9.2.6</b> Always have an exit strategy</a></li>
<li class="chapter" data-level="9.2.7" data-path="model-with-split-apply-combine-strategy.html"><a href="model-with-split-apply-combine-strategy.html#simplify-and-combine"><i class="fa fa-check"></i><b>9.2.7</b> Simplify and combine</a></li>
<li class="chapter" data-level="9.2.8" data-path="model-with-split-apply-combine-strategy.html"><a href="model-with-split-apply-combine-strategy.html#recap"><i class="fa fa-check"></i><b>9.2.8</b> Recap</a></li>
<li class="chapter" data-level="9.2.9" data-path="model-with-split-apply-combine-strategy.html"><a href="model-with-split-apply-combine-strategy.html#enjoy-the-payoff-of-your-work"><i class="fa fa-check"></i><b>9.2.9</b> Enjoy the payoff of your work</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="rmarkdown.html"><a href="rmarkdown.html"><i class="fa fa-check"></i><b>10</b> RMarkdown</a><ul>
<li class="chapter" data-level="10.1" data-path="rmarkdown.html"><a href="rmarkdown.html#readings-8"><i class="fa fa-check"></i><b>10.1</b> Readings</a></li>
<li class="chapter" data-level="10.2" data-path="rmarkdown.html"><a href="rmarkdown.html#overview"><i class="fa fa-check"></i><b>10.2</b> Overview</a></li>
<li class="chapter" data-level="10.3" data-path="rmarkdown.html"><a href="rmarkdown.html#step-0-software-installation-and-configuration"><i class="fa fa-check"></i><b>10.3</b> Step 0: Software installation and configuration</a></li>
<li class="chapter" data-level="10.4" data-path="rmarkdown.html"><a href="rmarkdown.html#step-1-get-ready-to-work"><i class="fa fa-check"></i><b>10.4</b> Step 1: Get ready to work</a></li>
<li class="chapter" data-level="10.5" data-path="rmarkdown.html"><a href="rmarkdown.html#step-2-practice-with-rstudios-boilerplate-r-markdown-document"><i class="fa fa-check"></i><b>10.5</b> Step 2: Practice with RStudio’s boilerplate R Markdown document</a></li>
<li class="chapter" data-level="10.6" data-path="rmarkdown.html"><a href="rmarkdown.html#step-3-take-control-of-the-output-format"><i class="fa fa-check"></i><b>10.6</b> Step 3: Take control of the output format</a></li>
<li class="chapter" data-level="10.7" data-path="rmarkdown.html"><a href="rmarkdown.html#step-4-swap-out-the-guts-of-the-document"><i class="fa fa-check"></i><b>10.7</b> Step 4: Swap out the “guts” of the document</a></li>
<li class="chapter" data-level="10.8" data-path="rmarkdown.html"><a href="rmarkdown.html#step-5-develop-your-report"><i class="fa fa-check"></i><b>10.8</b> Step 5: Develop your report</a></li>
<li class="chapter" data-level="10.9" data-path="rmarkdown.html"><a href="rmarkdown.html#step-6-publish-your-report"><i class="fa fa-check"></i><b>10.9</b> Step 6: Publish your report</a><ul>
<li class="chapter" data-level="10.9.1" data-path="rmarkdown.html"><a href="rmarkdown.html#html-on-github"><i class="fa fa-check"></i><b>10.9.1</b> HTML on GitHub</a></li>
</ul></li>
<li class="chapter" data-level="10.10" data-path="rmarkdown.html"><a href="rmarkdown.html#troubleshooting"><i class="fa fa-check"></i><b>10.10</b> Troubleshooting</a></li>
<li class="chapter" data-level="10.11" data-path="rmarkdown.html"><a href="rmarkdown.html#learn-more-4"><i class="fa fa-check"></i><b>10.11</b> Learn More</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="resources.html"><a href="resources.html"><i class="fa fa-check"></i><b>11</b> Resources</a><ul>
<li class="chapter" data-level="11.1" data-path="resources.html"><a href="resources.html#where-to-go-from-here"><i class="fa fa-check"></i><b>11.1</b> Where to go from here</a><ul>
<li class="chapter" data-level="11.1.1" data-path="resources.html"><a href="resources.html#automate-testing-your-code"><i class="fa fa-check"></i><b>11.1.1</b> Automate testing your code</a></li>
<li class="chapter" data-level="11.1.2" data-path="resources.html"><a href="resources.html#automate-your-workflow"><i class="fa fa-check"></i><b>11.1.2</b> Automate your workflow</a></li>
<li class="chapter" data-level="11.1.3" data-path="resources.html"><a href="resources.html#share-your-work-as-a-r-package"><i class="fa fa-check"></i><b>11.1.3</b> Share your work as a R package</a></li>
<li class="chapter" data-level="11.1.4" data-path="resources.html"><a href="resources.html#develop-interactive-apps-with-shiny"><i class="fa fa-check"></i><b>11.1.4</b> Develop interactive apps with Shiny</a></li>
<li class="chapter" data-level="11.1.5" data-path="resources.html"><a href="resources.html#where-to-go-from-here-1"><i class="fa fa-check"></i><b>11.1.5</b> Where to go from here</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="resources.html"><a href="resources.html#where-to-find-help"><i class="fa fa-check"></i><b>11.2</b> Where to find help</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Introduction to Data Science for Transportation Researchers, Planners, and Engineers</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="programming-with-r" class="section level1">
<h1><span class="header-section-number">3</span> Programming with R</h1>
<p>This section has been adapted from Software Carpentry lesson <a href="http://swcarpentry.github.io/r-novice-inflammation/">Programming with R</a>.</p>
<div id="readings-1" class="section level2">
<h2><span class="header-section-number">3.1</span> Readings</h2>
<ol style="list-style-type: decimal">
<li>[W] Chapter 4</li>
<li>Software Carpentry <a href="http://swcarpentry.github.io/r-novice-inflammation/">Programming with R</a>.</li>
</ol>
</div>
<div id="starting-with-data" class="section level2">
<h2><span class="header-section-number">3.2</span> Starting with Data</h2>
<p>We are studying inflammation in patients who have been given a new treatment for arthritis, and need to analyze the first dozen data sets.</p>
<p>The data sets are stored in comma-separated values (CSV) format. Each row holds the observations for just one patient. Each column holds the inflammation measured in a day, so we have a set of values in successive days.</p>
<p>The first few rows of our first file look like this:</p>
<pre><code>## 0,0,1,3,1,2,4,7,8,3,3,3,10,5,7,4,7,7,12,18,6,13,11,11,7,7,4,6,8,8,4,4,5,7,3,4,2,3,0,0
## 0,1,2,1,2,1,3,2,2,6,10,11,5,9,4,4,7,16,8,6,18,4,12,5,12,7,11,5,11,3,3,5,4,4,5,5,1,1,0,1
## 0,1,1,3,3,2,6,2,5,9,5,7,4,5,4,15,5,11,9,10,19,14,12,17,7,12,11,7,4,2,10,5,4,2,2,3,2,2,1,1
## 0,0,2,0,4,2,2,1,6,7,10,7,9,13,8,8,15,10,10,7,17,4,4,7,6,15,6,4,9,11,3,5,6,3,3,4,2,3,2,1
## 0,1,1,3,3,1,3,5,2,4,4,7,6,5,3,10,8,10,6,17,9,14,9,7,13,9,12,6,7,7,9,6,3,2,2,4,2,0,1,1</code></pre>
<p>We want to:</p>
<ul>
<li>Load data into memory,</li>
<li>Calculate the average value of inflammation per day across all patients, and</li>
<li>Plot the results.</li>
</ul>
<p>To do all that, we’ll have to learn a little bit about programming.</p>
<div id="loading-data" class="section level3">
<h3><span class="header-section-number">3.2.1</span> Loading Data</h3>
<p>To load our inflammation data, first we need to tell our computer where is the file that contains the values. We have been told its name is <code>inflammation-01.csv</code> in the <code>data</code> folder of our project. This is very important in R, if we forget this step we’ll get an error message when trying to read the file. By default, RStudio sets the current working directory to the root of the project, which we can verify with <code>getwd</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">getwd</span>()</code></pre></div>
<p>Just like in the Unix Shell, we type the command and then press <code>Enter</code> (or <code>return</code>).</p>
<p>We can refer to files in our project using path to relative to the project root. (Alternatively you can change the working directory, using the RStudio GUI using the menu option <code>Session</code> -&gt; <code>Set Working Directory</code> -&gt; <code>Choose Directory...</code> or using <code>setwd</code>, but this is not recommended as this uses absolute path and the scripts you create may not work on a different computer.)</p>
<p>The data files are located in the <code>data</code> subdirectory inside the project directory. Now we can load the data into R using <code>read.csv</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">require</span>(tidyverse)
<span class="kw">read.csv</span>(<span class="dt">file =</span> <span class="st">&quot;data/inflammation-01.csv&quot;</span>, <span class="dt">header =</span> <span class="ot">FALSE</span>)</code></pre></div>
<p>The expression <code>read.csv(...)</code> is a <a href="%7B%7B%20page.root%20%7D%7D/reference/#function-call">function call</a> that asks R to run the function <code>read.csv</code>.</p>
<p><code>read.csv</code> has a few <a href="%7B%7B%20page.root%20%7D%7D/reference/#argument">arguments</a> include: the name of the file we want to read, and whether the first line of the file contains names for the columns of data.</p>
<p>The filename needs to be a character string (or <a href="%7B%7B%20page.root%20%7D%7D/reference/#string">string</a> for short), so we put it in quotes. Assigning the second argument, <code>header</code>, to be <code>FALSE</code> indicates that the data file does not have column headers. We’ll talk more about the value <code>FALSE</code>, and its converse <code>TRUE</code> later in this class.</p>
<blockquote>
<p><strong>Other Options for Reading CSV Files</strong></p>
<p><code>read.csv</code> actually has many more arguments that you may find useful when importing your own data in the future. You can learn more about these options in this supplementary <a href="%7B%7B%20page.root%20%7D%7D/11-supp-read-write-csv/">lesson</a>.</p>
</blockquote>
<blockquote>
<p><strong>Loading Data with Headers</strong></p>
<p>What happens if you forget to put <code>header = FALSE</code>? The default value is <code>header = TRUE</code>, which you can check with <code>?read.csv</code> or <code>help(read.csv)</code>. What do you expect will happen if you leave the default value? Before you run any code, think about what will happen to the first few rows of your data frame, and its overall size. Then run the following code and see if your expectations agree:</p>
<pre><code>read.csv(file = &quot;data/inflammation-01.csv&quot;)</code></pre>
</blockquote>
<p>The utility of a function is that it will perform its given action on whatever value is passed to the named argument(s). For example, in this case if we provided the name of a different file to the argument <code>file</code>, <code>read.csv</code> would read it instead. We’ll learn more of the details about functions and their arguments in the next lesson.</p>
<p>Since we didn’t tell it to do anything else with the function’s output, the console will display the full contents of the file <code>inflammation-01.csv</code>. Try it out.</p>
<p><code>read.csv</code> read the file, but we can’t use data unless we assign it to a variable. A variable is just a name for a value, such as <code>x</code>, <code>current_temperature</code>, or <code>subject_id</code>. We can create a new variable simply by assigning a value to it using <code>&lt;-</code></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">weight_kg &lt;-<span class="st"> </span><span class="dv">55</span></code></pre></div>
<p>Once a variable has a value, we can print it by typing the name of the variable and hitting <code>Enter</code> (or <code>return</code>). In general, R will print to the console any object returned by a function or operation <em>unless</em> we assign it to a variable.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">weight_kg</code></pre></div>
<pre><code>## [1] 55</code></pre>
<p>We can do arithmetic with the variable:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># weight in pounds:</span>
<span class="fl">2.2</span> *<span class="st"> </span>weight_kg</code></pre></div>
<pre><code>## [1] 121</code></pre>
<blockquote>
<p><strong>Commenting</strong></p>
<p>We can add comments to our code using the <code>#</code> character. It is useful to document our code in this way so that others (and us the next time we read it) have an easier time following what the code is doing. {: .callout}</p>
</blockquote>
<p>We can also change an object’s value by assigning it a new value:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">weight_kg &lt;-<span class="st"> </span><span class="fl">57.5</span>
<span class="co"># weight in kilograms is now</span>
weight_kg</code></pre></div>
<pre><code>## [1] 57.5</code></pre>
<p>If we imagine the variable as a sticky note with a name written on it, assignment is like putting the sticky note on a particular value:</p>
<div class="figure">
<img src="fig/python-sticky-note-variables-01.svg" title="Variables as Sticky Notes" alt="Variables as Sticky Notes" />
<p class="caption">Variables as Sticky Notes</p>
</div>
<p>This means that assigning a value to one object does not change the values of other variables. For example, let’s store the subject’s weight in pounds in a variable:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">weight_lb &lt;-<span class="st"> </span><span class="fl">2.2</span> *<span class="st"> </span>weight_kg
<span class="co"># weight in kg...</span>
weight_kg</code></pre></div>
<pre><code>## [1] 57.5</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># ...and in pounds</span>
weight_lb</code></pre></div>
<pre><code>## [1] 126.5</code></pre>
<div class="figure">
<img src="fig/python-sticky-note-variables-02.svg" title="Creating Another Variable" alt="Creating Another Variable" />
<p class="caption">Creating Another Variable</p>
</div>
<p>and then change <code>weight_kg</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">weight_kg &lt;-<span class="st"> </span><span class="fl">100.0</span>
<span class="co"># weight in kg now...</span>
weight_kg</code></pre></div>
<pre><code>## [1] 100</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># ...and weight in pounds still</span>
weight_lb</code></pre></div>
<pre><code>## [1] 126.5</code></pre>
<div class="figure">
<img src="fig/python-sticky-note-variables-03.svg" title="Updating a Variable" alt="Updating a Variable" />
<p class="caption">Updating a Variable</p>
</div>
<p>Since <code>weight_lb</code> doesn’t “remember” where its value came from, it isn’t automatically updated when <code>weight_kg</code> changes. This is different from the way spreadsheets work.</p>
<blockquote>
<p><strong>Printing with Parentheses</strong></p>
<p>An alternative way to print the value of a variable is to use () around the assignment statement. As an example: <code>(total_weight &lt;- weight_kg + weight_lb)</code> adds the values of <code>weight_kg</code> and <code>weight_lb</code>, assigns the result to the <code>total_weight</code>, and finally prints the assigned value of the variable <code>total_weight</code>. {: .callout}</p>
</blockquote>
<p>Now that we know how to assign things to variables, let’s re-run <code>read.csv</code> and save its result:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dat &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="dt">file =</span> <span class="st">&quot;data/inflammation-01.csv&quot;</span>, <span class="dt">header =</span> <span class="ot">FALSE</span>)</code></pre></div>
<p>This statement doesn’t produce any output because assignment doesn’t display anything. If we want to check that our data has been loaded, we can print the variable’s value. However, for large data sets it is convenient to use the function <code>head</code> to display only the first few rows of data.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(dat)</code></pre></div>
<pre><code>##   V1 V2 V3 V4 V5 V6 V7 V8 V9 V10 V11 V12 V13 V14 V15 V16 V17 V18 V19 V20
## 1  0  0  1  3  1  2  4  7  8   3   3   3  10   5   7   4   7   7  12  18
## 2  0  1  2  1  2  1  3  2  2   6  10  11   5   9   4   4   7  16   8   6
## 3  0  1  1  3  3  2  6  2  5   9   5   7   4   5   4  15   5  11   9  10
## 4  0  0  2  0  4  2  2  1  6   7  10   7   9  13   8   8  15  10  10   7
## 5  0  1  1  3  3  1  3  5  2   4   4   7   6   5   3  10   8  10   6  17
## 6  0  0  1  2  2  4  2  1  6   4   7   6   6   9   9  15   4  16  18  12
##   V21 V22 V23 V24 V25 V26 V27 V28 V29 V30 V31 V32 V33 V34 V35 V36 V37 V38
## 1   6  13  11  11   7   7   4   6   8   8   4   4   5   7   3   4   2   3
## 2  18   4  12   5  12   7  11   5  11   3   3   5   4   4   5   5   1   1
## 3  19  14  12  17   7  12  11   7   4   2  10   5   4   2   2   3   2   2
## 4  17   4   4   7   6  15   6   4   9  11   3   5   6   3   3   4   2   3
## 5   9  14   9   7  13   9  12   6   7   7   9   6   3   2   2   4   2   0
## 6  12   5  18   9   5   3  10   3  12   7   8   4   7   3   5   4   4   3
##   V39 V40
## 1   0   0
## 2   0   1
## 3   1   1
## 4   2   1
## 5   1   1
## 6   2   1</code></pre>
<blockquote>
<p><strong>Assigning Values to Variables</strong></p>
<p>Draw diagrams showing what variables refer to what values after each statement in the following program:</p>
<pre><code>mass &lt;- 47.5
age &lt;- 122
mass &lt;- mass * 2.0
age &lt;- age - 20</code></pre>
<p>{: .r} {: .challenge}</p>
</blockquote>
</div>
<div id="manipulating-data" class="section level3">
<h3><span class="header-section-number">3.2.2</span> Manipulating Data</h3>
<p>Now that our data is loaded in memory, we can start doing things with it. First, let’s ask what type of thing <code>dat</code> is:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">class</span>(dat)</code></pre></div>
<pre><code>## [1] &quot;data.frame&quot;</code></pre>
<p>The output tells us that is a data frame. Think of this structure as a spreadsheet in MS Excel that many of us are familiar with. Data frames are very useful for storing data and you will find them elsewhere when programming in R. A typical data frame of experimental data contains individual observations in rows and variables in columns.</p>
<p>We can see the shape, or <a href="%7B%7B%20page.root%20%7D%7D/reference/#dimensions">dimensions</a>, of the data frame with the function <code>dim</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">dim</span>(dat)</code></pre></div>
<pre><code>## [1] 60 40</code></pre>
<p>This tells us that our data frame, <code>dat</code>, has 60 rows and 40 columns.</p>
<p>If we want to get a single value from the data frame, we can provide an <a href="%7B%7B%20page.root%20%7D%7D/reference/#index">index</a> in square brackets, just as we do in math:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># first value in dat</span>
dat[<span class="dv">1</span>, <span class="dv">1</span>]</code></pre></div>
<pre><code>## [1] 0</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># middle value in dat</span>
dat[<span class="dv">30</span>, <span class="dv">20</span>]</code></pre></div>
<pre><code>## [1] 16</code></pre>
<p>An index like <code>[30, 20]</code> selects a single element of a data frame, but we can select whole sections as well. For example, we can select the first ten days (columns) of values for the first four patients (rows) like this:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dat[<span class="dv">1</span>:<span class="dv">4</span>, <span class="dv">1</span>:<span class="dv">10</span>]</code></pre></div>
<pre><code>##   V1 V2 V3 V4 V5 V6 V7 V8 V9 V10
## 1  0  0  1  3  1  2  4  7  8   3
## 2  0  1  2  1  2  1  3  2  2   6
## 3  0  1  1  3  3  2  6  2  5   9
## 4  0  0  2  0  4  2  2  1  6   7</code></pre>
<p>The <a href="%7B%7B%20page.root%20%7D%7D/reference/#slice">slice</a> <code>1:4</code> means, “Start at index 1 and go to index 4.”</p>
<p>The slice does not need to start at 1, e.g. the line below selects rows 5 through 10:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dat[<span class="dv">5</span>:<span class="dv">10</span>, <span class="dv">1</span>:<span class="dv">10</span>]</code></pre></div>
<pre><code>##    V1 V2 V3 V4 V5 V6 V7 V8 V9 V10
## 5   0  1  1  3  3  1  3  5  2   4
## 6   0  0  1  2  2  4  2  1  6   4
## 7   0  0  2  2  4  2  2  5  5   8
## 8   0  0  1  2  3  1  2  3  5   3
## 9   0  0  0  3  1  5  6  5  5   8
## 10  0  1  1  2  1  3  5  3  5   8</code></pre>
<p>We can use the function <code>c</code>, which stands for <strong>c</strong>ombine, to select non-contiguous values:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dat[<span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">8</span>, <span class="dv">37</span>, <span class="dv">56</span>), <span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">14</span>, <span class="dv">29</span>)]</code></pre></div>
<pre><code>##    V10 V14 V29
## 3    9   5   4
## 8    3   5   6
## 37   6   9  10
## 56   7  11   9</code></pre>
<p>We also don’t have to provide a slice for either the rows or the columns. If we don’t include a slice for the rows, R returns all the rows; if we don’t include a slice for the columns, R returns all the columns. If we don’t provide a slice for either rows or columns, e.g. <code>dat[, ]</code>, R returns the full data frame.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># All columns from row 5</span>
dat[<span class="dv">5</span>, ]</code></pre></div>
<pre><code>##   V1 V2 V3 V4 V5 V6 V7 V8 V9 V10 V11 V12 V13 V14 V15 V16 V17 V18 V19 V20
## 5  0  1  1  3  3  1  3  5  2   4   4   7   6   5   3  10   8  10   6  17
##   V21 V22 V23 V24 V25 V26 V27 V28 V29 V30 V31 V32 V33 V34 V35 V36 V37 V38
## 5   9  14   9   7  13   9  12   6   7   7   9   6   3   2   2   4   2   0
##   V39 V40
## 5   1   1</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># All rows from column 16</span>
dat[, <span class="dv">16</span>]</code></pre></div>
<pre><code>##  [1]  4  4 15  8 10 15 13  9 11  6  3  8 12  3  5 10 11  4 11 13 15  5 14
## [24] 13  4  9 13  6  7  6 14  3 15  4 15 11  7 10 15  6  5  6 15 11 15  6
## [47] 11 15 14  4 10 15 11  6 13  8  4 13 12  9</code></pre>
<blockquote>
<p><strong>Addressing Columns by Name</strong></p>
<p>Columns can also be addressed by name, with either the <code>$</code> operator (ie. <code>dat$Age</code>) or square brackets (ie. <code>dat[,'Age']</code>). You can learn more about subsetting by column name in this supplementary <a href="%7B%7B%20page.root%20%7D%7D/10-supp-addressing-data/">lesson</a>. {: .callout}</p>
</blockquote>
<p>Now let’s perform some common mathematical operations to learn about our inflammation data. When analyzing data we often want to look at partial statistics, such as the maximum value per patient or the average value per day. One way to do this is to select the data we want to create a new temporary data frame, and then perform the calculation on this subset:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># first row, all of the columns</span>
patient_1 &lt;-<span class="st"> </span>dat[<span class="dv">1</span>, ]
<span class="co"># max inflammation for patient 1</span>
<span class="kw">max</span>(patient_1)</code></pre></div>
<pre><code>## [1] 18</code></pre>
<blockquote>
<p><strong>Forcing Conversion</strong></p>
<p>The code above may give you an error in some R installations, since R does not automatically convert a sliced row of a <code>data.frame</code> to a vector. (Confusingly, sliced columns are automatically converted.) If this happens, you can use the <code>as.numeric</code> command to convert the row of data to a numeric vector:</p>
<p><code>patient_1 &lt;- as.numeric(dat[1, ])</code></p>
<p><code>max(patient_1)</code></p>
<p>You can also check the <code>class</code> of each object:</p>
<p><code>class(dat[1, ])</code></p>
<p><code>class(as.numeric(dat[1, ]))</code></p>
</blockquote>
<p>We don’t actually need to store the row in a variable of its own. Instead, we can combine the selection and the function call:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># max inflammation for patient 2</span>
<span class="kw">max</span>(dat[<span class="dv">2</span>, ])</code></pre></div>
<pre><code>## [1] 18</code></pre>
<p>R also has functions for other common calculations, e.g. finding the minimum, mean, median, and standard deviation of the data:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># minimum inflammation on day 7</span>
<span class="kw">min</span>(dat[, <span class="dv">7</span>])</code></pre></div>
<pre><code>## [1] 1</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># mean inflammation on day 7</span>
<span class="kw">mean</span>(dat[, <span class="dv">7</span>])</code></pre></div>
<pre><code>## [1] 3.8</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># median inflammation on day 7</span>
<span class="kw">median</span>(dat[, <span class="dv">7</span>])</code></pre></div>
<pre><code>## [1] 4</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># standard deviation of inflammation on day 7</span>
<span class="kw">sd</span>(dat[, <span class="dv">7</span>])</code></pre></div>
<pre><code>## [1] 1.725187</code></pre>
<p>What if we need the maximum inflammation for all patients, or the average for each day? As the diagram below shows, we want to perform the operation across a margin of the data frame:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">knitr::<span class="kw">include_graphics</span>(<span class="st">&quot;fig/r-operations-across-axes.svg&quot;</span>)</code></pre></div>
<div class="figure">
<img src="fig/r-operations-across-axes.svg" alt="Operations Across Axes."  />
<p class="caption">
(#fig:apply_axes)Operations Across Axes.
</p>
</div>
<p>To support this, we can use the <code>apply</code> function.</p>
<blockquote>
<p><strong>Getting Help</strong></p>
<p>To learn about a function in R, e.g. <code>apply</code>, we can read its help documention by running <code>help(apply)</code> or <code>?apply</code>. {: .callout}</p>
</blockquote>
<p><code>apply</code> allows us to repeat a function on all of the rows (<code>MARGIN = 1</code>) or columns (<code>MARGIN = 2</code>) of a data frame.</p>
<p>Thus, to obtain the average inflammation of each patient we will need to calculate the mean of all of the rows (<code>MARGIN = 1</code>) of the data frame.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">avg_patient_inflammation &lt;-<span class="st"> </span><span class="kw">apply</span>(dat, <span class="dv">1</span>, mean)</code></pre></div>
<p>And to obtain the average inflammation of each day we will need to calculate the mean of all of the columns (<code>MARGIN = 2</code>) of the data frame.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">avg_day_inflammation &lt;-<span class="st"> </span><span class="kw">apply</span>(dat, <span class="dv">2</span>, mean)</code></pre></div>
<p>Since the second argument to <code>apply</code> is <code>MARGIN</code>, the above command is equivalent to <code>apply(dat, MARGIN = 2, mean)</code>. We’ll learn why this is so in the next lesson.</p>
<blockquote>
<p><strong>Efficient Alternatives</strong></p>
<p>Some common operations have more efficient alternatives. For example, you can calculate the row-wise or column-wise means with <code>rowMeans</code> and <code>colMeans</code>, respectively. {: .callout}</p>
</blockquote>
<blockquote>
<p><strong>Slicing (Subsetting) Data</strong></p>
<p>A subsection of a data frame is called a <a href="%7B%7B%20page.root%20%7D%7D/reference/#slice">slice</a>. We can take slices of character vectors as well:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">animal &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;m&quot;</span>, <span class="st">&quot;o&quot;</span>, <span class="st">&quot;n&quot;</span>, <span class="st">&quot;k&quot;</span>, <span class="st">&quot;e&quot;</span>, <span class="st">&quot;y&quot;</span>)
<span class="co"># first three characters</span>
animal[<span class="dv">1</span>:<span class="dv">3</span>]</code></pre></div>
<pre><code>## [1] &quot;m&quot; &quot;o&quot; &quot;n&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># last three characters</span>
animal[<span class="dv">4</span>:<span class="dv">6</span>]</code></pre></div>
<pre><code>## [1] &quot;k&quot; &quot;e&quot; &quot;y&quot;</code></pre>
<ol style="list-style-type: decimal">
<li><p>If the first four characters are selected using the slice <code>animal[1:4]</code>, how can we obtain the first four characters in reverse order?</p></li>
<li><p>What is <code>animal[-1]</code>? What is <code>animal[-4]</code>? Given those answers, explain what <code>animal[-1:-4]</code> does.</p></li>
<li><p>Use a slice of <code>animal</code> to create a new character vector that spells the word “eon”, i.e. <code>c(&quot;e&quot;, &quot;o&quot;, &quot;n&quot;)</code>.</p></li>
</ol>
</blockquote>
<blockquote>
<p><strong>Subsetting More Data</strong></p>
<p>Suppose you want to determine the maximum inflammation for patient 5 across days three to seven. To do this you would extract the relevant slice from the data frame and calculate the maximum value. Which of the following lines of R code gives the correct answer?</p>
<ol style="list-style-type: decimal">
<li><code>max(dat[5, ])</code></li>
<li><code>max(dat[3:7, 5])</code></li>
<li><code>max(dat[5, 3:7])</code></li>
<li><code>max(dat[5, 3, 7])</code></li>
</ol>
</blockquote>
<blockquote>
<p><strong>Slicing and Re-Assignment</strong></p>
<p>Using the inflammation data frame <code>dat</code> from above: Let’s pretend there was something wrong with the instrument on the first five days for every second patient (#2, 4, 6, etc.), which resulted in the measurements being twice as large as they should be.</p>
<ol style="list-style-type: decimal">
<li>Write a vector containing each affected patient (hint: <code>? seq</code>)</li>
<li>Create a new data frame with in which you halve the first five days’ values in only those patients</li>
<li>Print out the corrected data frame to check that your code has fixed the problem</li>
</ol>
<!-- > > ## Solution -->
<!-- > > ~~~ -->
<!-- > > whichPatients <- seq(2,40,2) -->
<!-- > > whichDays <- c(1:5) -->
<!-- > > dat2 <- dat -->
<!-- > > dat2[whichPatients,whichDays] <- dat2[whichPatients,whichDays]/2 -->
<!-- > > (dat2) -->
<!-- > > ~~~ -->
</blockquote>
<blockquote>
<p><strong>Using the Apply Function on Patient Data</strong></p>
<p>Challenge: the apply function can be used to summarize datasets and subsets of data across rows and columns using the MARGIN argument. Suppose you want to calculate the mean inflammation for specific days and patients in the patient dataset (i.e. 60 patients across 40 days).</p>
<p>Please use a combination of the apply function and indexing to:</p>
<ol style="list-style-type: decimal">
<li>calculate the mean inflammation for patients 1 to 5 over the whole 40 days</li>
<li>calculate the mean inflammation for days 1 to 10 (across all patients).</li>
<li>calculate the mean inflammation for every second day (across all patients).</li>
</ol>
<p>Think about the number of rows and columns you would expect as the result before each apply call and check your intuition by applying the mean function.</p>
<!-- > > ## Solution -->
<!-- > > ~~~ -->
<!-- > > # 1. -->
<!-- > > apply(dat[1:5, ], 1, mean) -->
<!-- > > # 2. -->
<!-- > > apply(dat[, 1:10], 2, mean) -->
<!-- > > # 3. -->
<!-- > > apply(dat[, seq(1,40, by=2)], 2, mean) -->
<!-- > > ~~~ -->
</blockquote>
</div>
<div id="plotting" class="section level3">
<h3><span class="header-section-number">3.2.3</span> Plotting</h3>
<p>The mathematician Richard Hamming once said, “The purpose of computing is insight, not numbers,” and the best way to develop insight is often to visualize data. We will come back to visualization later in the course, but let’s explore a few of R’s plotting features quickly.</p>
<p>Let’s take a look at the average inflammation over time. Recall that we already calculated these values above using <code>apply(dat, 2, mean)</code> and saved them in the variable <code>avg_day_inflammation</code>. Plotting the values is done with the function <code>plot</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(avg_day_inflammation)</code></pre></div>
<p><img src="_main_files/figure-html/plot-avg-inflammation-1.png" width="672" /></p>
<p>Above, we gave the function <code>plot</code> a vector of numbers corresponding to the average inflammation per day across all patients. <code>plot</code> created a scatter plot where the y-axis is the average inflammation level and the x-axis is the order, or index, of the values in the vector, which in this case correspond to the 40 days of treatment. The result is roughly a linear rise and fall, which is suspicious: based on other studies, we expect a sharper rise and slower fall. Let’s have a look at two other statistics: the maximum and minimum inflammation per day.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">max_day_inflammation &lt;-<span class="st"> </span><span class="kw">apply</span>(dat, <span class="dv">2</span>, max)
<span class="kw">plot</span>(max_day_inflammation)</code></pre></div>
<p><img src="_main_files/figure-html/plot-max-inflammation-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">min_day_inflammation &lt;-<span class="st"> </span><span class="kw">apply</span>(dat, <span class="dv">2</span>, min)
<span class="kw">plot</span>(min_day_inflammation)</code></pre></div>
<p><img src="_main_files/figure-html/plot-min-inflammation-1.png" width="672" /></p>
<p>The maximum value rises and falls perfectly smoothly, while the minimum seems to be a step function. Neither result seems particularly likely, so either there’s a mistake in our calculations or something is wrong with our data.</p>
<blockquote>
<p><strong>Plotting Data</strong></p>
<p>Create a plot showing the standard deviation of the inflammation data for each day across all patients.</p>
</blockquote>
</div>
</div>
<div id="creating-functions" class="section level2">
<h2><span class="header-section-number">3.3</span> Creating Functions</h2>
<p>If we only had one data set to analyze, it would probably be faster to load the file into a spreadsheet and use that to plot some simple statistics. But we have twelve files to check, and may have more in the future. In this lesson, we’ll learn how to write a function so that we can repeat several operations with a single command.</p>
<div id="defining-a-function" class="section level3">
<h3><span class="header-section-number">3.3.1</span> Defining a Function</h3>
<p>Let’s start by defining a function <code>fahr_to_kelvin</code> that converts temperatures from Fahrenheit to Kelvin:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fahr_to_kelvin &lt;-<span class="st"> </span>function(temp) {
  kelvin &lt;-<span class="st"> </span>((temp -<span class="st"> </span><span class="dv">32</span>) *<span class="st"> </span>(<span class="dv">5</span> /<span class="st"> </span><span class="dv">9</span>)) +<span class="st"> </span><span class="fl">273.15</span>
  <span class="kw">return</span>(kelvin)
}</code></pre></div>
<p>We define <code>fahr_to_kelvin</code> by assigning it to the output of <code>function</code>. The list of argument names are contained within parentheses. Next, the <a href="%7B%7B%20page.root%20%7D%7D/reference/#function-body">body</a> of the function–the statements that are executed when it runs–is contained within curly braces (<code>{}</code>). The statements in the body are indented by two spaces, which makes the code easier to read but does not affect how the code operates.</p>
<p>When we call the function, the values we pass to it are assigned to those variables so that we can use them inside the function. Inside the function, we use a <a href="%7B%7B%20page.root%20%7D%7D/reference/#return-statement">return statement</a> to send a result back to whoever asked for it.</p>
<blockquote>
<p><strong>Automatic Returns</strong></p>
<p>In R, it is not necessary to include the return statement. R automatically returns whichever variable is on the last line of the body of the function. Since we are just learning, we will explicitly define the return statement.</p>
</blockquote>
<p>Let’s try running our function. Calling our own function is no different from calling any other function:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># freezing point of water</span>
<span class="kw">fahr_to_kelvin</span>(<span class="dv">32</span>)</code></pre></div>
<pre><code>## [1] 273.15</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># boiling point of water</span>
<span class="kw">fahr_to_kelvin</span>(<span class="dv">212</span>)</code></pre></div>
<pre><code>## [1] 373.15</code></pre>
<p>We’ve successfully called the function that we defined, and we have access to the value that we returned.</p>
</div>
<div id="composing-functions" class="section level3">
<h3><span class="header-section-number">3.3.2</span> Composing Functions</h3>
<p>Now that we’ve seen how to turn Fahrenheit into Kelvin, it’s easy to turn Kelvin into Celsius:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">kelvin_to_celsius &lt;-<span class="st"> </span>function(temp) {
  celsius &lt;-<span class="st"> </span>temp -<span class="st"> </span><span class="fl">273.15</span>
  <span class="kw">return</span>(celsius)
}

<span class="co">#absolute zero in Celsius</span>
<span class="kw">kelvin_to_celsius</span>(<span class="dv">0</span>)</code></pre></div>
<pre><code>## [1] -273.15</code></pre>
<p>What about converting Fahrenheit to Celsius? We could write out the formula, but we don’t need to. Instead, we can <a href="%7B%7B%20page.root%20%7D%7D/reference/#function-composition">compose</a> the two functions we have already created:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fahr_to_celsius &lt;-<span class="st"> </span>function(temp) {
  temp_k &lt;-<span class="st"> </span><span class="kw">fahr_to_kelvin</span>(temp)
  result &lt;-<span class="st"> </span><span class="kw">kelvin_to_celsius</span>(temp_k)
  <span class="kw">return</span>(result)
}

<span class="co"># freezing point of water in Celsius</span>
<span class="kw">fahr_to_celsius</span>(<span class="fl">32.0</span>)</code></pre></div>
<pre><code>## [1] 0</code></pre>
<p>This is our first taste of how larger programs are built: we define basic operations, then combine them in ever-larger chunks to get the effect we want. Real-life functions will usually be larger than the ones shown here–typically half a dozen to a few dozen lines–but they shouldn’t ever be much longer than that, or the next person who reads it won’t be able to understand what’s going on.</p>
<blockquote>
<p><strong>Chaining Functions</strong></p>
<p>This example showed the output of <code>fahr_to_kelvin</code> assigned to <code>temp_k</code>, which is then passed to <code>kelvin_to_celsius</code> to get the final result. It is also possible to perform this calculation in one line of code, by “chaining” functions together, like so:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># freezing point of water in Celsius</span>
<span class="kw">kelvin_to_celsius</span>(<span class="kw">fahr_to_kelvin</span>(<span class="fl">32.0</span>))</code></pre></div>
<pre><code>## [1] 0</code></pre>
</blockquote>
<blockquote>
<p><strong>Create a Function</strong></p>
<p>In the last lesson, we learned to <strong>c</strong>oncatenate elements into a vector using the <code>c</code> function, e.g. <code>x &lt;- c(&quot;A&quot;, &quot;B&quot;, &quot;C&quot;)</code> creates a vector <code>x</code> with three elements. Furthermore, we can extend that vector again using <code>c</code>, e.g. <code>y &lt;- c(x, &quot;D&quot;)</code> creates a vector <code>y</code> with four elements. Write a function called <code>fence</code> that takes two vectors as arguments, called <code>original</code> and <code>wrapper</code>, and returns a new vector that has the wrapper vector at the beginning and end of the original:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">best_practice &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Write&quot;</span>, <span class="st">&quot;programs&quot;</span>, <span class="st">&quot;for&quot;</span>, <span class="st">&quot;people&quot;</span>, <span class="st">&quot;not&quot;</span>, <span class="st">&quot;computers&quot;</span>)
asterisk &lt;-<span class="st"> &quot;***&quot;</span>  <span class="co"># R interprets a variable with a single value as a vector</span>
                   <span class="co"># with one element.</span>
<span class="kw">fence</span>(best_practice, asterisk)</code></pre></div>
<pre><code>## [1] &quot;***&quot;       &quot;Write&quot;     &quot;programs&quot;  &quot;for&quot;       &quot;people&quot;    &quot;not&quot;      
## [7] &quot;computers&quot; &quot;***&quot;</code></pre>
<p>If the variable <code>v</code> refers to a vector, then <code>v[1]</code> is the vector’s first element and <code>v[length(v)]</code> is its last (the function <code>length</code> returns the number of elements in a vector). Write a function called <code>outside</code> that returns a vector made up of just the first and last elements of its input:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dry_principle &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Don&#39;t&quot;</span>, <span class="st">&quot;repeat&quot;</span>, <span class="st">&quot;yourself&quot;</span>, <span class="st">&quot;or&quot;</span>, <span class="st">&quot;others&quot;</span>)
<span class="kw">outside</span>(dry_principle)</code></pre></div>
<pre><code>## [1] &quot;Don&#39;t&quot;  &quot;others&quot;</code></pre>
</blockquote>
<blockquote>
<p><strong>The Call Stack</strong></p>
<p>For a deeper understanding of how functions work, you’ll need to learn how they create their own environments and call other functions. Function calls are managed via the call stack. For more details on the call stack, have a look at the <a href="%7B%7B%20page.root%20%7D%7D/14-supp-call-stack/">supplementary material</a>.</p>
</blockquote>
<blockquote>
<p><strong>Named Variables and the Scope of Variables</strong></p>
<ul>
<li>Functions can accept arguments explicitly assigned to a variable name in in the function call <code>functionName(variable = value)</code>, as well as arguments by order:</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">input_1 =<span class="st"> </span><span class="dv">20</span>
mySum &lt;-<span class="st"> </span>function(input_1, <span class="dt">input_2 =</span> <span class="dv">10</span>) {
  output &lt;-<span class="st"> </span>input_1 +<span class="st"> </span>input_2
  <span class="kw">return</span>(output)
}</code></pre></div>
<ol style="list-style-type: decimal">
<li>Given the above code was run, which value does <code>mySum(input_1 = 1, 3)</code> produce?
<ol style="list-style-type: decimal">
<li>4</li>
<li>11</li>
<li>23</li>
<li>30</li>
</ol></li>
<li>If <code>mySum(3)</code> returns 13, why does <code>mySum(input_2 = 3)</code> return an error?</li>
</ol>
</blockquote>
</div>
<div id="testing-and-documenting" class="section level3">
<h3><span class="header-section-number">3.3.3</span> Testing and Documenting</h3>
<p>Once we start putting things in functions so that we can re-use them, we need to start testing that those functions are working correctly. To see how to do this, let’s write a function to center a dataset around a particular value:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">center &lt;-<span class="st"> </span>function(data, desired) {
  new_data &lt;-<span class="st"> </span>(data -<span class="st"> </span><span class="kw">mean</span>(data)) +<span class="st"> </span>desired
  <span class="kw">return</span>(new_data)
}</code></pre></div>
<p>We could test this on our actual data, but since we don’t know what the values ought to be, it will be hard to tell if the result was correct. Instead, let’s create a vector of 0s and then center that around 3. This will make it simple to see if our function is working as expected:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">z &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>)
z</code></pre></div>
<pre><code>## [1] 0 0 0 0</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">center</span>(z, <span class="dv">3</span>)</code></pre></div>
<pre><code>## [1] 3 3 3 3</code></pre>
<p>That looks right, so let’s try center on our real data. We’ll center the inflammation data from day 4 around 0:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dat &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="dt">file =</span> <span class="st">&quot;data/inflammation-01.csv&quot;</span>, <span class="dt">header =</span> <span class="ot">FALSE</span>)
centered &lt;-<span class="st"> </span><span class="kw">center</span>(dat[, <span class="dv">4</span>], <span class="dv">0</span>)
<span class="kw">head</span>(centered)</code></pre></div>
<pre><code>## [1]  1.25 -0.75  1.25 -1.75  1.25  0.25</code></pre>
<p>It’s hard to tell from the default output whether the result is correct, but there are a few simple tests that will reassure us:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># original min</span>
<span class="kw">min</span>(dat[, <span class="dv">4</span>])</code></pre></div>
<pre><code>## [1] 0</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># original mean</span>
<span class="kw">mean</span>(dat[, <span class="dv">4</span>])</code></pre></div>
<pre><code>## [1] 1.75</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># original max</span>
<span class="kw">max</span>(dat[, <span class="dv">4</span>])</code></pre></div>
<pre><code>## [1] 3</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># centered min</span>
<span class="kw">min</span>(centered)</code></pre></div>
<pre><code>## [1] -1.75</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># centered mean</span>
<span class="kw">mean</span>(centered)</code></pre></div>
<pre><code>## [1] 0</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># centered max</span>
<span class="kw">max</span>(centered)</code></pre></div>
<pre><code>## [1] 1.25</code></pre>
<p>That seems almost right: the original mean was about 1.75, so the lower bound from zero is now about -1.75. The mean of the centered data is 0. We can even go further and check that the standard deviation hasn’t changed:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># original standard deviation</span>
<span class="kw">sd</span>(dat[, <span class="dv">4</span>])</code></pre></div>
<pre><code>## [1] 1.067628</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># centered standard deviation</span>
<span class="kw">sd</span>(centered)</code></pre></div>
<pre><code>## [1] 1.067628</code></pre>
<p>Those values look the same, but we probably wouldn’t notice if they were different in the sixth decimal place. Let’s do this instead:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># difference in standard deviations before and after</span>
<span class="kw">sd</span>(dat[, <span class="dv">4</span>]) -<span class="st"> </span><span class="kw">sd</span>(centered)</code></pre></div>
<pre><code>## [1] 0</code></pre>
<p>Sometimes, a very small difference can be detected due to rounding at very low decimal places. R has a useful function for comparing two objects allowing for rounding errors, <code>all.equal</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">all.equal</span>(<span class="kw">sd</span>(dat[, <span class="dv">4</span>]), <span class="kw">sd</span>(centered))</code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<p>It’s still possible that our function is wrong, but it seems unlikely enough that we should probably get back to doing our analysis. We have one more task first, though: we should write some <a href="%7B%7B%20page.root%20%7D%7D/reference#documentation">documentation</a> for our function to remind ourselves later what it’s for and how to use it.</p>
<p>A common way to put documentation in software is to add <a href="%7B%7B%20page.root%20%7D%7D/reference/#comment">comments</a> like this:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">center &lt;-<span class="st"> </span>function(data, desired) {
  <span class="co"># return a new vector containing the original data centered around the</span>
  <span class="co"># desired value.</span>
  <span class="co"># Example: center(c(1, 2, 3), 0) =&gt; c(-1, 0, 1)</span>
  new_data &lt;-<span class="st"> </span>(data -<span class="st"> </span><span class="kw">mean</span>(data)) +<span class="st"> </span>desired
  <span class="kw">return</span>(new_data)
}</code></pre></div>
<blockquote>
<p><strong>Writing Documentation</strong></p>
<p>Formal documentation for R functions is written in separate <code>.Rd</code> using a markup language similar to <a href="http://www.latex-project.org/">LaTeX</a>. You see the result of this documentation when you look at the help file for a given function, e.g. <code>?read.csv</code>. The <a href="http://cran.r-project.org/web/packages/roxygen2/vignettes/rd.html">roxygen2</a> package allows R coders to write documentation alongside the function code and then process it into the appropriate <code>.Rd</code> files. You will want to switch to this more formal method of writing documentation when you start writing more complicated R projects.</p>
</blockquote>
<blockquote>
<p><strong>Functions to Create Graphs</strong></p>
<p>Write a function called <code>analyze</code> that takes a filename as a argument and displays the three graphs produced in the [previous lesson][01] (average, min and max inflammation over time). <code>analyze(&quot;data/inflammation-01.csv&quot;)</code> should produce the graphs already shown, while <code>analyze(&quot;data/inflammation-02.csv&quot;)</code> should produce corresponding graphs for the second data set. Be sure to document your function with comments.</p>
<!-- > > ## Solution -->
<!-- > > ~~~ -->
<!-- > > analyze <- function(filename) { -->
<!-- > >   # Plots the average, min, and max inflammation over time. -->
<!-- > >   # Input is character string of a csv file. -->
<!-- > >   dat <- read.csv(file = filename, header = FALSE) -->
<!-- > >   avg_day_inflammation <- apply(dat, 2, mean) -->
<!-- > >   plot(avg_day_inflammation) -->
<!-- > >   max_day_inflammation <- apply(dat, 2, max) -->
<!-- > >   plot(max_day_inflammation) -->
<!-- > >   min_day_inflammation <- apply(dat, 2, min) -->
<!-- > >   plot(min_day_inflammation) -->
<!-- > > } -->
<!-- > > ~~~ -->
</blockquote>
<blockquote>
<p><strong>Rescaling</strong></p>
<p>Write a function <code>rescale</code> that takes a vector as input and returns a corresponding vector of values scaled to lie in the range 0 to 1. (If <span class="math inline">\(L\)</span> and <span class="math inline">\(H\)</span> are the lowest and highest values in the original vector, then the replacement for a value <span class="math inline">\(v\)</span> should be <span class="math inline">\((v-L) / (H-L)\)</span>.) Be sure to document your function with comments.</p>
<p>Test that your <code>rescale</code> function is working properly using <code>min</code>, <code>max</code>, and <code>plot</code>.</p>
<!-- > > ## Solution -->
<!-- > > ~~~ -->
<!-- > > rescale <- function(v) { -->
<!-- > >   # Rescales a vector, v, to lie in the range 0 to 1. -->
<!-- > >   L <- min(v) -->
<!-- > >   H <- max(v) -->
<!-- > >   result <- (v - L) / (H - L) -->
<!-- > >   return(result) -->
<!-- > > } -->
<!-- > > ~~~ -->
</blockquote>
</div>
<div id="defining-defaults" class="section level3">
<h3><span class="header-section-number">3.3.4</span> Defining Defaults</h3>
<p>We have passed arguments to functions in two ways: directly, as in <code>dim(dat)</code>, and by name, as in <code>read.csv(file = &quot;data/inflammation-01.csv&quot;, header = FALSE)</code>. In fact, we can pass the arguments to <code>read.csv</code> without naming them:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dat &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/inflammation-01.csv&quot;</span>, <span class="ot">FALSE</span>)</code></pre></div>
<p>However, the position of the arguments matters if they are not named.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dat &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="dt">header =</span> <span class="ot">FALSE</span>, <span class="dt">file =</span> <span class="st">&quot;data/inflammation-01.csv&quot;</span>)
dat &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="ot">FALSE</span>, <span class="st">&quot;data/inflammation-01.csv&quot;</span>)</code></pre></div>
<pre><code>## Error in read.table(file = file, header = header, sep = sep, quote = quote, : &#39;file&#39; must be a character string or connection</code></pre>
<p>To understand what’s going on, and make our own functions easier to use, let’s re-define our <code>center</code> function like this:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">center &lt;-<span class="st"> </span>function(data, <span class="dt">desired =</span> <span class="dv">0</span>) {
  <span class="co"># return a new vector containing the original data centered around the</span>
  <span class="co"># desired value (0 by default).</span>
  <span class="co"># Example: center(c(1, 2, 3), 0) =&gt; c(-1, 0, 1)</span>
  new_data &lt;-<span class="st"> </span>(data -<span class="st"> </span><span class="kw">mean</span>(data)) +<span class="st"> </span>desired
  <span class="kw">return</span>(new_data)
}</code></pre></div>
<p>The key change is that the second argument is now written <code>desired = 0</code> instead of just <code>desired</code>. If we call the function with two arguments, it works as it did before:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">test_data &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>)
<span class="kw">center</span>(test_data, <span class="dv">3</span>)</code></pre></div>
<pre><code>## [1] 3 3 3 3</code></pre>
<p>But we can also now call <code>center()</code> with just one argument, in which case <code>desired</code> is automatically assigned the default value of <code>0</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">more_data &lt;-<span class="st"> </span><span class="dv">5</span> +<span class="st"> </span>test_data
more_data</code></pre></div>
<pre><code>## [1] 5 5 5 5</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">center</span>(more_data)</code></pre></div>
<pre><code>## [1] 0 0 0 0</code></pre>
<p>This is handy: if we usually want a function to work one way, but occasionally need it to do something else, we can allow people to pass an argument when they need to but provide a default to make the normal case easier.</p>
<p>The example below shows how R matches values to arguments</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">display &lt;-<span class="st"> </span>function(<span class="dt">a =</span> <span class="dv">1</span>, <span class="dt">b =</span> <span class="dv">2</span>, <span class="dt">c =</span> <span class="dv">3</span>) {
  result &lt;-<span class="st"> </span><span class="kw">c</span>(a, b, c)
  <span class="kw">names</span>(result) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;c&quot;</span>)  <span class="co"># This names each element of the vector</span>
  <span class="kw">return</span>(result)
}

<span class="co"># no arguments</span>
<span class="kw">display</span>()</code></pre></div>
<pre><code>## a b c 
## 1 2 3</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># one argument</span>
<span class="kw">display</span>(<span class="dv">55</span>)</code></pre></div>
<pre><code>##  a  b  c 
## 55  2  3</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># two arguments</span>
<span class="kw">display</span>(<span class="dv">55</span>, <span class="dv">66</span>)</code></pre></div>
<pre><code>##  a  b  c 
## 55 66  3</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># three arguments</span>
<span class="kw">display</span> (<span class="dv">55</span>, <span class="dv">66</span>, <span class="dv">77</span>)</code></pre></div>
<pre><code>##  a  b  c 
## 55 66 77</code></pre>
<p>As this example shows, arguments are matched from left to right, and any that haven’t been given a value explicitly get their default value. We can override this behavior by naming the value as we pass it in:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># only setting the value of c</span>
<span class="kw">display</span>(<span class="dt">c =</span> <span class="dv">77</span>)</code></pre></div>
<pre><code>##  a  b  c 
##  1  2 77</code></pre>
<blockquote>
<p><strong>Matching Arguments</strong></p>
<p>To be precise, R has three ways that arguments are supplied by you are matched to the <em>formal arguments</em> of the function definition:</p>
<ol style="list-style-type: decimal">
<li>by complete name,</li>
<li>by partial name (matching on initial <em>n</em> characters of the argument name), and</li>
<li>by position.</li>
</ol>
<p>Arguments are matched in the manner outlined above in <em>that order</em>: by complete name, then by partial matching of names, and finally by position. {: .callout}</p>
</blockquote>
<p>With that in hand, let’s look at the help for <code>read.csv()</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">?read.csv</code></pre></div>
<p>There’s a lot of information there, but the most important part is the first couple of lines:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">read.csv</span>(file, <span class="dt">header =</span> <span class="ot">TRUE</span>, <span class="dt">sep =</span> <span class="st">&quot;,&quot;</span>, <span class="dt">quote =</span> <span class="st">&quot;</span><span class="ch">\&quot;</span><span class="st">&quot;</span>,
         <span class="dt">dec =</span> <span class="st">&quot;.&quot;</span>, <span class="dt">fill =</span> <span class="ot">TRUE</span>, <span class="dt">comment.char =</span> <span class="st">&quot;&quot;</span>, ...)</code></pre></div>
<p>This tells us that <code>read.csv()</code> has one argument, <code>file</code>, that doesn’t have a default value, and six others that do. Now we understand why the following gives an error:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dat &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="ot">FALSE</span>, <span class="st">&quot;data/inflammation-01.csv&quot;</span>)</code></pre></div>
<pre><code>## Error in read.table(file = file, header = header, sep = sep, quote = quote, : &#39;file&#39; must be a character string or connection</code></pre>
<p>It fails because <code>FALSE</code> is assigned to <code>file</code> and the filename is assigned to the argument <code>header</code>.</p>
<blockquote>
<p><strong>A Function with Default Argument Values</strong></p>
<p>Rewrite the <code>rescale</code> function so that it scales a vector to lie between 0 and 1 by default, but will allow the caller to specify lower and upper bounds if they want. Compare your implementation to your neighbor’s: do the two functions always behave the same way?</p>
<!-- > > ## Solution -->
<!-- > > ~~~ -->
<!-- > > rescale <- function(v, lower = 0, upper = 1) { -->
<!-- > >   # Rescales a vector, v, to lie in the range lower to upper. -->
<!-- > >   L <- min(v) -->
<!-- > >   H <- max(v) -->
<!-- > >   result <- (v - L) / (H - L) * (upper - lower) + lower -->
<!-- > >   return(result) -->
<!-- > > } -->
<!-- > > ~~~ -->
</blockquote>
</div>
</div>
<div id="loops-in-r" class="section level2">
<h2><span class="header-section-number">3.4</span> Loops in R</h2>
<p>We have created a function called <code>analyze</code> that creates graphs of the minimum, average, and maximum daily inflammation rates for a single data set:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">analyze &lt;-<span class="st"> </span>function(filename) {
  <span class="co"># Plots the average, min, and max inflammation over time.</span>
  <span class="co"># Input is character string of a csv file.</span>
  dat &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="dt">file =</span> filename, <span class="dt">header =</span> <span class="ot">FALSE</span>)
  avg_day_inflammation &lt;-<span class="st"> </span><span class="kw">apply</span>(dat, <span class="dv">2</span>, mean)
  <span class="kw">plot</span>(avg_day_inflammation)
  max_day_inflammation &lt;-<span class="st"> </span><span class="kw">apply</span>(dat, <span class="dv">2</span>, max)
  <span class="kw">plot</span>(max_day_inflammation)
  min_day_inflammation &lt;-<span class="st"> </span><span class="kw">apply</span>(dat, <span class="dv">2</span>, min)
  <span class="kw">plot</span>(min_day_inflammation)
}

<span class="kw">analyze</span>(<span class="st">&quot;data/inflammation-01.csv&quot;</span>)</code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-53-1.png" width="672" /><img src="_main_files/figure-html/unnamed-chunk-53-2.png" width="672" /><img src="_main_files/figure-html/unnamed-chunk-53-3.png" width="672" /></p>
<p>We can use it to analyze other data sets one by one:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">analyze</span>(<span class="st">&quot;data/inflammation-02.csv&quot;</span>)</code></pre></div>
<p><img src="_main_files/figure-html/inflammation-02-1.png" width="672" /><img src="_main_files/figure-html/inflammation-02-2.png" width="672" /><img src="_main_files/figure-html/inflammation-02-3.png" width="672" /></p>
<p>but we have a dozen data sets right now and more on the way. We want to create plots for all our data sets with a single statement. To do that, we’ll have to teach the computer how to repeat things.</p>
<div id="for-loops" class="section level3">
<h3><span class="header-section-number">3.4.1</span> For Loops</h3>
<p>Suppose we want to print each word in a sentence. One way is to use six <code>print</code> statements:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">best_practice &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Let&quot;</span>, <span class="st">&quot;the&quot;</span>, <span class="st">&quot;computer&quot;</span>, <span class="st">&quot;do&quot;</span>, <span class="st">&quot;the&quot;</span>, <span class="st">&quot;work&quot;</span>)
print_words &lt;-<span class="st"> </span>function(sentence) {
  <span class="kw">print</span>(sentence[<span class="dv">1</span>])
  <span class="kw">print</span>(sentence[<span class="dv">2</span>])
  <span class="kw">print</span>(sentence[<span class="dv">3</span>])
  <span class="kw">print</span>(sentence[<span class="dv">4</span>])
  <span class="kw">print</span>(sentence[<span class="dv">5</span>])
  <span class="kw">print</span>(sentence[<span class="dv">6</span>])
}

<span class="kw">print_words</span>(best_practice)</code></pre></div>
<pre><code>## [1] &quot;Let&quot;
## [1] &quot;the&quot;
## [1] &quot;computer&quot;
## [1] &quot;do&quot;
## [1] &quot;the&quot;
## [1] &quot;work&quot;</code></pre>
<p>but that’s a bad approach for two reasons:</p>
<ol style="list-style-type: decimal">
<li><p>It doesn’t scale: if we want to print the elements in a vector that’s hundreds long, we’d be better off just typing them in.</p></li>
<li><p>It’s fragile: if we give it a longer vector, it only prints part of the data, and if we give it a shorter input, it returns <code>NA</code> values because we’re asking for elements that don’t exist!</p></li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">best_practice[-<span class="dv">6</span>]</code></pre></div>
<pre><code>## [1] &quot;Let&quot;      &quot;the&quot;      &quot;computer&quot; &quot;do&quot;       &quot;the&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print_words</span>(best_practice[-<span class="dv">6</span>])</code></pre></div>
<pre><code>## [1] &quot;Let&quot;
## [1] &quot;the&quot;
## [1] &quot;computer&quot;
## [1] &quot;do&quot;
## [1] &quot;the&quot;
## [1] NA</code></pre>
<blockquote>
<p><strong>Not Available</strong></p>
<p>R has has a special variable, <code>NA</code>, for designating missing values that are <strong>N</strong>ot <strong>A</strong>vailable in a data set. See <code>?NA</code> and <a href="http://cran.r-project.org/doc/manuals/r-release/R-intro.html#Missing-values">An Introduction to R</a> for more details. {: .callout}</p>
</blockquote>
<p>Here’s a better approach:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">print_words &lt;-<span class="st"> </span>function(sentence) {
  for (word in sentence) {
    <span class="kw">print</span>(word)
  }
}

<span class="kw">print_words</span>(best_practice)</code></pre></div>
<pre><code>## [1] &quot;Let&quot;
## [1] &quot;the&quot;
## [1] &quot;computer&quot;
## [1] &quot;do&quot;
## [1] &quot;the&quot;
## [1] &quot;work&quot;</code></pre>
<p>This is shorter—certainly shorter than something that prints every character in a hundred-letter string—and more robust as well:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print_words</span>(best_practice[-<span class="dv">6</span>])</code></pre></div>
<pre><code>## [1] &quot;Let&quot;
## [1] &quot;the&quot;
## [1] &quot;computer&quot;
## [1] &quot;do&quot;
## [1] &quot;the&quot;</code></pre>
<p>The improved version of <code>print_words</code> uses a <a href="%7B%7B%20page.root%20%7D%7D/reference/#for-loop">for loop</a> to repeat an operation—in this case, printing—once for each thing in a collection. The general form of a loop is:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">for (variable in collection) {
  do things with variable
}</code></pre></div>
<p>We can name the <a href="%7B%7B%20page.root%20%7D%7D/reference/#loop-variable">loop variable</a> anything we like (with a few <a href="http://cran.r-project.org/doc/manuals/R-intro.html#R-commands_003b-case-sensitivity-etc">restrictions</a>, e.g. the name of the variable cannot start with a digit). <code>in</code> is part of the <code>for</code> syntax. Note that the body of the loop is enclosed in curly braces <code>{ }</code>. For a single-line loop body, as here, the braces aren’t needed, but it is good practice to include them as we did.</p>
<p>Here’s another loop that repeatedly updates a variable:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">len &lt;-<span class="st"> </span><span class="dv">0</span>
vowels &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;e&quot;</span>, <span class="st">&quot;i&quot;</span>, <span class="st">&quot;o&quot;</span>, <span class="st">&quot;u&quot;</span>)
for (v in vowels) {
  len &lt;-<span class="st"> </span>len +<span class="st"> </span><span class="dv">1</span>
}
<span class="co"># Number of vowels</span>
len</code></pre></div>
<pre><code>## [1] 5</code></pre>
<p>It’s worth tracing the execution of this little program step by step. Since there are five elements in the vector <code>vowels</code>, the statement inside the loop will be executed five times. The first time around, <code>len</code> is zero (the value assigned to it on line 1) and <code>v</code> is <code>&quot;a&quot;</code>. The statement adds 1 to the old value of <code>len</code>, producing 1, and updates <code>len</code> to refer to that new value. The next time around, <code>v</code> is <code>&quot;e&quot;</code> and <code>len</code> is 1, so <code>len</code> is updated to be 2. After three more updates, <code>len</code> is 5; since there is nothing left in the vector <code>vowels</code> for R to process, the loop finishes.</p>
<p>Note that a loop variable is just a variable that’s being used to record progress in a loop. It still exists after the loop is over, and we can re-use variables previously defined as loop variables as well:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">letter &lt;-<span class="st"> &quot;z&quot;</span>
for (letter in <span class="kw">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;c&quot;</span>)) {
  <span class="kw">print</span>(letter)
}</code></pre></div>
<pre><code>## [1] &quot;a&quot;
## [1] &quot;b&quot;
## [1] &quot;c&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># after the loop, letter is</span>
letter</code></pre></div>
<pre><code>## [1] &quot;c&quot;</code></pre>
<p>Note also that finding the length of a vector is such a common operation that R actually has a built-in function to do it called <code>length</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">length</span>(vowels)</code></pre></div>
<pre><code>## [1] 5</code></pre>
<p><code>length</code> is much faster than any R function we could write ourselves, and much easier to read than a two-line loop; it will also give us the length of many other things that we haven’t met yet, so we should always use it when we can (see this <a href="%7B%7B%20page.root%20%7D%7D/13-supp-data-structures/">lesson</a> to learn more about the different ways to store data in R).</p>
<blockquote>
<p><strong>Printing Numbers</strong></p>
<p>R has a built-in function called <code>seq</code> that creates a list of numbers:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">seq</span>(<span class="dv">3</span>)</code></pre></div>
<pre><code>## [1] 1 2 3</code></pre>
<p>Using <code>seq</code>, write a function that prints the first <strong>N</strong> natural numbers, one per line:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print_N</span>(<span class="dv">3</span>)</code></pre></div>
<pre><code>## [1] 1
## [1] 2
## [1] 3</code></pre>
<!-- > > ## Solution -->
<!-- > > ~~~ -->
<!-- > > print_N <- function(N) { -->
<!-- > >   nseq <- seq(N) -->
<!-- > >   for (num in nseq) { -->
<!-- > >     print(num) -->
<!-- > >   } -->
<!-- > > } -->
<!-- > > ~~~ -->
</blockquote>
<blockquote>
<p><strong>Summing Values</strong></p>
<p>Write a function called <code>total</code> that calculates the sum of the values in a vector. (R has a built-in function called <code>sum</code> that does this for you. Please don’t use it for this exercise.)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ex_vec &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">8</span>, <span class="dv">15</span>, <span class="dv">16</span>, <span class="dv">23</span>, <span class="dv">42</span>)
<span class="kw">total</span>(ex_vec)</code></pre></div>
<pre><code>## [1] 108</code></pre>
<!-- > > ## Solution -->
<!-- > > ~~~ -->
<!-- > > total <- function(vec) { -->
<!-- > >   #calculates the sum of the values in a vector -->
<!-- > >   vec_sum <- 0 -->
<!-- > >   for (num in vec) { -->
<!-- > >     vec_sum <- vec_sum + num -->
<!-- > >   } -->
<!-- > >   return(vec_sum) -->
<!-- > > } -->
<!-- > > ~~~ -->
</blockquote>
<blockquote>
<p><strong>Exponentiation</strong></p>
<p>Exponentiation is built into R:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="dv">2</span>^<span class="dv">4</span></code></pre></div>
<pre><code>## [1] 16</code></pre>
<p>Write a function called <code>expo</code> that uses a loop to calculate the same result.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">expo</span>(<span class="dv">2</span>, <span class="dv">4</span>)</code></pre></div>
<pre><code>## [1] 16</code></pre>
<!-- > > ## Solution -->
<!-- > > ~~~ -->
<!-- > > expo <- function(base, power) { -->
<!-- > >   result <- 1 -->
<!-- > >   for (i in seq(power)) { -->
<!-- > >     result <- result * base -->
<!-- > >   } -->
<!-- > >   return(result) -->
<!-- > > } -->
<!-- > > ~~~ -->
</blockquote>
</div>
<div id="processing-multiple-files" class="section level3">
<h3><span class="header-section-number">3.4.2</span> Processing Multiple Files</h3>
<p>We now have almost everything we need to process all our data files. The only thing that’s missing is a function that finds files whose names match a pattern. We do not need to write it ourselves because R already has a function to do this called <code>list.files</code>.</p>
<p>If we run the function without any arguments, <code>list.files()</code>, it returns every file in the current working directory. We can understand this result by reading the help file (<code>?list.files</code>). The first argument, <code>path</code>, is the path to the directory to be searched, and it has the default value of <code>&quot;.&quot;</code> (recall from the <a href="%7B%7B%20site.swc_pages%20%7D%7D/shell-novice/01-filedir/">lesson</a> on the Unix Shell that <code>&quot;.&quot;</code> is shorthand for the current working directory). The second argument, <code>pattern</code>, is the pattern being searched, and it has the default value of <code>NULL</code>. Since no pattern is specified to filter the files, all files are returned.</p>
<p>So to list all the csv files, we could run either of the following:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">list.files</span>(<span class="dt">path =</span> <span class="st">&quot;data&quot;</span>, <span class="dt">pattern =</span> <span class="st">&quot;csv&quot;</span>)</code></pre></div>
<pre><code>##  [1] &quot;car-speeds-cleaned.csv&quot; &quot;car-speeds.csv&quot;        
##  [3] &quot;heights.csv&quot;            &quot;inflammation-01.csv&quot;   
##  [5] &quot;inflammation-02.csv&quot;    &quot;inflammation-03.csv&quot;   
##  [7] &quot;inflammation-04.csv&quot;    &quot;inflammation-05.csv&quot;   
##  [9] &quot;inflammation-06.csv&quot;    &quot;inflammation-07.csv&quot;   
## [11] &quot;inflammation-08.csv&quot;    &quot;inflammation-09.csv&quot;   
## [13] &quot;inflammation-10.csv&quot;    &quot;inflammation-11.csv&quot;   
## [15] &quot;inflammation-12.csv&quot;    &quot;sample.csv&quot;            
## [17] &quot;small-01.csv&quot;           &quot;small-02.csv&quot;          
## [19] &quot;small-03.csv&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">list.files</span>(<span class="dt">path =</span> <span class="st">&quot;data&quot;</span>, <span class="dt">pattern =</span> <span class="st">&quot;inflammation&quot;</span>)</code></pre></div>
<pre><code>##  [1] &quot;inflammation-01.csv&quot; &quot;inflammation-02.csv&quot; &quot;inflammation-03.csv&quot;
##  [4] &quot;inflammation-04.csv&quot; &quot;inflammation-05.csv&quot; &quot;inflammation-06.csv&quot;
##  [7] &quot;inflammation-07.csv&quot; &quot;inflammation-08.csv&quot; &quot;inflammation-09.csv&quot;
## [10] &quot;inflammation-10.csv&quot; &quot;inflammation-11.csv&quot; &quot;inflammation-12.csv&quot;</code></pre>
<blockquote>
<p><strong>Organizing Larger Projects</strong></p>
<p>For larger projects, it is recommended to organize separate parts of the analysis into multiple subdirectories, e.g. one subdirectory for the raw data, one for the code, and one for the results like figures. We have done that here to some extent, putting all of our data files into the subdirectory “data”. For more advice on this topic, you can read <a href="http://www.ploscompbiol.org/article/info%3Adoi%2F10.1371%2Fjournal.pcbi.1000424">A quick guide to organizing computational biology projects</a> by William Stafford Noble.</p>
</blockquote>
<p>As these examples show, <code>list.files</code> result is a vector of strings, which means we can loop over it to do something with each filename in turn. In our case, the “something” we want is our <code>analyze</code> function.</p>
<p>Because we have put our data in separate subdirectory, if we want to access these files using the output of <code>list.files</code> we also need to include the “path” portion of the file name. We can do that by using the argument <code>full.names = TRUE</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">list.files</span>(<span class="dt">path =</span> <span class="st">&quot;data&quot;</span>, <span class="dt">pattern =</span> <span class="st">&quot;csv&quot;</span>, <span class="dt">full.names =</span> <span class="ot">TRUE</span>)</code></pre></div>
<pre><code>##  [1] &quot;data/car-speeds-cleaned.csv&quot; &quot;data/car-speeds.csv&quot;        
##  [3] &quot;data/heights.csv&quot;            &quot;data/inflammation-01.csv&quot;   
##  [5] &quot;data/inflammation-02.csv&quot;    &quot;data/inflammation-03.csv&quot;   
##  [7] &quot;data/inflammation-04.csv&quot;    &quot;data/inflammation-05.csv&quot;   
##  [9] &quot;data/inflammation-06.csv&quot;    &quot;data/inflammation-07.csv&quot;   
## [11] &quot;data/inflammation-08.csv&quot;    &quot;data/inflammation-09.csv&quot;   
## [13] &quot;data/inflammation-10.csv&quot;    &quot;data/inflammation-11.csv&quot;   
## [15] &quot;data/inflammation-12.csv&quot;    &quot;data/sample.csv&quot;            
## [17] &quot;data/small-01.csv&quot;           &quot;data/small-02.csv&quot;          
## [19] &quot;data/small-03.csv&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">list.files</span>(<span class="dt">path =</span> <span class="st">&quot;data&quot;</span>, <span class="dt">pattern =</span> <span class="st">&quot;inflammation&quot;</span>, <span class="dt">full.names =</span> <span class="ot">TRUE</span>)</code></pre></div>
<pre><code>##  [1] &quot;data/inflammation-01.csv&quot; &quot;data/inflammation-02.csv&quot;
##  [3] &quot;data/inflammation-03.csv&quot; &quot;data/inflammation-04.csv&quot;
##  [5] &quot;data/inflammation-05.csv&quot; &quot;data/inflammation-06.csv&quot;
##  [7] &quot;data/inflammation-07.csv&quot; &quot;data/inflammation-08.csv&quot;
##  [9] &quot;data/inflammation-09.csv&quot; &quot;data/inflammation-10.csv&quot;
## [11] &quot;data/inflammation-11.csv&quot; &quot;data/inflammation-12.csv&quot;</code></pre>
<p>Let’s test out running our <code>analyze</code> function by using it on the first three files in the vector returned by <code>list.files</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">filenames &lt;-<span class="st"> </span><span class="kw">list.files</span>(<span class="dt">path =</span> <span class="st">&quot;data&quot;</span>, <span class="dt">pattern =</span> <span class="st">&quot;inflammation.*csv&quot;</span>, <span class="dt">full.names =</span> <span class="ot">TRUE</span>)
filenames &lt;-<span class="st"> </span>filenames[<span class="dv">1</span>:<span class="dv">3</span>]
for (f in filenames) {
  <span class="kw">print</span>(f)
  <span class="kw">analyze</span>(f)
}</code></pre></div>
<pre><code>## [1] &quot;data/inflammation-01.csv&quot;</code></pre>
<p><img src="_main_files/figure-html/loop-analyze-1.png" width="672" /><img src="_main_files/figure-html/loop-analyze-2.png" width="672" /><img src="_main_files/figure-html/loop-analyze-3.png" width="672" /></p>
<pre><code>## [1] &quot;data/inflammation-02.csv&quot;</code></pre>
<p><img src="_main_files/figure-html/loop-analyze-4.png" width="672" /><img src="_main_files/figure-html/loop-analyze-5.png" width="672" /><img src="_main_files/figure-html/loop-analyze-6.png" width="672" /></p>
<pre><code>## [1] &quot;data/inflammation-03.csv&quot;</code></pre>
<p><img src="_main_files/figure-html/loop-analyze-7.png" width="672" /><img src="_main_files/figure-html/loop-analyze-8.png" width="672" /><img src="_main_files/figure-html/loop-analyze-9.png" width="672" /></p>
<p>Sure enough, the maxima of these data sets show exactly the same ramp as the first, and their minima show the same staircase structure.</p>
<blockquote>
<p><strong>Other Ways to Do It</strong></p>
<p>In this lesson we saw how to use a simple <code>for</code> loop to repeat an operation. As you progress with R, you will learn that there are multiple ways to accomplish this. Sometimes the choice of one method over another is more a matter of personal style, but other times it can have consequences for the speed of your code. For instruction on best practices, see <a href="programming-with-r.html#best-practice-for-repetition">Best Practice for Repetition</a> below that demonstrates how to properly repeat operations in R.</p>
</blockquote>
<blockquote>
<p><strong>Using Loops to Analyze Multiple Files</strong></p>
<p>Write a function called <code>analyze_all</code> that takes a filename pattern as its sole argument and runs <code>analyze</code> for each file whose name matches the pattern.</p>
<!-- > > ## Solution -->
<!-- > > ~~~ -->
<!-- > > analyze_all <- function(pattern) { -->
<!-- > >   # Runs the function analyze for each file in the current working directory -->
<!-- > >   # that contains the given pattern. -->
<!-- > >   filenames <- list.files(path = "data", pattern = pattern, full.names = TRUE) -->
<!-- > >   for (f in filenames) { -->
<!-- > >     analyze(f) -->
<!-- > >   } -->
<!-- > > } -->
<!-- > > ~~~ -->
</blockquote>
</div>
</div>
<div id="best-practice-for-repetition" class="section level2">
<h2><span class="header-section-number">3.5</span> Best Practice for Repetition</h2>
<p>In R you have multiple options when repeating calculations: vectorized operations, <code>for</code> loops, and <code>apply</code> functions.</p>
<div id="vectorized-operations" class="section level3">
<h3><span class="header-section-number">3.5.1</span> Vectorized Operations</h3>
<p>A key difference between R and many other languages is a topic known as vectorization. When you wrote the <code>total</code> function, we mentioned that R already has <code>sum</code> to do this; <code>sum</code> is <em>much</em> faster than the interpreted <code>for</code> loop because <code>sum</code> is coded in C to work with a vector of numbers. Many of R’s functions work this way; the loop is hidden from you in C. Learning to use vectorized operations is a key skill in R.</p>
<p>For example, to add pairs of numbers contained in two vectors</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">a &lt;-<span class="st"> </span><span class="dv">1</span>:<span class="dv">10</span>
b &lt;-<span class="st"> </span><span class="dv">1</span>:<span class="dv">10</span></code></pre></div>
<p>You could loop over the pairs adding each in turn, but that would be very inefficient in R.</p>
<p>Instead of using <code>i in a</code> to make our loop variable, we use the function <code>seq_along</code> to generate indices for each element <code>a</code> contains.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">res &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="dt">length =</span> <span class="kw">length</span>(a))
for (i in <span class="kw">seq_along</span>(a)) {
  res[i] &lt;-<span class="st"> </span>a[i] +<span class="st"> </span>b[i]
}
res</code></pre></div>
<pre><code>##  [1]  2  4  6  8 10 12 14 16 18 20</code></pre>
<p>Instead, <code>+</code> is a <em>vectorized</em> function which can operate on entire vectors at once</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">res2 &lt;-<span class="st"> </span>a +<span class="st"> </span>b
<span class="kw">all.equal</span>(res, res2)</code></pre></div>
<pre><code>## [1] TRUE</code></pre>
</div>
<div id="vector-recycling" class="section level3">
<h3><span class="header-section-number">3.5.2</span> Vector Recycling</h3>
<p>When performing vector operations in R, it is important to know about recycling. If you perform an operation on two or more vectors of unequal length, R will recycle elements of the shorter vector(s) to match the longest vector. For example:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">a &lt;-<span class="st"> </span><span class="dv">1</span>:<span class="dv">10</span>
b &lt;-<span class="st"> </span><span class="dv">1</span>:<span class="dv">5</span>
a +<span class="st"> </span>b</code></pre></div>
<pre><code>##  [1]  2  4  6  8 10  7  9 11 13 15</code></pre>
<p>The elements of <code>a</code> and <code>b</code> are added together starting from the first element of both vectors. When R reaches the end of the shorter vector <code>b</code>, it starts again at the first element of <code>b</code> and continues until it reaches the last element of the longest vector <code>a</code>. This behaviour may seem crazy at first glance, but it is very useful when you want to perform the same operation on every element of a vector. For example, say we want to multiply every element of our vector <code>a</code> by 5:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">a &lt;-<span class="st"> </span><span class="dv">1</span>:<span class="dv">10</span>
b &lt;-<span class="st"> </span><span class="dv">5</span>
a *<span class="st"> </span>b</code></pre></div>
<pre><code>##  [1]  5 10 15 20 25 30 35 40 45 50</code></pre>
<p>Remember there are no scalars in R, so <code>b</code> is actually a vector of length 1; in order to add its value to every element of <code>a</code>, it is <em>recycled</em> to match the length of <code>a</code>.</p>
<p>When the length of the longer object is a multiple of the shorter object length (as in our example above), the recycling occurs silently. When the longer object length is not a multiple of the shorter object length, a warning is given:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">a &lt;-<span class="st"> </span><span class="dv">1</span>:<span class="dv">10</span>
b &lt;-<span class="st"> </span><span class="dv">1</span>:<span class="dv">7</span>
a +<span class="st"> </span>b</code></pre></div>
<pre><code>##  [1]  2  4  6  8 10 12 14  9 11 13</code></pre>
</div>
<div id="for-or-apply" class="section level3">
<h3><span class="header-section-number">3.5.3</span> <code>for</code> or <code>apply</code>?</h3>
<p>A <code>for</code> loop is used to apply the same function calls to a collection of objects. R has a family of functions, the <code>apply</code> family, which can be used in much the same way. You’ve already used one of the family, <code>apply</code> in the first <a href="%7B%7B%20page.root%20%7D%7D/01-starting-with-data/">lesson</a>. The <code>apply</code> family members include</p>
<ul>
<li><code>apply</code> - apply over the margins of an array (e.g. the rows or columns of a matrix)</li>
<li><code>lapply</code> - apply over an object and return list</li>
<li><code>sapply</code> - apply over an object and return a simplified object (an array) if possible</li>
<li><code>vapply</code> - similar to <code>sapply</code> but you specify the type of object returned by the iterations</li>
</ul>
<p>Each of these has an argument <code>FUN</code> which takes a function to apply to each element of the object. Instead of looping over <code>filenames</code> and calling <code>analyze</code>, as you did earlier, you could <code>sapply</code> over <code>filenames</code> with <code>FUN = analyze</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sapply</span>(filenames, <span class="dt">FUN =</span> analyze)</code></pre></div>
<p>Deciding whether to use <code>for</code> or one of the <code>apply</code> family is really personal preference. Using an <code>apply</code> family function forces to you encapsulate your operations as a function rather than separate calls with <code>for</code>. <code>for</code> loops are often more natural in some circumstances; for several related operations, a <code>for</code> loop will avoid you having to pass in a lot of extra arguments to your function.</p>
</div>
<div id="loops-in-r-are-slow" class="section level3">
<h3><span class="header-section-number">3.5.4</span> Loops in R Are Slow</h3>
<p>No, they are not! <em>If</em> you follow some golden rules:</p>
<ol style="list-style-type: decimal">
<li>Don’t use a loop when a vectorized alternative exists</li>
<li>Don’t grow objects (via <code>c</code>, <code>cbind</code>, etc) during the loop - R has to create a new object and copy across the information just to add a new element or row/column</li>
<li>Allocate an object to hold the results and fill it in during the loop</li>
</ol>
<p>As an example, we’ll create a new version of <code>analyze</code> that will return the mean inflammation per day (column) of each file.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">analyze2 &lt;-<span class="st"> </span>function(filenames) {
  for (f in <span class="kw">seq_along</span>(filenames)) {
    fdata &lt;-<span class="st"> </span><span class="kw">read.csv</span>(filenames[f], <span class="dt">header =</span> <span class="ot">FALSE</span>)
    res &lt;-<span class="st"> </span><span class="kw">apply</span>(fdata, <span class="dv">2</span>, mean)
    if (f ==<span class="st"> </span><span class="dv">1</span>) {
      out &lt;-<span class="st"> </span>res
    } else {
      <span class="co"># The loop is slowed by this call to cbind that grows the object</span>
      out &lt;-<span class="st"> </span><span class="kw">cbind</span>(out, res)
    }
  }
  <span class="kw">return</span>(out)
}

<span class="kw">system.time</span>(avg2 &lt;-<span class="st"> </span><span class="kw">analyze2</span>(filenames))</code></pre></div>
<pre><code>##    user  system elapsed 
##   0.013   0.000   0.013</code></pre>
<p>Note how we add a new column to <code>out</code> at each iteration? This is a cardinal sin of writing a <code>for</code> loop in R.</p>
<p>Instead, we can create an empty matrix with the right dimensions (rows/columns) to hold the results. Then we loop over the files but this time we fill in the <code>f</code>th column of our results matrix <code>out</code>. This time there is no copying/growing for R to deal with.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">analyze3 &lt;-<span class="st"> </span>function(filenames) {
  out &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dt">ncol =</span> <span class="kw">length</span>(filenames), <span class="dt">nrow =</span> <span class="dv">40</span>) ## assuming 40 here from files
  for (f in <span class="kw">seq_along</span>(filenames)) {
    fdata &lt;-<span class="st"> </span><span class="kw">read.csv</span>(filenames[f], <span class="dt">header =</span> <span class="ot">FALSE</span>)
    out[, f] &lt;-<span class="st"> </span><span class="kw">apply</span>(fdata, <span class="dv">2</span>, mean)
  }
  <span class="kw">return</span>(out)
}

<span class="kw">system.time</span>(avg3 &lt;-<span class="st"> </span><span class="kw">analyze3</span>(filenames))</code></pre></div>
<pre><code>##    user  system elapsed 
##   0.013   0.000   0.012</code></pre>
<p>In this simple example there is little difference in the compute time of <code>analyze2</code> and <code>analyze3</code>. This is because we are only iterating over 12 files and hence we only incur 12 copy/grow operations. If we were doing this over more files or the data objects we were growing were larger, the penalty for copying/growing would be much larger.</p>
<p>Note that <code>apply</code> handles these memory allocation issues for you, but then you have to write the loop part as a function to pass to <code>apply</code>. At its heart, <code>apply</code> is just a <code>for</code> loop with extra convenience.</p>
</div>
</div>
<div id="make-choices" class="section level2">
<h2><span class="header-section-number">3.6</span> Make Choices</h2>
<p>Our previous lessons have shown us how to manipulate data, define our own functions, and repeat things. However, the programs we have written so far always do the same things, regardless of what data they’re given. We want programs to make choices based on the values they are manipulating.</p>
<div id="saving-plots-to-a-file" class="section level3">
<h3><span class="header-section-number">3.6.1</span> Saving Plots to a File</h3>
<p>So far, we have built a function <code>analyze</code> to plot summary statistics of the inflammation data:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">analyze &lt;-<span class="st"> </span>function(filename) {
  <span class="co"># Plots the average, min, and max inflammation over time.</span>
  <span class="co"># Input is character string of a csv file.</span>
  dat &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="dt">file =</span> filename, <span class="dt">header =</span> <span class="ot">FALSE</span>)
  avg_day_inflammation &lt;-<span class="st"> </span><span class="kw">apply</span>(dat, <span class="dv">2</span>, mean)
  <span class="kw">plot</span>(avg_day_inflammation)
  max_day_inflammation &lt;-<span class="st"> </span><span class="kw">apply</span>(dat, <span class="dv">2</span>, max)
  <span class="kw">plot</span>(max_day_inflammation)
  min_day_inflammation &lt;-<span class="st"> </span><span class="kw">apply</span>(dat, <span class="dv">2</span>, min)
  <span class="kw">plot</span>(min_day_inflammation)
}</code></pre></div>
<p>And also built the function <code>analyze_all</code> to automate the processing of each data file:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">analyze_all &lt;-<span class="st"> </span>function(pattern) {
  <span class="co"># Runs the function analyze for each file in the current working directory</span>
  <span class="co"># that contains the given pattern.</span>
  filenames &lt;-<span class="st"> </span><span class="kw">list.files</span>(<span class="dt">path =</span> <span class="st">&quot;data&quot;</span>, <span class="dt">pattern =</span> pattern, <span class="dt">full.names =</span> <span class="ot">TRUE</span>)
  for (f in filenames) {
    <span class="kw">analyze</span>(f)
  }
}</code></pre></div>
<p>While these are useful in an interactive R session, what if we want to send our results to our collaborators? Since we currently have 12 data sets, running <code>analyze_all</code> creates 36 plots. Saving each of these individually would be tedious and error-prone. And in the likely situation that we want to change how the data is processed or the look of the plots, we would have to once again save all 36 before sharing the updated results with our collaborators.</p>
<p>Here’s how we can save all three plots of the first inflammation data set in a pdf file:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">pdf</span>(<span class="st">&quot;results/inflammation-01.pdf&quot;</span>)
<span class="kw">analyze</span>(<span class="st">&quot;data/inflammation-01.csv&quot;</span>)
<span class="kw">dev.off</span>()</code></pre></div>
<p>The function <code>pdf</code> redirects all the plots generated by R into a pdf file, which in this case we have named “inflammation-01.pdf”. After we are done generating the plots to be saved in the pdf file, we stop R from redirecting plots with the function <code>dev.off</code>.</p>
<blockquote>
<p><strong>Overwriting Plots</strong></p>
<p>If you run <code>pdf</code> multiple times without running <code>dev.off</code>, you will save plots to the most recently opened file. However, you won’t be able to open the previous pdf files because the connections were not closed. In order to get out of this situation, you’ll need to run <code>dev.off</code> until all the pdf connections are closed. You can check your current status using the function <code>dev.cur</code>. If it says “pdf”, all your plots are being saved in the last pdf specified. If it says “null device” or “RStudioGD”, the plots will be visualized normally.</p>
</blockquote>
<p>We can update the <code>analyze</code> function so that it always saves the plots in a pdf. But that would make it more difficult to interactively test out new changes. It would be ideal if <code>analyze</code> would either save or not save the plots based on its input.</p>
</div>
<div id="conditionals" class="section level3">
<h3><span class="header-section-number">3.6.2</span> Conditionals</h3>
<p>In order to update our function to decide between saving or not, we need to write code that automatically decides between multiple options. The tool R gives us for doing this is called a <a href="%7B%7B%20page.root%20%7D%7D/reference/#conditional-statement">conditional statement</a>, and looks like this:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">num &lt;-<span class="st"> </span><span class="dv">37</span>
if (num &gt;<span class="st"> </span><span class="dv">100</span>) {
  <span class="kw">print</span>(<span class="st">&quot;greater&quot;</span>)
} else {
  <span class="kw">print</span>(<span class="st">&quot;not greater&quot;</span>)
}
<span class="kw">print</span>(<span class="st">&quot;done&quot;</span>)</code></pre></div>
<pre><code>## [1] &quot;not greater&quot;
## [1] &quot;done&quot;</code></pre>
<p>The second line of this code uses an <code>if</code> statement to tell R that we want to make a choice. If the following test is true, the body of the <code>if</code> (i.e., the lines in the curly braces underneath it) are executed. If the test is false, the body of the <code>else</code> is executed instead. Only one or the other is ever executed:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">knitr::<span class="kw">include_graphics</span>(<span class="st">&quot;fig/python-flowchart-conditional.svg&quot;</span>)</code></pre></div>
<div class="figure"><span id="fig:conditional"></span>
<img src="fig/python-flowchart-conditional.svg" alt="Flowchart Executing a Conditional."  />
<p class="caption">
Figure 3.1: Flowchart Executing a Conditional.
</p>
</div>
<p>In the example above, the test <code>num &gt; 100</code> returns the value <code>FALSE</code>, which is why the code inside the <code>if</code> block was skipped and the code inside the <code>else</code> statement was run instead.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">num &gt;<span class="st"> </span><span class="dv">100</span></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<p>And as you likely guessed, the opposite of <code>FALSE</code> is <code>TRUE</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">num &lt;<span class="st"> </span><span class="dv">100</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<p>Conditional statements don’t have to include an <code>else</code>. If there isn’t one, R simply does nothing if the test is false:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">num &lt;-<span class="st"> </span><span class="dv">53</span>
if (num &gt;<span class="st"> </span><span class="dv">100</span>) {
  <span class="kw">print</span>(<span class="st">&quot;num is greater than 100&quot;</span>)
}</code></pre></div>
<p>We can also chain several tests together when there are more than two options. This makes it simple to write a function that returns the sign of a number:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sign &lt;-<span class="st"> </span>function(num) {
  if (num &gt;<span class="st"> </span><span class="dv">0</span>) {
    <span class="kw">return</span>(<span class="dv">1</span>)
  } else if (num ==<span class="st"> </span><span class="dv">0</span>) {
    <span class="kw">return</span>(<span class="dv">0</span>)
  } else {
    <span class="kw">return</span>(-<span class="dv">1</span>)
  }
}

<span class="kw">sign</span>(-<span class="dv">3</span>)</code></pre></div>
<pre><code>## [1] -1</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sign</span>(<span class="dv">0</span>)</code></pre></div>
<pre><code>## [1] 0</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sign</span>(<span class="dv">2</span>/<span class="dv">3</span>)</code></pre></div>
<pre><code>## [1] 1</code></pre>
<p>Note that when combining <code>else</code> and <code>if</code> in an <code>else if</code> statement (similar to <code>elif</code> in Python), the <code>if</code> portion still requires a direct input condition. This is never the case for the <code>else</code> statement alone, which is only executed if all other conditions go unsatisfied. Note that the test for equality uses two equal signs, <code>==</code>.</p>
<blockquote>
<p><strong>Other Comparisons</strong></p>
<p>Other tests include greater than or equal to (<code>&gt;=</code>), less than or equal to (<code>&lt;=</code>), and not equal to (<code>!=</code>). {: .callout}</p>
</blockquote>
<p>We can also combine tests. An ampersand, <code>&amp;</code>, symbolizes “and”. A vertical bar, <code>|</code>, symbolizes “or”. <code>&amp;</code> is only true if both parts are true:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">if (<span class="dv">1</span> &gt;<span class="st"> </span><span class="dv">0</span> &amp;<span class="st"> </span>-<span class="dv">1</span> &gt;<span class="st"> </span><span class="dv">0</span>) {
    <span class="kw">print</span>(<span class="st">&quot;both parts are true&quot;</span>)
} else {
  <span class="kw">print</span>(<span class="st">&quot;at least one part is not true&quot;</span>)
}</code></pre></div>
<pre><code>## [1] &quot;at least one part is not true&quot;</code></pre>
<p>while <code>|</code> is true if either part is true:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">if (<span class="dv">1</span> &gt;<span class="st"> </span><span class="dv">0</span> |<span class="st"> </span>-<span class="dv">1</span> &gt;<span class="st"> </span><span class="dv">0</span>) {
    <span class="kw">print</span>(<span class="st">&quot;at least one part is true&quot;</span>)
} else {
  <span class="kw">print</span>(<span class="st">&quot;neither part is true&quot;</span>)
}</code></pre></div>
<pre><code>## [1] &quot;at least one part is true&quot;</code></pre>
<p>In this case, “either” means “either or both”, not “either one or the other but not both”.</p>
<blockquote>
<p><strong>Choosing Plots Based on Data</strong></p>
<p>Write a function <code>plot_dist</code> that plots a boxplot if the length of the vector is greater than a specified threshold and a stripchart otherwise. To do this you’ll use the R functions <code>boxplot</code> and <code>stripchart</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dat &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/inflammation-01.csv&quot;</span>, <span class="dt">header =</span> <span class="ot">FALSE</span>)
<span class="kw">plot_dist</span>(dat[, <span class="dv">10</span>], <span class="dt">threshold =</span> <span class="dv">10</span>)     <span class="co"># day (column) 10</span></code></pre></div>
<p><img src="_main_files/figure-html/using-conditions-01-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot_dist</span>(dat[<span class="dv">1</span>:<span class="dv">5</span>, <span class="dv">10</span>], <span class="dt">threshold =</span> <span class="dv">10</span>)  <span class="co"># samples (rows) 1-5 on day (column) 10</span></code></pre></div>
<p><img src="_main_files/figure-html/using-conditions-01-2.png" width="672" /></p>
<!-- > > ## Solution -->
<!-- > > ~~~ -->
<!-- > > plot_dist <- function(x, threshold) { -->
<!-- > >   if (length(x) > threshold) { -->
<!-- > >     boxplot(x) -->
<!-- > >   } else { -->
<!-- > >     stripchart(x) -->
<!-- > >   } -->
<!-- > > } -->
<!-- > > ~~~ -->
</blockquote>
<blockquote>
<p><strong>Histograms Instead</strong></p>
<p>One of your collaborators prefers to see the distributions of the larger vectors as a histogram instead of as a boxplot. In order to choose between a histogram and a boxplot we will edit the function <code>plot_dist</code> and add an additional argument <code>use_boxplot</code>. By default we will set <code>use_boxplot</code> to <code>TRUE</code> which will create a boxplot when the vector is longer than <code>threshold</code>. When <code>use_boxplot</code> is set to <code>FALSE</code>, <code>plot_dist</code> will instead plot a histogram for the larger vectors. As before, if the length of the vector is shorter than <code>threshold</code>, <code>plot_dist</code> will create a stripchart. A histogram is made with the <code>hist</code> command in R.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dat &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/inflammation-01.csv&quot;</span>, <span class="dt">header =</span> <span class="ot">FALSE</span>)
<span class="kw">plot_dist</span>(dat[, <span class="dv">10</span>], <span class="dt">threshold =</span> <span class="dv">10</span>, <span class="dt">use_boxplot =</span> <span class="ot">TRUE</span>)   <span class="co"># day (column) 10 - create boxplot</span></code></pre></div>
<p><img src="_main_files/figure-html/conditional-challenge-hist-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot_dist</span>(dat[, <span class="dv">10</span>], <span class="dt">threshold =</span> <span class="dv">10</span>, <span class="dt">use_boxplot =</span> <span class="ot">FALSE</span>)  <span class="co"># day (column) 10 - create histogram</span></code></pre></div>
<p><img src="_main_files/figure-html/conditional-challenge-hist-2.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot_dist</span>(dat[<span class="dv">1</span>:<span class="dv">5</span>, <span class="dv">10</span>], <span class="dt">threshold =</span> <span class="dv">10</span>)                    <span class="co"># samples (rows) 1-5 on day (column) 10</span></code></pre></div>
<p><img src="_main_files/figure-html/conditional-challenge-hist-3.png" width="672" /></p>
<!-- > > ## Solution -->
<!-- > > ~~~ -->
<!-- > > plot_dist <- function(x, threshold, use_boxplot = TRUE) { -->
<!-- > >    if (length(x) > threshold & use_boxplot) { -->
<!-- > >        boxplot(x) -->
<!-- > >    } else if (length(x) > threshold & !use_boxplot) { -->
<!-- > >        hist(x) -->
<!-- > >    } else { -->
<!-- > >        stripchart(x) -->
<!-- > >    } -->
<!-- > > } -->
<!-- > > ~~~ -->
</blockquote>
<blockquote>
<p><strong>Find the Maximum Inflammation Score</strong></p>
<p>Find the file containing the patient with the highest average inflammation score. Print the file name, the patient number (row number) and the value of the maximum average inflammation score.</p>
<p>Tips:</p>
<ol style="list-style-type: decimal">
<li>Use variables to store the maximum average and update it as you go through files and patients.</li>
<li>You can use nested loops (one loop is inside the other) to go through the files as well as through the patients in each file (every row).</li>
</ol>
<p>Complete the code below:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">filenames &lt;-<span class="st"> </span><span class="kw">list.files</span>(<span class="dt">path =</span> <span class="st">&quot;data&quot;</span>, <span class="dt">pattern =</span> <span class="st">&quot;inflammation.*csv&quot;</span>, <span class="dt">full.names =</span> <span class="ot">TRUE</span>)
filename_max &lt;-<span class="st"> &quot;&quot;</span> <span class="co"># filename where the maximum average inflammation patient is found</span>
patient_max &lt;-<span class="st"> </span><span class="dv">0</span> <span class="co"># index (row number) for this patient in this file</span>
average_inf_max &lt;-<span class="st"> </span><span class="dv">0</span> <span class="co"># value of the average inflammation score for this patient</span>
for (f in filenames) {
  dat &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="dt">file =</span> f, <span class="dt">header =</span> <span class="ot">FALSE</span>)
  dat.means =<span class="st"> </span><span class="kw">apply</span>(dat, <span class="dv">1</span>, mean)
  for (patient_index in <span class="kw">length</span>(dat.means)){
    patient_average_inf =<span class="st"> </span>dat.means[patient_index]
    <span class="co"># Add your code here ...</span>
  }
}
<span class="kw">print</span>(filename_max)
<span class="kw">print</span>(patient_max)
<span class="kw">print</span>(average_inf_max)</code></pre></div>
<!-- > > ## Solution -->
<!-- > > ~~~ -->
<!-- > > # Add your code here ... -->
<!-- > > if (patient_average_inf > average_inf_max) { -->
<!-- > >   average_inf_max = patient_average_inf -->
<!-- > >   filename_max <- f -->
<!-- > >   patient_max <- patient_index -->
<!-- > > } -->
<!-- > > ~~~ -->
</blockquote>
</div>
<div id="saving-automatically-generated-figures" class="section level3">
<h3><span class="header-section-number">3.6.3</span> Saving Automatically Generated Figures</h3>
<p>Now that we know how to have R make decisions based on input values, let’s update <code>analyze</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">analyze &lt;-<span class="st"> </span>function(filename, <span class="dt">output =</span> <span class="ot">NULL</span>) {
  <span class="co"># Plots the average, min, and max inflammation over time.</span>
  <span class="co"># Input:</span>
  <span class="co">#    filename: character string of a csv file</span>
  <span class="co">#    output: character string of pdf file for saving</span>
  if (!<span class="kw">is.null</span>(output)) {
    <span class="kw">pdf</span>(output)
  }
  dat &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="dt">file =</span> filename, <span class="dt">header =</span> <span class="ot">FALSE</span>)
  avg_day_inflammation &lt;-<span class="st"> </span><span class="kw">apply</span>(dat, <span class="dv">2</span>, mean)
  <span class="kw">plot</span>(avg_day_inflammation)
  max_day_inflammation &lt;-<span class="st"> </span><span class="kw">apply</span>(dat, <span class="dv">2</span>, max)
  <span class="kw">plot</span>(max_day_inflammation)
  min_day_inflammation &lt;-<span class="st"> </span><span class="kw">apply</span>(dat, <span class="dv">2</span>, min)
  <span class="kw">plot</span>(min_day_inflammation)
  if (!<span class="kw">is.null</span>(output)) {
    <span class="kw">dev.off</span>()
  }
}</code></pre></div>
<p>We added an argument, <code>output</code>, that by default is set to <code>NULL</code>. An <code>if</code> statement at the beginning checks the argument <code>output</code> to decide whether or not to save the plots to a pdf. Let’s break it down. The function <code>is.null</code> returns <code>TRUE</code> if a variable is <code>NULL</code> and <code>FALSE</code> otherwise. The exclamation mark, <code>!</code>, stands for “not”. Therefore the line in the <code>if</code> block is only executed if <code>output</code> is “not null”.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">output &lt;-<span class="st"> </span><span class="ot">NULL</span>
<span class="kw">is.null</span>(output)</code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">!<span class="kw">is.null</span>(output)</code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<p>Now we can use <code>analyze</code> interactively, as before,</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">analyze</span>(<span class="st">&quot;data/inflammation-01.csv&quot;</span>)</code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-88-1.png" width="672" /><img src="_main_files/figure-html/unnamed-chunk-88-2.png" width="672" /><img src="_main_files/figure-html/unnamed-chunk-88-3.png" width="672" /></p>
<p>but also use it to save plots,</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">analyze</span>(<span class="st">&quot;data/inflammation-01.csv&quot;</span>, <span class="dt">output =</span> <span class="st">&quot;results/inflammation-01.pdf&quot;</span>)</code></pre></div>
<p>Before going further, we will create a directory <code>results</code> for saving our plots. It is <a href="http://swcarpentry.github.io/good-enough-practices-in-scientific-computing/">good practice</a> in data analysis projects to save all output to a directory separate from the data and analysis code. You can create this directory using the shell command <a href="%7B%7B%20site.swc_pages%20%7D%7D/shell-novice/02-create/">mkdir</a>, or the R function <code>dir.create()</code></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">dir.create</span>(<span class="st">&quot;results&quot;</span>)</code></pre></div>
<p>Now run <code>analyze</code> and save the plot in the <code>results</code> directory,</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">analyze</span>(<span class="st">&quot;data/inflammation-01.csv&quot;</span>, <span class="dt">output =</span> <span class="st">&quot;results/inflammation-01.pdf&quot;</span>)</code></pre></div>
<p>This now works well when we want to process one data file at a time, but how can we specify the output file in <code>analyze_all</code>? We need to do two things:</p>
<ol style="list-style-type: decimal">
<li>Substitute the filename ending “csv” with “pdf”.</li>
<li>Save the plot to the <code>results</code> directory.</li>
</ol>
<p>To change the extension to “pdf”, we will use the function <code>sub</code>,</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">f &lt;-<span class="st"> &quot;inflammation-01.csv&quot;</span>
<span class="kw">sub</span>(<span class="st">&quot;csv&quot;</span>, <span class="st">&quot;pdf&quot;</span>, f)</code></pre></div>
<pre><code>## [1] &quot;inflammation-01.pdf&quot;</code></pre>
<p>To add the “data” directory to the filename use the function <code>file.path</code>,</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">file.path</span>(<span class="st">&quot;results&quot;</span>, <span class="kw">sub</span>(<span class="st">&quot;csv&quot;</span>, <span class="st">&quot;pdf&quot;</span>, f))</code></pre></div>
<pre><code>## [1] &quot;results/inflammation-01.pdf&quot;</code></pre>
<p>Now let’s update <code>analyze_all</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">analyze_all &lt;-<span class="st"> </span>function(pattern) {
  <span class="co"># Directory name containing the data</span>
  data_dir &lt;-<span class="st"> &quot;data&quot;</span>
  <span class="co"># Directory name for results</span>
  results_dir &lt;-<span class="st"> &quot;results&quot;</span>
  <span class="co"># Runs the function analyze for each file in the current working directory</span>
  <span class="co"># that contains the given pattern.</span>
  filenames &lt;-<span class="st"> </span><span class="kw">list.files</span>(<span class="dt">path =</span> data_dir, <span class="dt">pattern =</span> pattern)
  for (f in filenames) {
    pdf_name &lt;-<span class="st"> </span><span class="kw">file.path</span>(results_dir, <span class="kw">sub</span>(<span class="st">&quot;csv&quot;</span>, <span class="st">&quot;pdf&quot;</span>, f))
    <span class="kw">analyze</span>(<span class="kw">file.path</span>(data_dir, f), <span class="dt">output =</span> pdf_name)
  }
}</code></pre></div>
<p>Now we can save all of the results with just one line of code:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">analyze_all</span>(<span class="st">&quot;inflammation*.csv&quot;</span>)</code></pre></div>
<p>Now if we need to make any changes to our analysis, we can edit the <code>analyze</code> function and quickly regenerate all the figures with <code>analyze_all</code>.</p>
<blockquote>
<p><strong>Changing the Behavior of the Plot Command</strong></p>
<p>One of your collaborators asks if you can recreate the figures with lines instead of points. Find the relevant argument to <code>plot</code> by reading the documentation (<code>?plot</code>), update <code>analyze</code>, and then recreate all the figures with <code>analyze_all</code>.</p>
<!-- > > ## Solution -->
<!-- > > ~~~ -->
<!-- > > analyze <- function(filename, output = NULL) { -->
<!-- > >   # Plots the average, min, and max inflammation over time. -->
<!-- > >   # Input: -->
<!-- > >   #    filename: character string of a csv file -->
<!-- > >   #    output: character string of pdf file for saving -->
<!-- > >   if (!is.null(output)) { -->
<!-- > >     pdf(output) -->
<!-- > >   } -->
<!-- > >   dat <- read.csv(file = filename, header = FALSE) -->
<!-- > >   avg_day_inflammation <- apply(dat, 2, mean) -->
<!-- > >   plot(avg_day_inflammation, type = "l") -->
<!-- > >   max_day_inflammation <- apply(dat, 2, max) -->
<!-- > >   plot(max_day_inflammation, type = "l") -->
<!-- > >   min_day_inflammation <- apply(dat, 2, min) -->
<!-- > >   plot(min_day_inflammation, type = "l") -->
<!-- > >   if (!is.null(output)) { -->
<!-- > >     dev.off() -->
<!-- > >   } -->
<!-- > > } -->
<!-- > > ~~~ -->
</blockquote>
</div>
</div>
<div id="command-line-programs" class="section level2">
<h2><span class="header-section-number">3.7</span> Command-Line Programs</h2>
<p>The R Console and other interactive tools like RStudio are great for prototyping code and exploring data, but sooner or later we will want to use our program in a pipeline or run it in a shell script to process thousands of data files. In order to do that, we need to make our programs work like other Unix command-line tools. For example, we may want a program that reads a data set and prints the average inflammation per patient:</p>
<pre><code>$ Rscript code/readings.R --mean data/inflammation-01.csv
5.45
5.425
6.1
...
6.4
7.05
5.9</code></pre>
<p>but we might also want to look at the minimum of the first four lines</p>
<pre><code>$ head -4 data/inflammation-01.csv | Rscript code/readings.R --min</code></pre>
<p>or the maximum inflammations in several files one after another:</p>
<pre><code>$ Rscript code/readings.R --max data/inflammation-*.csv</code></pre>
<p>Our overall requirements are:</p>
<ol style="list-style-type: decimal">
<li>If no filename is given on the command line, read data from <a href="%7B%7B%20page.root%20%7D%7D/reference/#standard-input">standard input</a>.</li>
<li>If one or more filenames are given, read data from them and report statistics for each file separately.</li>
<li>Use the <code>--min</code>, <code>--mean</code>, or <code>--max</code> flag to determine what statistic to print.</li>
</ol>
<p>To make this work, we need to know how to handle command-line arguments in a program, and how to get at standard input. We’ll tackle these questions in turn below.</p>
<div id="command-line-arguments" class="section level3">
<h3><span class="header-section-number">3.7.1</span> Command-Line Arguments</h3>
<p>Using the text editor of your choice, save the following line of code in a text file called <code>session-info.R</code>:</p>
<pre><code>## sessionInfo()</code></pre>
<p>The function, <code>sessionInfo</code>, outputs the version of R you are running as well as the type of computer you are using (as well as the versions of the packages that have been loaded). This is very useful information to include when asking others for help with your R code.</p>
<p>Now we can run the code in the file we created from the Unix Shell using <code>Rscript</code>:</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="kw">Rscript</span> code/session-info.R</code></pre></div>
<pre><code>## R version 3.3.2 (2016-10-31)
## Platform: x86_64-pc-linux-gnu (64-bit)
## Running under: Ubuntu 16.04.1 LTS
## 
## locale:
##  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              
##  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    
##  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   
##  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 
##  [9] LC_ADDRESS=C               LC_TELEPHONE=C            
## [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  base</code></pre>
<blockquote>
<p><strong>The Right Directory</strong></p>
<p>If that did not work, you might have seen an error message indicating that the file <code>session-info.R</code> does not exist. Remember that you must be in the correct directory, the one in which you created your script file. You can determine which directory you are currently in using <code>pwd</code> and change to a different directory using <code>cd</code>. For a review, see this <a href="%7B%7B%20site.swc_pages%20%7D%7D/shell-novice/01-filedir/">lesson</a>. {: .callout}</p>
</blockquote>
<p>Now let’s create another script that does something more interesting. Write the following lines in a file named <code>print-args.R</code>:</p>
<pre><code>## args &lt;- commandArgs()
## cat(args, sep = &quot;\n&quot;)</code></pre>
<p>The function <code>commandArgs</code> extracts all the command line arguments and returns them as a vector. The function <code>cat</code>, similar to the <code>cat</code> of the Unix Shell, outputs the contents of the variable. Since we did not specify a filename for writing, <code>cat</code> sends the output to <a href="%7B%7B%20page.root%20%7D%7D/reference/#standard-output-(stdout)">standard output</a>, which we can then pipe to other Unix functions. Because we set the argument <code>sep</code> to <code>&quot;\n&quot;</code>, which is the symbol to start a new line, each element of the vector is printed on its own line. Let’s see what happens when we run this program in the Unix Shell:</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="kw">Rscript</span> code/print-args.R</code></pre></div>
<pre><code>## /usr/lib/R/bin/exec/R
## --slave
## --no-restore
## --file=code/print-args.R</code></pre>
<p>From this output, we learn that <code>Rscript</code> is just a convenience command for running R scripts. The first argument in the vector is the path to the <code>R</code> executable. The following are all command-line arguments that affect the behavior of R. From the R help file:</p>
<ul>
<li><code>--slave</code>: Make R run as quietly as possible</li>
<li><code>--no-restore</code>: Don’t restore anything that was created during the R session</li>
<li><code>--file</code>: Run this file</li>
<li><code>--args</code>: Pass these arguments to the file being run</li>
</ul>
<p>Thus running a file with Rscript is an easier way to run the following:</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="kw">R</span> --slave --no-restore --file=code/print-args.R --args</code></pre></div>
<pre><code>## /usr/lib/R/bin/exec/R
## --slave
## --no-restore
## --file=code/print-args.R
## --args</code></pre>
<p>If we run it with a few arguments, however:</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="kw">Rscript</span> code/print-args.R first second third</code></pre></div>
<pre><code>## /usr/lib/R/bin/exec/R
## --slave
## --no-restore
## --file=code/print-args.R
## --args
## first
## second
## third</code></pre>
<p>then <code>commandArgs</code> adds each of those arguments to the vector it returns. Since the first elements of the vector are always the same, we can tell <code>commandArgs</code> to only return the arguments that come after <code>--args</code>. Let’s update <code>print-args.R</code> and save it as <code>print-args-trailing.R</code>:</p>
<pre><code>## args &lt;- commandArgs(trailingOnly = TRUE)
## cat(args, sep = &quot;\n&quot;)</code></pre>
<p>And then run <code>print-args-trailing</code> from the Unix Shell:</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="kw">Rscript</span> code/print-args-trailing.R first second third</code></pre></div>
<pre><code>## first
## second
## third</code></pre>
<p>Now <code>commandArgs</code> returns only the arguments that we listed after <code>print-args-trailing.R</code>.</p>
<p>With this in hand, let’s build a version of <code>readings.R</code> that always prints the per-patient (per-row) mean of a single data file. The first step is to write a function that outlines our implementation, and a placeholder for the function that does the actual work. By convention this function is usually called <code>main</code>, though we can call it whatever we want. Write the following code in a file called <code>readings-01.R</code>:</p>
<pre><code>## main &lt;- function() {
##   args &lt;- commandArgs(trailingOnly = TRUE)
##   filename &lt;- args[1]
##   dat &lt;- read.csv(file = filename, header = FALSE)
##   mean_per_patient &lt;- apply(dat, 1, mean)
##   cat(mean_per_patient, sep = &quot;\n&quot;)
## }</code></pre>
<p>This function gets the name of the file to process from the first element returned by <code>commandArgs</code>. Here’s a simple test to run from the Unix Shell:</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="kw">Rscript</span> code/readings-01.R data/inflammation-01.csv</code></pre></div>
<p>There is no output because we have defined a function, but haven’t actually called it. Let’s add a call to <code>main</code> and save it as <code>readings-02.R</code>:</p>
<pre><code>## main &lt;- function() {
##   args &lt;- commandArgs(trailingOnly = TRUE)
##   filename &lt;- args[1]
##   dat &lt;- read.csv(file = filename, header = FALSE)
##   mean_per_patient &lt;- apply(dat, 1, mean)
##   cat(mean_per_patient, sep = &quot;\n&quot;)
## }
## 
## main()</code></pre>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="kw">Rscript</span> code/readings-02.R data/inflammation-01.csv</code></pre></div>
<pre><code>## 5.45
## 5.425
## 6.1
## 5.9
## 5.55
## 6.225
## 5.975
## 6.65
## 6.625
## 6.525
## 6.775
## 5.8
## 6.225
## 5.75
## 5.225
## 6.3
## 6.55
## 5.7
## 5.85
## 6.55
## 5.775
## 5.825
## 6.175
## 6.1
## 5.8
## 6.425
## 6.05
## 6.025
## 6.175
## 6.55
## 6.175
## 6.35
## 6.725
## 6.125
## 7.075
## 5.725
## 5.925
## 6.15
## 6.075
## 5.75
## 5.975
## 5.725
## 6.3
## 5.9
## 6.75
## 5.925
## 7.225
## 6.15
## 5.95
## 6.275
## 5.7
## 6.1
## 6.825
## 5.975
## 6.725
## 5.7
## 6.25
## 6.4
## 7.05
## 5.9</code></pre>
<blockquote>
<p><strong>A Simple Command-Line Program</strong></p>
<ol style="list-style-type: decimal">
<li>Write a command-line program that does addition and subtraction.</li>
</ol>
<p><strong>Hint:</strong> Everything argument read from the command-line is interpreted as a character <a href="%7B%7B%20page.root%20%7D%7D/reference/#string">string</a>. You can convert from a string to a number using the function <code>as.numeric</code>.</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="kw">Rscript</span> code/arith.R 1 + 2</code></pre></div>
<pre><code>## 3</code></pre>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="kw">Rscript</span> code/arith.R 3 - 4</code></pre></div>
<pre><code>## -1</code></pre>
<!-- > > ## Solution -->
<!-- > > ```{r engine='bash'} -->
<!-- > > cat arith.R -->
<!-- > > ``` -->
<!-- > {: .solution} -->
<ol start="2" style="list-style-type: decimal">
<li><p>What goes wrong if you try to add multiplication using <code>*</code> to the program?</p></li>
<li><p>Using the function <code>list.files</code> introduced in a previous <a href="%7B%7B%20page.root%20%7D%7D/03-loops-R/">lesson</a>, write a command-line program called <code>find-pattern.R</code> that lists all the files in the current directory that contain a specific pattern:</p></li>
</ol>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="co"># For example, searching for the pattern &quot;print-args&quot; returns the two scripts we wrote earlier</span>
<span class="kw">Rscript</span> code/find-pattern.R print-args</code></pre></div>
<!-- > > ## Solution -->
<!-- > > ```{r engine='bash'} -->
<!-- > > cat code/find-pattern.R -->
<!-- > > ``` -->
</blockquote>
</div>
<div id="handling-multiple-files" class="section level3">
<h3><span class="header-section-number">3.7.2</span> Handling Multiple Files</h3>
<p>The next step is to teach our program how to handle multiple files. Since 60 lines of output per file is a lot to page through, we’ll start by using three smaller files, each of which has three days of data for two patients. Let’s investigate them from the Unix Shell:</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="kw">ls</span> data/small-*.csv</code></pre></div>
<pre><code>## data/small-01.csv
## data/small-02.csv
## data/small-03.csv</code></pre>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="kw">cat</span> data/small-01.csv</code></pre></div>
<pre><code>## 0,0,1
## 0,1,2</code></pre>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="kw">Rscript</span> code/readings-02.R data/small-01.csv</code></pre></div>
<pre><code>## 0.3333333
## 1</code></pre>
<p>Using small data files as input also allows us to check our results more easily: here, for example, we can see that our program is calculating the mean correctly for each line, whereas we were really taking it on faith before. This is yet another rule of programming: test the simple things first.</p>
<p>We want our program to process each file separately, so we need a loop that executes once for each filename. If we specify the files on the command line, the filenames will be returned by <code>commandArgs(trailingOnly = TRUE)</code>. We’ll need to handle an unknown number of filenames, since our program could be run for any number of files.</p>
<p>The solution is to loop over the vector returned by <code>commandArgs(trailingOnly = TRUE)</code>. Here’s our changed program, which we’ll save as <code>readings-03.R</code>:</p>
<pre><code>## main &lt;- function() {
##   args &lt;- commandArgs(trailingOnly = TRUE)
##   for (filename in args) {
##     dat &lt;- read.csv(file = filename, header = FALSE)
##     mean_per_patient &lt;- apply(dat, 1, mean)
##     cat(mean_per_patient, sep = &quot;\n&quot;)
##   }
## }
## 
## main()</code></pre>
<p>and here it is in action:</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="kw">Rscript</span> code/readings-03.R data/small-01.csv data/small-02.csv</code></pre></div>
<pre><code>## 0.3333333
## 1
## 13.66667
## 11</code></pre>
<p><strong>Note</strong>: at this point, we have created three versions of our script called <code>readings-01.R</code>, <code>readings-02.R</code>, and <code>readings-03.R</code>. We wouldn’t do this in real life: instead, we would have one file called <code>readings.R</code> that we committed to version control every time we got an enhancement working. For teaching, though, we need all the successive versions side by side.</p>
<blockquote>
<p><strong>A Command Line Program with Arguments</strong></p>
<p>Write a program called <code>check.R</code> that takes the names of one or more inflammation data files as arguments and checks that all the files have the same number of rows and columns. What is the best way to test your program?</p>
<!-- > > ## Solution -->
<!-- > > ```{r engine='bash'} -->
<!-- > > cat code/check.R -->
<!-- > > ``` -->
</blockquote>
</div>
<div id="handling-command-line-flags" class="section level3">
<h3><span class="header-section-number">3.7.3</span> Handling Command-Line Flags</h3>
<p>The next step is to teach our program to pay attention to the <code>--min</code>, <code>--mean</code>, and <code>--max</code> flags. These always appear before the names of the files, so let’s save the following in <code>readings-04.R</code>:</p>
<pre><code>## main &lt;- function() {
##   args &lt;- commandArgs(trailingOnly = TRUE)
##   action &lt;- args[1]
##   filenames &lt;- args[-1]
## 
##   for (f in filenames) {
##     dat &lt;- read.csv(file = f, header = FALSE)
## 
##     if (action == &quot;--min&quot;) {
##       values &lt;- apply(dat, 1, min)
##     } else if (action == &quot;--mean&quot;) {
##       values &lt;- apply(dat, 1, mean)
##     } else if (action == &quot;--max&quot;) {
##       values &lt;- apply(dat, 1, max)
##     }
##     cat(values, sep = &quot;\n&quot;)
##   }
## }
## 
## main()</code></pre>
<p>And we can confirm this works by running it from the Unix Shell:</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="kw">Rscript</span> code/readings-04.R --max data/small-01.csv</code></pre></div>
<pre><code>## 1
## 2</code></pre>
<p>but there are several things wrong with it:</p>
<ol style="list-style-type: decimal">
<li><p><code>main</code> is too large to read comfortably.</p></li>
<li><p>If <code>action</code> isn’t one of the three recognized flags, the program loads each file but does nothing with it (because none of the branches in the conditional match). <a href="%7B%7B%20page.root%20%7D%7D/reference/#silent-failure">Silent failures</a> like this are always hard to debug.</p></li>
</ol>
<p>This version pulls the processing of each file out of the loop into a function of its own. It also checks that <code>action</code> is one of the allowed flags before doing any processing, so that the program fails fast. We’ll save it as <code>readings-05.R</code>:</p>
<pre><code>## main &lt;- function() {
##   args &lt;- commandArgs(trailingOnly = TRUE)
##   action &lt;- args[1]
##   filenames &lt;- args[-1]
##   stopifnot(action %in% c(&quot;--min&quot;, &quot;--mean&quot;, &quot;--max&quot;))
## 
##   for (f in filenames) {
##     process(f, action)
##   }
## }
## 
## process &lt;- function(filename, action) {
##   dat &lt;- read.csv(file = filename, header = FALSE)
## 
##   if (action == &quot;--min&quot;) {
##     values &lt;- apply(dat, 1, min)
##   } else if (action == &quot;--mean&quot;) {
##     values &lt;- apply(dat, 1, mean)
##   } else if (action == &quot;--max&quot;) {
##     values &lt;- apply(dat, 1, max)
##   }
##   cat(values, sep = &quot;\n&quot;)
## }
## 
## main()</code></pre>
<p>This is four lines longer than its predecessor, but broken into more digestible chunks of 8 and 12 lines.</p>
<blockquote>
<p><strong>Parsing Command-Line Flags</strong></p>
<p>R has a package named <a href="http://cran.r-project.org/web/packages/argparse/index.html">argparse</a> that helps handle complex command-line flags (it utilizes a <a href="http://docs.python.org/dev/library/argparse.html">Python module</a> of the same name). We will not cover this package in this lesson but when you start writing programs with multiple parameters you’ll want to read through the package’s <a href="http://cran.r-project.org/web/packages/argparse/vignettes/argparse.pdf">vignette</a>. {: .callout}</p>
</blockquote>
<blockquote>
<p><strong>Shorter Command Line Arguments</strong></p>
<p>Rewrite this program so that it uses <code>-n</code>, <code>-m</code>, and <code>-x</code> instead of <code>--min</code>, <code>--mean</code>, and <code>--max</code> respectively. Is the code easier to read? Is the program easier to understand?</p>
<p>Separately, modify the program so that if no action is specified (or an incorrect action is given), it prints a message explaining how it should be used.</p>
<!-- > > ## Solution -->
<!-- > > ```{r engine='bash'} -->
<!-- > > cat code/readings-usage.R -->
<!-- > > ``` -->
</blockquote>
</div>
<div id="handling-standard-input" class="section level3">
<h3><span class="header-section-number">3.7.4</span> Handling Standard Input</h3>
<p>The next thing our program has to do is read data from standard input if no filenames are given so that we can put it in a pipeline, redirect input to it, and so on. Let’s experiment in another script, which we’ll save as <code>count-stdin.R</code>:</p>
<pre><code>## lines &lt;- readLines(con = file(&quot;stdin&quot;))
## count &lt;- length(lines)
## cat(&quot;lines in standard input: &quot;)
## cat(count, sep = &quot;\n&quot;)</code></pre>
<p>This little program reads lines from the program’s standard input using <code>file(&quot;stdin&quot;)</code>. This allows us to do almost anything with it that we could do to a regular file. In this example, we passed it as an argument to the function <code>readLines</code>, which stores each line as an element in a vector. Let’s try running it from the Unix Shell as if it were a regular command-line program:</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="kw">Rscript</span> code/count-stdin.R <span class="kw">&lt;</span> data/small-01.csv</code></pre></div>
<pre><code>## lines in standard input: 2</code></pre>
<p>Note that because we did not specify <code>sep = &quot;\n&quot;</code> when calling <code>cat</code>, the output is written on the same line.</p>
<p>A common mistake is to try to run something that reads from standard input like this:</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="kw">Rscript</span> code/count-stdin.R data/small-01.csv</code></pre></div>
<p>i.e., to forget the <code>&lt;</code> character that redirect the file to standard input. In this case, there’s nothing in standard input, so the program waits at the start of the loop for someone to type something on the keyboard. We can type some input, but R keeps running because it doesn’t know when the standard input has ended. If you ran this, you can pause R by typing <code>ctrl</code>+<code>z</code> (technically it is still paused in the background; if you want to fully kill the process type <code>kill %</code>; see <a href="https://www.gnu.org/software/bash/manual/bash.html#Job-Control-Basics">bash manual</a> for more information)).</p>
<p>We now need to rewrite the program so that it loads data from <code>file(&quot;stdin&quot;)</code> if no filenames are provided. Luckily, <code>read.csv</code> can handle either a filename or an open file as its first parameter, so we don’t actually need to change <code>process</code>. That leaves <code>main</code>, which we’ll update and save as <code>readings-06.R</code>:</p>
<pre><code>## main &lt;- function() {
##   args &lt;- commandArgs(trailingOnly = TRUE)
##   action &lt;- args[1]
##   filenames &lt;- args[-1]
##   stopifnot(action %in% c(&quot;--min&quot;, &quot;--mean&quot;, &quot;--max&quot;))
## 
##   if (length(filenames) == 0) {
##     process(file(&quot;stdin&quot;), action)
##   } else {
##     for (f in filenames) {
##       process(f, action)
##     }
##   }
## }
## 
## process &lt;- function(filename, action) {
##   dat &lt;- read.csv(file = filename, header = FALSE)
## 
##   if (action == &quot;--min&quot;) {
##     values &lt;- apply(dat, 1, min)
##   } else if (action == &quot;--mean&quot;) {
##     values &lt;- apply(dat, 1, mean)
##   } else if (action == &quot;--max&quot;) {
##     values &lt;- apply(dat, 1, max)
##   }
##   cat(values, sep = &quot;\n&quot;)
## }
## 
## main()</code></pre>
<p>Let’s try it out. Instead of calculating the mean inflammation of every patient, we’ll only calculate the mean for the first 10 patients (rows):</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="kw">head</span> data/inflammation-01.csv <span class="kw">|</span> <span class="kw">Rscript</span> code/readings-06.R --mean</code></pre></div>
<pre><code>## 5.45
## 5.425
## 6.1
## 5.9
## 5.55
## 6.225
## 5.975
## 6.65
## 6.625
## 6.525</code></pre>
<p>And now we’re done: the program now does everything we set out to do.</p>
<!-- > ## Implementing `wc` in R -->
<!-- > -->
<!-- >  Write a program called `line-count.R` that works like the Unix `wc` command: -->
<!-- > -->
<!-- >  *   If no filenames are given, it reports the number of lines in standard input. -->
<!-- >  *   If one or more filenames are given, it reports the number of lines in each, followed by the total number of lines. -->
<!-- > -->
<!-- > > ## Solution -->
<!-- > > ```{r engine='bash'} -->
<!-- > > cat code/line-count.R -->
<!-- > > ``` -->
</div>
</div>
<div id="addressing-data" class="section level2">
<h2><span class="header-section-number">3.8</span> Addressing Data</h2>
<p>R is a powerful language for data manipulation. There are three main ways for addressing data inside R objects.</p>
<ul>
<li>By index (slicing)</li>
<li>By logical vector</li>
<li>By name (columns only)</li>
</ul>
<p>Lets start by loading some sample data:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dat &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="dt">file =</span> <span class="st">&#39;data/sample.csv&#39;</span>, <span class="dt">header =</span> <span class="ot">TRUE</span>, <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)</code></pre></div>
<blockquote>
<p><strong>Interpreting Rows as Headers</strong></p>
<p>The first row of this csv file is a list of column names. We used the <em>header=TRUE</em> argument to <code>read.csv</code> so that R can interpret the file correctly. We are using the <em>stringsAsFactors=FALSE</em> argument to override the default behaviour for R. Using factors in R is covered in a separate lesson. {: .callout}</p>
</blockquote>
<p>Lets take a look at this data.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">class</span>(dat)</code></pre></div>
<pre><code>## [1] &quot;data.frame&quot;</code></pre>
<p>R has loaded the contents of the .csv file into a variable called <code>dat</code> which is a <code>data frame</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">dim</span>(dat)</code></pre></div>
<pre><code>## [1] 100   9</code></pre>
<p>The data has 100 rows and 9 columns.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(dat)</code></pre></div>
<pre><code>##       ID Gender      Group BloodPressure  Age Aneurisms_q1 Aneurisms_q2
## 1 Sub001      m    Control           132 16.0          114          140
## 2 Sub002      m Treatment2           139 17.2          148          209
## 3 Sub003      m Treatment2           130 19.5          196          251
## 4 Sub004      f Treatment1           105 15.7          199          140
## 5 Sub005      m Treatment1           125 19.9          188          120
## 6 Sub006      M Treatment2           112 14.3          260          266
##   Aneurisms_q3 Aneurisms_q4
## 1          202          237
## 2          248          248
## 3          122          177
## 4          233          220
## 5          222          228
## 6          320          294</code></pre>
<p>The data is the results of an (not real) experiment, looking at the number of aneurysms that formed in the eyes of patients who undertook 3 different treatments.</p>
<div id="addressing-by-index" class="section level3">
<h3><span class="header-section-number">3.8.1</span> Addressing by Index</h3>
<p>Data can be accessed by index. We have already seen how square brackets <code>[</code> can be used to subset (slice) data. The generic format is <code>dat[row_numbers,column_numbers]</code>.</p>
<blockquote>
<p><strong>Selecting Values</strong></p>
<p>What will be returned by <code>dat[1,1]</code>? {: .challenge}</p>
</blockquote>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dat[<span class="dv">1</span>,<span class="dv">1</span>]</code></pre></div>
<pre><code>## [1] &quot;Sub001&quot;</code></pre>
<p>If we leave out a dimension R will interpret this as a request for all values in that dimension.</p>
<blockquote>
<p><strong>Selecting More Values</strong></p>
<p>What will be returned by <code>dat[,2]</code>? {: .challenge}</p>
</blockquote>
<p>The colon <code>:</code> can be used to create a sequence of integers.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="dv">6</span>:<span class="dv">9</span></code></pre></div>
<pre><code>## [1] 6 7 8 9</code></pre>
<p>Creates a vector of numbers from 6 to 9.</p>
<p>This can be very useful for addressing data.</p>
<blockquote>
<p><strong>Subsetting with Sequences</strong></p>
<p>Use the colon operator to index just the aneurism count data (columns 6 to 9). {: .challenge}</p>
</blockquote>
<p>Finally we can use the <code>c()</code> (combine) function to address non-sequential rows and columns.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dat[<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">5</span>,<span class="dv">7</span>,<span class="dv">9</span>), <span class="dv">1</span>:<span class="dv">5</span>]</code></pre></div>
<pre><code>##       ID Gender      Group BloodPressure  Age
## 1 Sub001      m    Control           132 16.0
## 5 Sub005      m Treatment1           125 19.9
## 7 Sub007      f    Control           173 17.7
## 9 Sub009      m Treatment2           131 19.4</code></pre>
<p>Returns the first 5 columns for patients in rows 1,5,7 &amp; 9</p>
<blockquote>
<p><strong>Subsetting Non-Sequential Data</strong></p>
<p>Return the age and gender values for the first 5 patients. {: .challenge}</p>
</blockquote>
</div>
<div id="addressing-by-name" class="section level3">
<h3><span class="header-section-number">3.8.2</span> Addressing by Name</h3>
<p>Columns in an R data frame are named.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">names</span>(dat)</code></pre></div>
<pre><code>## [1] &quot;ID&quot;            &quot;Gender&quot;        &quot;Group&quot;         &quot;BloodPressure&quot;
## [5] &quot;Age&quot;           &quot;Aneurisms_q1&quot;  &quot;Aneurisms_q2&quot;  &quot;Aneurisms_q3&quot; 
## [9] &quot;Aneurisms_q4&quot;</code></pre>
<blockquote>
<p><strong>Default Names</strong></p>
<p>If names are not specified e.g. using <code>headers=FALSE</code> in a <code>read.csv()</code> function, R assigns default names <code>V1,V2,...,Vn</code> {: .callout}</p>
</blockquote>
<p>We usually use the <code>$</code> operator to address a column by name</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dat$Gender</code></pre></div>
<pre><code>##   [1] &quot;m&quot; &quot;m&quot; &quot;m&quot; &quot;f&quot; &quot;m&quot; &quot;M&quot; &quot;f&quot; &quot;m&quot; &quot;m&quot; &quot;f&quot; &quot;m&quot; &quot;f&quot; &quot;f&quot; &quot;m&quot; &quot;m&quot; &quot;m&quot; &quot;f&quot;
##  [18] &quot;m&quot; &quot;m&quot; &quot;F&quot; &quot;f&quot; &quot;m&quot; &quot;f&quot; &quot;f&quot; &quot;m&quot; &quot;M&quot; &quot;M&quot; &quot;f&quot; &quot;m&quot; &quot;f&quot; &quot;f&quot; &quot;m&quot; &quot;m&quot; &quot;m&quot;
##  [35] &quot;m&quot; &quot;f&quot; &quot;f&quot; &quot;m&quot; &quot;M&quot; &quot;m&quot; &quot;f&quot; &quot;m&quot; &quot;m&quot; &quot;m&quot; &quot;f&quot; &quot;f&quot; &quot;M&quot; &quot;M&quot; &quot;m&quot; &quot;m&quot; &quot;m&quot;
##  [52] &quot;f&quot; &quot;f&quot; &quot;f&quot; &quot;m&quot; &quot;f&quot; &quot;m&quot; &quot;m&quot; &quot;m&quot; &quot;f&quot; &quot;f&quot; &quot;f&quot; &quot;f&quot; &quot;M&quot; &quot;f&quot; &quot;m&quot; &quot;f&quot; &quot;f&quot;
##  [69] &quot;M&quot; &quot;m&quot; &quot;m&quot; &quot;m&quot; &quot;F&quot; &quot;m&quot; &quot;m&quot; &quot;f&quot; &quot;M&quot; &quot;M&quot; &quot;M&quot; &quot;f&quot; &quot;m&quot; &quot;M&quot; &quot;M&quot; &quot;m&quot; &quot;m&quot;
##  [86] &quot;f&quot; &quot;f&quot; &quot;f&quot; &quot;m&quot; &quot;m&quot; &quot;f&quot; &quot;m&quot; &quot;F&quot; &quot;f&quot; &quot;m&quot; &quot;m&quot; &quot;F&quot; &quot;m&quot; &quot;M&quot; &quot;M&quot;</code></pre>
<p>Named addressing can also be used in square brackets.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(dat[,<span class="kw">c</span>(<span class="st">&#39;Age&#39;</span>, <span class="st">&#39;Gender&#39;</span>)])</code></pre></div>
<pre><code>##    Age Gender
## 1 16.0      m
## 2 17.2      m
## 3 19.5      m
## 4 15.7      f
## 5 19.9      m
## 6 14.3      M</code></pre>
<blockquote>
<p><strong>Best Practice</strong></p>
<p>Best practice is to address columns by name, often you will create or delete columns and the column position will change. {: .callout}</p>
</blockquote>
</div>
<div id="logical-indexing" class="section level3">
<h3><span class="header-section-number">3.8.3</span> Logical Indexing</h3>
<p>A logical vector contains only the special values <code>TRUE</code> &amp; <code>FALSE</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">c</span>(<span class="ot">TRUE</span>, <span class="ot">TRUE</span>, <span class="ot">FALSE</span>, <span class="ot">FALSE</span>, <span class="ot">TRUE</span>)</code></pre></div>
<pre><code>## [1]  TRUE  TRUE FALSE FALSE  TRUE</code></pre>
<blockquote>
<p><strong>Truth and Its Opposite</strong></p>
<p>Note the values <code>TRUE</code> and <code>FALSE</code> are all capital letters and are not quoted. {: .callout}</p>
</blockquote>
<p>Logical vectors can be created using <code>relational operators</code> e.g. <code>&lt;, &gt;, ==, !=, %in%</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">11</span>, <span class="dv">12</span>, <span class="dv">13</span>)
x &lt;<span class="st"> </span><span class="dv">10</span></code></pre></div>
<pre><code>## [1]  TRUE  TRUE  TRUE FALSE FALSE FALSE</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x %in%<span class="st"> </span><span class="dv">1</span>:<span class="dv">10</span></code></pre></div>
<pre><code>## [1]  TRUE  TRUE  TRUE FALSE FALSE FALSE</code></pre>
<p>We can use logical vectors to select data from a data frame.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">index &lt;-<span class="st"> </span>dat$Group ==<span class="st"> &#39;Control&#39;</span>
dat[index,]$BloodPressure</code></pre></div>
<pre><code>##  [1] 132 173 129  77 158  81 137 111 135 108 133 139 126 125  99 122 155
## [18] 133  94  98  74 116  97 104 117  90 150 116 108 102</code></pre>
<p>Often this operation is written as one line of code:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(dat[dat$Group ==<span class="st"> &#39;Control&#39;</span>,]$BloodPressure)</code></pre></div>
<p><img src="_main_files/figure-html/logical_vectors_indexing2-1.png" width="672" /></p>
<blockquote>
<p><strong>Using Logical Indexes</strong></p>
<ol style="list-style-type: decimal">
<li>Create a scatterplot showing BloodPressure for subjects not in the control group.</li>
<li>How many ways are there to index this set of subjects? {: .challenge}</li>
</ol>
</blockquote>
</div>
<div id="combining-indexing-and-assignment" class="section level3">
<h3><span class="header-section-number">3.8.4</span> Combining Indexing and Assignment</h3>
<p>The assignment operator <code>&lt;-</code> can be combined with indexing.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">11</span>, <span class="dv">12</span>, <span class="dv">13</span>)
x[x &lt;<span class="st"> </span><span class="dv">10</span>] &lt;-<span class="st"> </span><span class="dv">0</span>
x</code></pre></div>
<pre><code>## [1]  0  0  0 11 12 13</code></pre>
<blockquote>
<p><strong>Updating a Subset of Values</strong></p>
<p>In this dataset, values for Gender have been recorded as both uppercase <code>M, F</code> and lowercase <code>m,f</code>. Combine the indexing and assignment operations to convert all values to lowercase. {: .challenge}</p>
</blockquote>
</div>
</div>
<div id="r-data-structures" class="section level2">
<h2><span class="header-section-number">3.9</span> R Data Structures</h2>
<div id="understanding-basic-data-types-in-r" class="section level3">
<h3><span class="header-section-number">3.9.1</span> Understanding Basic Data Types in R</h3>
<p>To make the best of the R language, you’ll need a strong understanding of the basic data types and data structures and how to operate on those.</p>
<p>Very important to understand because these are the objects you will manipulate on a day-to-day basis in R. Dealing with object conversions is one of the most common sources of frustration for beginners.</p>
<p><strong>Everything</strong> in R is an object.</p>
<p>R has 6 (although we will not discuss the raw class for this workshop) atomic vector types.</p>
<ul>
<li>character</li>
<li>numeric (real or decimal)</li>
<li>integer</li>
<li>logical</li>
<li>complex</li>
</ul>
<p>By <em>atomic</em>, we mean the vector only holds data of a single type.</p>
<ul>
<li><strong>character</strong>: <code>&quot;a&quot;</code>, <code>&quot;swc&quot;</code></li>
<li><strong>numeric</strong>: <code>2</code>, <code>15.5</code></li>
<li><strong>integer</strong>: <code>2L</code> (the <code>L</code> tells R to store this as an integer)</li>
<li><strong>logical</strong>: <code>TRUE</code>, <code>FALSE</code></li>
<li><strong>complex</strong>: <code>1+4i</code> (complex numbers with real and imaginary parts)</li>
</ul>
<p>R provides many functions to examine features of vectors and other objects, for example</p>
<ul>
<li><code>class()</code> - what kind of object is it (high-level)?</li>
<li><code>typeof()</code> - what is the object’s data type (low-level)?</li>
<li><code>length()</code> - how long is it? What about two dimensional objects?</li>
<li><code>attributes()</code> - does it have any metadata?</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Example</span>
x &lt;-<span class="st"> &quot;dataset&quot;</span>
<span class="kw">typeof</span>(x)</code></pre></div>
<pre><code>## [1] &quot;character&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">attributes</span>(x)</code></pre></div>
<pre><code>## NULL</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">y &lt;-<span class="st"> </span><span class="dv">1</span>:<span class="dv">10</span>
y</code></pre></div>
<pre><code>##  [1]  1  2  3  4  5  6  7  8  9 10</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">typeof</span>(y)</code></pre></div>
<pre><code>## [1] &quot;integer&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">length</span>(y)</code></pre></div>
<pre><code>## [1] 10</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">z &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(y)
z</code></pre></div>
<pre><code>##  [1]  1  2  3  4  5  6  7  8  9 10</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">typeof</span>(z)</code></pre></div>
<pre><code>## [1] &quot;double&quot;</code></pre>
<p>R has many <strong>data structures</strong>. These include</p>
<ul>
<li>atomic vector</li>
<li>list</li>
<li>matrix</li>
<li>data frame</li>
<li>factors</li>
</ul>
</div>
<div id="atomic-vectors" class="section level3">
<h3><span class="header-section-number">3.9.2</span> Atomic Vectors</h3>
<p>A vector is the most common and basic data structure in R and is pretty much the workhorse of R. Technically, vectors can be one of two types:</p>
<ul>
<li>atomic vectors</li>
<li>lists</li>
</ul>
<p>although the term “vector” most commonly refers to the atomic types not to lists.</p>
</div>
<div id="the-different-vector-modes" class="section level3">
<h3><span class="header-section-number">3.9.3</span> The Different Vector Modes</h3>
<p>A vector is a collection of elements that are most commonly of mode <code>character</code>, <code>logical</code>, <code>integer</code> or <code>numeric</code>.</p>
<p>You can create an empty vector with <code>vector()</code>. (By default the mode is <code>logical</code>. You can be more explicit as shown in the examples below.) It is more common to use direct constructors such as <code>character()</code>, <code>numeric()</code>, etc.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">vector</span>() <span class="co"># an empty &#39;logical&#39; (the default) vector</span></code></pre></div>
<pre><code>## logical(0)</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">vector</span>(<span class="st">&quot;character&quot;</span>, <span class="dt">length =</span> <span class="dv">5</span>) <span class="co"># a vector of mode &#39;character&#39; with 5 elements</span></code></pre></div>
<pre><code>## [1] &quot;&quot; &quot;&quot; &quot;&quot; &quot;&quot; &quot;&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">character</span>(<span class="dv">5</span>) <span class="co"># the same thing, but using the constructor directly</span></code></pre></div>
<pre><code>## [1] &quot;&quot; &quot;&quot; &quot;&quot; &quot;&quot; &quot;&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">numeric</span>(<span class="dv">5</span>)   <span class="co"># a numeric vector with 5 elements</span></code></pre></div>
<pre><code>## [1] 0 0 0 0 0</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">logical</span>(<span class="dv">5</span>)   <span class="co"># a logical vector with 5 elements</span></code></pre></div>
<pre><code>## [1] FALSE FALSE FALSE FALSE FALSE</code></pre>
<p>You can also create vectors by directly specifying their content. R will then guess the appropriate mode of storage for the vector. For instance:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>)</code></pre></div>
<p>will create a vector <code>x</code> of mode <code>numeric</code>. These are the most common kind, and are treated as double precision real numbers. If you wanted to explicitly create integers, you need to add an <code>L</code> to each element (or <em>coerce</em> to the integer type using <code>as.integer()</code>).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x1 &lt;-<span class="st"> </span><span class="kw">c</span>(1L, 2L, 3L)</code></pre></div>
<p>Using <code>TRUE</code> and <code>FALSE</code> will create a vector of mode <code>logical</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">y &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="ot">TRUE</span>, <span class="ot">TRUE</span>, <span class="ot">FALSE</span>, <span class="ot">FALSE</span>)</code></pre></div>
<p>While using quoted text will create a vector of mode <code>character</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">z &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Sarah&quot;</span>, <span class="st">&quot;Tracy&quot;</span>, <span class="st">&quot;Jon&quot;</span>)</code></pre></div>
</div>
<div id="examining-vectors" class="section level3">
<h3><span class="header-section-number">3.9.4</span> Examining Vectors</h3>
<p>The functions <code>typeof()</code>, <code>length()</code>, <code>class()</code> and <code>str()</code> provide useful information about your vectors and R objects in general.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">typeof</span>(z)</code></pre></div>
<pre><code>## [1] &quot;character&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">length</span>(z)</code></pre></div>
<pre><code>## [1] 3</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">class</span>(z)</code></pre></div>
<pre><code>## [1] &quot;character&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">str</span>(z)</code></pre></div>
<pre><code>##  chr [1:3] &quot;Sarah&quot; &quot;Tracy&quot; &quot;Jon&quot;</code></pre>
<blockquote>
<p><strong>Finding Commonalities</strong></p>
<p>Do you see a property that’s common to all these vectors above? {: .challenge}</p>
</blockquote>
</div>
<div id="adding-elements" class="section level3">
<h3><span class="header-section-number">3.9.5</span> Adding Elements</h3>
<p>The function <code>c()</code> (for combine) can also be used to add elements to a vector.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">z &lt;-<span class="st"> </span><span class="kw">c</span>(z, <span class="st">&quot;Annette&quot;</span>)
z</code></pre></div>
<pre><code>## [1] &quot;Sarah&quot;   &quot;Tracy&quot;   &quot;Jon&quot;     &quot;Annette&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">z &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Greg&quot;</span>, z)
z</code></pre></div>
<pre><code>## [1] &quot;Greg&quot;    &quot;Sarah&quot;   &quot;Tracy&quot;   &quot;Jon&quot;     &quot;Annette&quot;</code></pre>
</div>
<div id="vectors-from-a-sequence-of-numbers" class="section level3">
<h3><span class="header-section-number">3.9.6</span> Vectors from a Sequence of Numbers</h3>
<p>You can create vectors as a sequence of numbers.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">series &lt;-<span class="st"> </span><span class="dv">1</span>:<span class="dv">10</span>
<span class="kw">seq</span>(<span class="dv">10</span>)</code></pre></div>
<pre><code>##  [1]  1  2  3  4  5  6  7  8  9 10</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">1</span>, <span class="dt">to =</span> <span class="dv">10</span>, <span class="dt">by =</span> <span class="fl">0.1</span>)</code></pre></div>
<pre><code>##  [1]  1.0  1.1  1.2  1.3  1.4  1.5  1.6  1.7  1.8  1.9  2.0  2.1  2.2  2.3
## [15]  2.4  2.5  2.6  2.7  2.8  2.9  3.0  3.1  3.2  3.3  3.4  3.5  3.6  3.7
## [29]  3.8  3.9  4.0  4.1  4.2  4.3  4.4  4.5  4.6  4.7  4.8  4.9  5.0  5.1
## [43]  5.2  5.3  5.4  5.5  5.6  5.7  5.8  5.9  6.0  6.1  6.2  6.3  6.4  6.5
## [57]  6.6  6.7  6.8  6.9  7.0  7.1  7.2  7.3  7.4  7.5  7.6  7.7  7.8  7.9
## [71]  8.0  8.1  8.2  8.3  8.4  8.5  8.6  8.7  8.8  8.9  9.0  9.1  9.2  9.3
## [85]  9.4  9.5  9.6  9.7  9.8  9.9 10.0</code></pre>
</div>
<div id="missing-data" class="section level3">
<h3><span class="header-section-number">3.9.7</span> Missing Data</h3>
<p>R supports missing data in vectors. They are represented as <code>NA</code> (Not Available) and can be used for all the vector types covered in this lesson:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.5</span>, <span class="ot">NA</span>, <span class="fl">0.7</span>)
x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="ot">TRUE</span>, <span class="ot">FALSE</span>, <span class="ot">NA</span>)
x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;a&quot;</span>, <span class="ot">NA</span>, <span class="st">&quot;c&quot;</span>, <span class="st">&quot;d&quot;</span>, <span class="st">&quot;e&quot;</span>)
x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>+5i, <span class="dv">2</span>-3i, <span class="ot">NA</span>)</code></pre></div>
<p>The function <code>is.na()</code> indicates the elements of the vectors that represent missing data, and the function <code>anyNA()</code> returns <code>TRUE</code> if the vector contains any missing values:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;a&quot;</span>, <span class="ot">NA</span>, <span class="st">&quot;c&quot;</span>, <span class="st">&quot;d&quot;</span>, <span class="ot">NA</span>)
y &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;c&quot;</span>, <span class="st">&quot;d&quot;</span>, <span class="st">&quot;e&quot;</span>)
<span class="kw">is.na</span>(x)</code></pre></div>
<pre><code>## [1] FALSE  TRUE FALSE FALSE  TRUE</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">is.na</span>(y)</code></pre></div>
<pre><code>## [1] FALSE FALSE FALSE FALSE FALSE</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">anyNA</span>(x)</code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">anyNA</span>(y)</code></pre></div>
<pre><code>## [1] FALSE</code></pre>
</div>
<div id="other-special-values" class="section level3">
<h3><span class="header-section-number">3.9.8</span> Other Special Values</h3>
<p><code>Inf</code> is infinity. You can have either positive or negative infinity.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="dv">1</span>/<span class="dv">0</span></code></pre></div>
<pre><code>## [1] Inf</code></pre>
<p><code>NaN</code> means Not a Number. It’s an undefined value.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="dv">0</span>/<span class="dv">0</span></code></pre></div>
<pre><code>## [1] NaN</code></pre>
</div>
<div id="what-happens-when-you-mix-types-inside-a-vector" class="section level3">
<h3><span class="header-section-number">3.9.9</span> What Happens When You Mix Types Inside a Vector?</h3>
<p>R will create a resulting vector with a mode that can most easily accommodate all the elements it contains. This conversion between modes of storage is called “coercion”. When R converts the mode of storage based on its content, it is referred to as “implicit coercion”. For instance, can you guess what the following do (without running them first)?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">xx &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">1.7</span>, <span class="st">&quot;a&quot;</span>)
xx &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="ot">TRUE</span>, <span class="dv">2</span>)
xx &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;a&quot;</span>, <span class="ot">TRUE</span>)</code></pre></div>
<p>You can also control how vectors are coerced explicitly using the <code>as.&lt;class_name&gt;()</code> functions:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">as.numeric</span>(<span class="st">&quot;1&quot;</span>)</code></pre></div>
<pre><code>## [1] 1</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">as.character</span>(<span class="dv">1</span>:<span class="dv">2</span>)</code></pre></div>
<pre><code>## [1] &quot;1&quot; &quot;2&quot;</code></pre>
</div>
<div id="objects-attributes" class="section level3">
<h3><span class="header-section-number">3.9.10</span> Objects Attributes</h3>
<p>Objects can have <strong>attributes</strong>. Attributes are part of the object. These include:</p>
<ul>
<li>names</li>
<li>dimnames</li>
<li>dim</li>
<li>class</li>
<li>attributes (contain metadata)</li>
</ul>
<p>You can also glean other attribute-like information such as length (works on vectors and lists) or number of characters (for character strings).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">length</span>(<span class="dv">1</span>:<span class="dv">10</span>)</code></pre></div>
<pre><code>## [1] 10</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">nchar</span>(<span class="st">&quot;Software Carpentry&quot;</span>)</code></pre></div>
<pre><code>## [1] 18</code></pre>
</div>
<div id="matrix" class="section level3">
<h3><span class="header-section-number">3.9.11</span> Matrix</h3>
<p>In R matrices are an extension of the numeric or character vectors. They are not a separate type of object but simply an atomic vector with dimensions; the number of rows and columns.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dt">nrow =</span> <span class="dv">2</span>, <span class="dt">ncol =</span> <span class="dv">2</span>)
m</code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]   NA   NA
## [2,]   NA   NA</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">dim</span>(m)</code></pre></div>
<pre><code>## [1] 2 2</code></pre>
<p>Matrices in R are filled column-wise.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">1</span>:<span class="dv">6</span>, <span class="dt">nrow =</span> <span class="dv">2</span>, <span class="dt">ncol =</span> <span class="dv">3</span>)</code></pre></div>
<p>Other ways to construct a matrix</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m      &lt;-<span class="st"> </span><span class="dv">1</span>:<span class="dv">10</span>
<span class="kw">dim</span>(m) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">5</span>)</code></pre></div>
<p>This takes a vector and transforms it into a matrix with 2 rows and 5 columns.</p>
<p>Another way is to bind columns or rows using <code>cbind()</code> and <code>rbind()</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span><span class="dv">1</span>:<span class="dv">3</span>
y &lt;-<span class="st"> </span><span class="dv">10</span>:<span class="dv">12</span>
<span class="kw">cbind</span>(x, y)</code></pre></div>
<pre><code>##      x  y
## [1,] 1 10
## [2,] 2 11
## [3,] 3 12</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">rbind</span>(x, y)</code></pre></div>
<pre><code>##   [,1] [,2] [,3]
## x    1    2    3
## y   10   11   12</code></pre>
<p>You can also use the <code>byrow</code> argument to specify how the matrix is filled. From R’s own documentation:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mdat &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>, <span class="dv">11</span>,<span class="dv">12</span>,<span class="dv">13</span>), <span class="dt">nrow =</span> <span class="dv">2</span>, <span class="dt">ncol =</span> <span class="dv">3</span>, <span class="dt">byrow =</span> <span class="ot">TRUE</span>)
mdat</code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]    1    2    3
## [2,]   11   12   13</code></pre>
</div>
<div id="list" class="section level3">
<h3><span class="header-section-number">3.9.12</span> List</h3>
<p>In R lists act as containers. Unlike atomic vectors, the contents of a list are not restricted to a single mode and can encompass any mixture of data types. Lists are sometimes called generic vectors, because the elements of a list can by of any type of R object, even lists containing further lists. This property makes them fundamentally different from atomic vectors.</p>
<p>A list is a special type of vector. Each element can be a different type.</p>
<p>Create lists using <code>list()</code> or coerce other objects using <code>as.list()</code>. An empty list of the required length can be created using <code>vector()</code></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dv">1</span>, <span class="st">&quot;a&quot;</span>, <span class="ot">TRUE</span>, <span class="dv">1</span>+4i)
x</code></pre></div>
<pre><code>## [[1]]
## [1] 1
## 
## [[2]]
## [1] &quot;a&quot;
## 
## [[3]]
## [1] TRUE
## 
## [[4]]
## [1] 1+4i</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span><span class="kw">vector</span>(<span class="st">&quot;list&quot;</span>, <span class="dt">length =</span> <span class="dv">5</span>) ## empty list
<span class="kw">length</span>(x)</code></pre></div>
<pre><code>## [1] 5</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x[[<span class="dv">1</span>]]</code></pre></div>
<pre><code>## NULL</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span><span class="dv">1</span>:<span class="dv">10</span>
x &lt;-<span class="st"> </span><span class="kw">as.list</span>(x)
<span class="kw">length</span>(x)</code></pre></div>
<pre><code>## [1] 10</code></pre>
<ol style="list-style-type: decimal">
<li>What is the class of <code>x[1]</code>?</li>
<li>What about <code>x[[1]]</code>?</li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">xlist &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">a =</span> <span class="st">&quot;Karthik Ram&quot;</span>, <span class="dt">b =</span> <span class="dv">1</span>:<span class="dv">10</span>, <span class="dt">data =</span> <span class="kw">head</span>(iris))
xlist</code></pre></div>
<pre><code>## $a
## [1] &quot;Karthik Ram&quot;
## 
## $b
##  [1]  1  2  3  4  5  6  7  8  9 10
## 
## $data
##   Sepal.Length Sepal.Width Petal.Length Petal.Width Species
## 1          5.1         3.5          1.4         0.2  setosa
## 2          4.9         3.0          1.4         0.2  setosa
## 3          4.7         3.2          1.3         0.2  setosa
## 4          4.6         3.1          1.5         0.2  setosa
## 5          5.0         3.6          1.4         0.2  setosa
## 6          5.4         3.9          1.7         0.4  setosa</code></pre>
<ol style="list-style-type: decimal">
<li>What is the length of this object? What about its structure?</li>
</ol>
<p>Lists can be extremely useful inside functions. You can “staple” together lots of different kinds of results into a single object that a function can return.</p>
<p>A list does not print to the console like a vector. Instead, each element of the list starts on a new line.</p>
<p>Elements are indexed by double brackets. Single brackets will still return a(nother) list.</p>
</div>
<div id="data-frame" class="section level3">
<h3><span class="header-section-number">3.9.13</span> Data Frame</h3>
<p>A data frame is a very important data type in R. It’s pretty much the <em>de facto</em> data structure for most tabular data and what we use for statistics.</p>
<p>A data frame is a special type of list where every element of the list has same length.</p>
<p>Data frames can have additional attributes such as <code>rownames()</code>, which can be useful for annotating data, like <code>subject_id</code> or <code>sample_id</code>. But most of the time they are not used.</p>
<p>Some additional information on data frames:</p>
<ul>
<li>Usually created by <code>read.csv()</code> and <code>read.table()</code>.</li>
<li>Can convert to matrix with <code>data.matrix()</code> (preferred) or <code>as.matrix()</code></li>
<li>Coercion will be forced and not always what you expect.</li>
<li>Can also create with <code>data.frame()</code> function.</li>
<li>Find the number of rows and columns with <code>nrow(dat)</code> and <code>ncol(dat)</code>, respectively.</li>
<li>Rownames are usually 1, 2, …, n.</li>
</ul>
</div>
<div id="creating-data-frames-by-hand" class="section level3">
<h3><span class="header-section-number">3.9.14</span> Creating Data Frames by Hand</h3>
<p>To create data frames by hand:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dat &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">id =</span> letters[<span class="dv">1</span>:<span class="dv">10</span>], <span class="dt">x =</span> <span class="dv">1</span>:<span class="dv">10</span>, <span class="dt">y =</span> <span class="dv">11</span>:<span class="dv">20</span>)
dat</code></pre></div>
<pre><code>##    id  x  y
## 1   a  1 11
## 2   b  2 12
## 3   c  3 13
## 4   d  4 14
## 5   e  5 15
## 6   f  6 16
## 7   g  7 17
## 8   h  8 18
## 9   i  9 19
## 10  j 10 20</code></pre>
<blockquote>
<p><strong>Useful Data Frame Functions</strong></p>
<ul>
<li><code>head()</code> - shown first 6 rows</li>
<li><code>tail()</code> - show last 6 rows</li>
<li><code>dim()</code> - returns the dimensions</li>
<li><code>nrow()</code> - number of rows</li>
<li><code>ncol()</code> - number of columns</li>
<li><code>str()</code> - structure of each column</li>
<li><code>names()</code> - shows the <code>names</code> attribute for a data frame, which gives the column names. {: .callout}</li>
</ul>
</blockquote>
<p>See that it is actually a special list:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">is.list</span>(iris)</code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">class</span>(iris)</code></pre></div>
<pre><code>## [1] &quot;data.frame&quot;</code></pre>
<table>
<thead>
<tr class="header">
<th>Dimensions</th>
<th>Homogenous</th>
<th>Heterogeneous</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1-D</td>
<td>atomic vector</td>
<td>list</td>
</tr>
<tr class="even">
<td>2-D</td>
<td>matrix</td>
<td>data frame</td>
</tr>
</tbody>
</table>
<blockquote>
<p><strong>Column Types in Data Frames</strong></p>
<p>Knowing that data frames are lists of lists, can columns be of different type?</p>
<p>What type of structure do you expect on the iris data frame? Hint: Use <code>str()</code>.</p>
<pre><code># The Sepal.Length, Sepal.Width, Petal.Length and Petal.Width columns are all
# numeric types, while Species is a Factor.
# Lists can have elements of different types.
# Since a Data Frame is just a special type of list, it can have columns of
# differing type (although, remember that type must be consistent within each column!).
str(iris)</code></pre>
<p>{: .r} {: .challenge}</p>
</blockquote>
</div>
</div>
<div id="understanding-factors" class="section level2">
<h2><span class="header-section-number">3.10</span> Understanding Factors</h2>
<p>Factors are used to represent categorical data. Factors can be ordered or unordered and are an important class for statistical analysis and for plotting.</p>
<p>Factors are stored as integers, and have labels associated with these unique integers. While factors look (and often behave) like character vectors, they are actually integers under the hood, and you need to be careful when treating them like strings.</p>
<p>Once created, factors can only contain a pre-defined set values, known as <em>levels</em>. By default, R always sorts <em>levels</em> in alphabetical order. For instance, if you have a factor with 2 levels:</p>
<blockquote>
<p><strong>The <code>factor()</code> Command</strong></p>
<p>The <code>factor()</code> command is used to create and modify factors in R:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sex &lt;-<span class="st"> </span><span class="kw">factor</span>(<span class="kw">c</span>(<span class="st">&quot;male&quot;</span>, <span class="st">&quot;female&quot;</span>, <span class="st">&quot;female&quot;</span>, <span class="st">&quot;male&quot;</span>))</code></pre></div>
<p>{: .callout}</p>
</blockquote>
<p>R will assign <code>1</code> to the level <code>&quot;female&quot;</code> and <code>2</code> to the level <code>&quot;male&quot;</code> (because <code>f</code> comes before <code>m</code>, even though the first element in this vector is <code>&quot;male&quot;</code>). You can check this by using the function <code>levels()</code>, and check the number of levels using <code>nlevels()</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">levels</span>(sex)</code></pre></div>
<pre><code>## [1] &quot;female&quot; &quot;male&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">nlevels</span>(sex)</code></pre></div>
<pre><code>## [1] 2</code></pre>
<p>Sometimes, the order of the factors does not matter, other times you might want to specify the order because it is meaningful (e.g., “low”, “medium”, “high”) or it is required by particular type of analysis. Additionally, specifying the order of the levels allows us to compare levels:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">food &lt;-<span class="st"> </span><span class="kw">factor</span>(<span class="kw">c</span>(<span class="st">&quot;low&quot;</span>, <span class="st">&quot;high&quot;</span>, <span class="st">&quot;medium&quot;</span>, <span class="st">&quot;high&quot;</span>, <span class="st">&quot;low&quot;</span>, <span class="st">&quot;medium&quot;</span>, <span class="st">&quot;high&quot;</span>))
<span class="kw">levels</span>(food)</code></pre></div>
<pre><code>## [1] &quot;high&quot;   &quot;low&quot;    &quot;medium&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">food &lt;-<span class="st"> </span><span class="kw">factor</span>(food, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;low&quot;</span>, <span class="st">&quot;medium&quot;</span>, <span class="st">&quot;high&quot;</span>))
<span class="kw">levels</span>(food)</code></pre></div>
<pre><code>## [1] &quot;low&quot;    &quot;medium&quot; &quot;high&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">min</span>(food) ## doesn&#39;t work</code></pre></div>
<pre><code>## Error in Summary.factor(structure(c(1L, 3L, 2L, 3L, 1L, 2L, 3L), .Label = c(&quot;low&quot;, : &#39;min&#39; not meaningful for factors</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">food &lt;-<span class="st"> </span><span class="kw">factor</span>(food, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;low&quot;</span>, <span class="st">&quot;medium&quot;</span>, <span class="st">&quot;high&quot;</span>), <span class="dt">ordered=</span><span class="ot">TRUE</span>)
<span class="kw">levels</span>(food)</code></pre></div>
<pre><code>## [1] &quot;low&quot;    &quot;medium&quot; &quot;high&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">min</span>(food) ## works!</code></pre></div>
<pre><code>## [1] low
## Levels: low &lt; medium &lt; high</code></pre>
<p>In R’s memory, these factors are represented by numbers (1, 2, 3). They are better than using simple integer labels because factors are self describing: <code>&quot;low&quot;</code>, <code>&quot;medium&quot;</code>, and <code>&quot;high&quot;</code>&quot; is more descriptive than <code>1</code>, <code>2</code>, <code>3</code>. Which is low? You wouldn’t be able to tell with just integer data. Factors have this information built in. It is particularly helpful when there are many levels (like the subjects in our example data set).</p>
<blockquote>
<p><strong>Representing Data in R</strong></p>
<p>You have a vector representing levels of exercise undertaken by 5 subjects</p>
<p><strong>“l”,“n”,“n”,“i”,“l”</strong> ; n=none, l=light, i=intense</p>
<p>What is the best way to represent this in R?</p>
<ol style="list-style-type: lower-alpha">
<li><p>exercise &lt;- c(“l”, “n”, “n”, “i”, “l”)</p></li>
<li><p>exercise &lt;- factor(c(“l”, “n”, “n”, “i”, “l”), ordered = TRUE)</p></li>
<li><p>exercise &lt; -factor(c(“l”, “n”, “n”, “i”, “l”), levels = c(“n”, “l”, “i”), ordered = FALSE)</p></li>
<li><p>exercise &lt;- factor(c(“l”, “n”, “n”, “i”, “l”), levels = c(“n”, “l”, “i”), ordered = TRUE) {: .challenge}</p></li>
</ol>
</blockquote>
<div id="converting-factors" class="section level3">
<h3><span class="header-section-number">3.10.1</span> Converting Factors</h3>
<p>Converting from a factor to a number can cause problems:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">f &lt;-<span class="st"> </span><span class="kw">factor</span>(<span class="kw">c</span>(<span class="fl">3.4</span>, <span class="fl">1.2</span>, <span class="dv">5</span>))
<span class="kw">as.numeric</span>(f)</code></pre></div>
<pre><code>## [1] 2 1 3</code></pre>
<p>This does not behave as expected (and there is no warning).</p>
<p>The recommended way is to use the integer vector to index the factor levels:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">levels</span>(f)[f]</code></pre></div>
<pre><code>## [1] &quot;3.4&quot; &quot;1.2&quot; &quot;5&quot;</code></pre>
<p>This returns a character vector, the <code>as.numeric()</code> function is still required to convert the values to the proper type (numeric).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">f &lt;-<span class="st"> </span><span class="kw">levels</span>(f)[f]
f &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(f)</code></pre></div>
</div>
<div id="using-factors" class="section level3">
<h3><span class="header-section-number">3.10.2</span> Using Factors</h3>
<p>Lets load our example data to see the use of factors:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dat &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="dt">file =</span> <span class="st">&#39;data/sample.csv&#39;</span>, <span class="dt">stringsAsFactors =</span> <span class="ot">TRUE</span>)</code></pre></div>
<blockquote>
<p><strong>Default Behavior</strong></p>
<p><code>stringsAsFactors=TRUE</code> is the default behavior for R. We could leave this argument out. It is included here for clarity. {: .callout}</p>
</blockquote>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">str</span>(dat)</code></pre></div>
<pre><code>## &#39;data.frame&#39;:    100 obs. of  9 variables:
##  $ ID           : Factor w/ 100 levels &quot;Sub001&quot;,&quot;Sub002&quot;,..: 1 2 3 4 5 6 7 8 9 10 ...
##  $ Gender       : Factor w/ 4 levels &quot;f&quot;,&quot;F&quot;,&quot;m&quot;,&quot;M&quot;: 3 3 3 1 3 4 1 3 3 1 ...
##  $ Group        : Factor w/ 3 levels &quot;Control&quot;,&quot;Treatment1&quot;,..: 1 3 3 2 2 3 1 3 3 1 ...
##  $ BloodPressure: int  132 139 130 105 125 112 173 108 131 129 ...
##  $ Age          : num  16 17.2 19.5 15.7 19.9 14.3 17.7 19.8 19.4 18.8 ...
##  $ Aneurisms_q1 : int  114 148 196 199 188 260 135 216 117 188 ...
##  $ Aneurisms_q2 : int  140 209 251 140 120 266 98 238 215 144 ...
##  $ Aneurisms_q3 : int  202 248 122 233 222 320 154 279 181 192 ...
##  $ Aneurisms_q4 : int  237 248 177 220 228 294 245 251 272 185 ...</code></pre>
<p>Notice the first 3 columns have been converted to factors. These values were text in the data file so R automatically interpreted them as categorical variables.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(dat)</code></pre></div>
<pre><code>##        ID     Gender        Group    BloodPressure        Age       
##  Sub001 : 1   f:35   Control   :30   Min.   : 62.0   Min.   :12.10  
##  Sub002 : 1   F: 4   Treatment1:35   1st Qu.:107.5   1st Qu.:14.78  
##  Sub003 : 1   m:46   Treatment2:35   Median :117.5   Median :16.65  
##  Sub004 : 1   M:15                   Mean   :118.6   Mean   :16.42  
##  Sub005 : 1                          3rd Qu.:133.0   3rd Qu.:18.30  
##  Sub006 : 1                          Max.   :173.0   Max.   :20.00  
##  (Other):94                                                         
##   Aneurisms_q1    Aneurisms_q2    Aneurisms_q3    Aneurisms_q4  
##  Min.   : 65.0   Min.   : 80.0   Min.   :105.0   Min.   :116.0  
##  1st Qu.:118.0   1st Qu.:131.5   1st Qu.:182.5   1st Qu.:186.8  
##  Median :158.0   Median :162.5   Median :217.0   Median :219.0  
##  Mean   :158.8   Mean   :168.0   Mean   :219.8   Mean   :217.9  
##  3rd Qu.:188.0   3rd Qu.:196.8   3rd Qu.:248.2   3rd Qu.:244.2  
##  Max.   :260.0   Max.   :283.0   Max.   :323.0   Max.   :315.0  
## </code></pre>
<p>Notice the <code>summary()</code> function handles factors differently to numbers (and strings), the occurrence counts for each value is often more useful information.</p>
<blockquote>
<p><strong>The <code>summary()</code> Function</strong></p>
<p>The <code>summary()</code> function is a great way of spotting errors in your data (look at the <em>dat$Gender</em> column). It’s also a great way for spotting missing data. {: .callout}</p>
</blockquote>
<blockquote>
<p><strong>Reordering Factors</strong></p>
<p>The function <code>table()</code> tabulates observations and can be used to create bar plots quickly. For instance:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">table</span>(dat$Group)</code></pre></div>
<pre><code>## 
##    Control Treatment1 Treatment2 
##         30         35         35</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">barplot</span>(<span class="kw">table</span>(dat$Group))</code></pre></div>
<p><img src="_main_files/figure-html/reordering-factors-1.png" width="672" /> Use the <code>factor()</code> command to modify the column dat$Group so that the <em>control</em> group is plotted last {: .challenge}</p>
</blockquote>
</div>
<div id="removing-levels-from-a-factor" class="section level3">
<h3><span class="header-section-number">3.10.3</span> Removing Levels from a Factor</h3>
<p>Some of the Gender values in our dataset have been coded incorrectly. Let’s remove factors.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">barplot</span>(<span class="kw">table</span>(dat$Gender))</code></pre></div>
<p><img src="_main_files/figure-html/gender-counts-1.png" width="672" /></p>
<p>Values should have been recorded as lowercase ‘m’ &amp; ‘f’. We should correct this.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dat$Gender[dat$Gender ==<span class="st"> &#39;M&#39;</span>] &lt;-<span class="st"> &#39;m&#39;</span></code></pre></div>
<blockquote>
<p><strong>Updating Factors</strong></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(<span class="dt">x =</span> dat$Gender, <span class="dt">y =</span> dat$BloodPressure)</code></pre></div>
<p><img src="_main_files/figure-html/updating-factors-1.png" width="672" /></p>
<p>Why does this plot show 4 levels?</p>
<p><em>Hint</em> how many levels does dat$Gender have? {: .challenge}</p>
</blockquote>
<p>We need to tell R that “M” is no longer a valid value for this column. We use the <code>droplevels()</code> function to remove extra levels.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dat$Gender &lt;-<span class="st"> </span><span class="kw">droplevels</span>(dat$Gender)
<span class="kw">plot</span>(<span class="dt">x =</span> dat$Gender, <span class="dt">y =</span> dat$BloodPressure)</code></pre></div>
<p><img src="_main_files/figure-html/dropping-levels-1.png" width="672" /></p>
<blockquote>
<p><strong>Adjusting Factor Levels</strong></p>
<p>Adjusting the <code>levels()</code> of a factor provides a useful shortcut for reassigning values in this case.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">levels</span>(dat$Gender)[<span class="dv">2</span>] &lt;-<span class="st"> &#39;f&#39;</span>
<span class="kw">plot</span>(<span class="dt">x =</span> dat$Gender, <span class="dt">y =</span> dat$BloodPressure)</code></pre></div>
<p><img src="_main_files/figure-html/adjusting-levels-1.png" width="672" /> {: .callout}</p>
</blockquote>
</div>
</div>
<div id="learning-more-1" class="section level2">
<h2><span class="header-section-number">3.11</span> Learning more</h2>
<ol style="list-style-type: decimal">
<li>Interactive course <a href="https://www.datacamp.com/courses/free-introduction-to-r">Introduction to R</a> by Data Camp covers the R basics, vectors, matrices, factors and data frame.</li>
<li>Interactive course <a href="https://www.datacamp.com/courses/free-introduction-to-r">Intermediate R</a> by Data Camp covers Conditionals, Control Flow, loops, functions, and utility functions.</li>
<li><a href="https://google.github.io/styleguide/Rguide.xml">Google’s R Style Guide</a> lists Google’s coding rules for R to make code easier to read, share, and verify.</li>
<li>Hadley Wickham’s <a href="http://adv-r.had.co.nz/Style.html">Style Guide</a> in his Advanced R book.</li>
</ol>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="introduction.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="version-control-with-git.html" class="navigation navigation-next " aria-label="Next page""><i class="fa fa-angle-right"></i></a>

<script src="book_assets/gitbook-2.6.7/js/app.min.js"></script>
<script src="book_assets/gitbook-2.6.7/js/lunr.js"></script>
<script src="book_assets/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="book_assets/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="book_assets/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="book_assets/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="book_assets/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    if (location.protocol !== "file:" && /^https?:/.test(script.src))
      script.src  = script.src.replace(/^https?:/, '');
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
